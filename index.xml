<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>


<article-meta>


<title-group>
<article-title>Development and Validation of a Risk Prediction Model of
linezolid-induced thrombocytopenia</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ha</surname>
<given-names>Nhi Nguyen</given-names>
</name>
<string-name>Nhi Nguyen Ha</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Quoc</surname>
<given-names>An Tang</given-names>
</name>
<string-name>An Tang Quoc</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ngan</surname>
<given-names>Ha Tran</given-names>
</name>
<string-name>Ha Tran Ngan</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Thu</surname>
<given-names>Hang Nguyen Thi</given-names>
</name>
<string-name>Hang Nguyen Thi Thu</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Dinh</surname>
<given-names>Hoa Vu</given-names>
</name>
<string-name>Hoa Vu Dinh</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Trinh</surname>
<given-names>Nhung TH</given-names>
</name>
<string-name>Nhung TH Trinh</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-2">b</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Hoang</surname>
<given-names>Anh Nguyen</given-names>
</name>
<string-name>Anh Nguyen Hoang</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-1">a</xref>
<xref ref-type="corresp" rid="cor-7">&#x002A;</xref>
</contrib>
</contrib-group>
<aff id="aff-1">
<institution-wrap>
<institution>The National DI&amp;ADR Centre, Hanoi University of
Pharmacy</institution>
</institution-wrap>







</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Pharmacoepidemiology and Drug Safety Research Group,
Department of Pharmacy, Faculty of Mathematics and Natural Sciences,
University of Oslo, Oslo, Norway</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-7"></corresp>
</author-notes>









<history></history>


<abstract>
<p>Write abstract here, note the indentation</p>
</abstract>




</article-meta>

</front>

<body>
<sec id="checklist">
  <title>1. Checklist</title>
  <table-wrap>
    <caption>
      <p>TRIPOD-Cluster checklist of items to include when reporting a
      study developing or validating a multivariable prediction model
      using clustered data</p>
    </caption>
    <table>
      <colgroup>
        <col width="25%" />
        <col width="25%" />
        <col width="26%" />
        <col width="25%" />
      </colgroup>
      <thead>
        <tr>
          <th><bold>Section/topic</bold></th>
          <th align="center"><bold>Item No</bold></th>
          <th><bold>Description</bold></th>
          <th align="center"><bold>Draft date</bold></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><bold>Title and abstract</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Title</td>
          <td align="center">1</td>
          <td>Identify the study as developing and/or validating a
          multivariable prediction model, the target population, and the
          outcome to be predicted</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Abstract</td>
          <td align="center">2</td>
          <td>Provide a summary of research objectives, setting,
          participants, data source, sample size, predictors, outcome,
          statistical analysis, results, and conclusions*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Introduction</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Background and objectives</td>
          <td align="center">3a</td>
          <td>Explain the medical context (including whether diagnostic
          or prognostic) and rationale for developing or validating the
          prediction model, including references to existing models, and
          the advantages of the study design*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">3b</td>
          <td>Specify the objectives, including whether the study
          describes the development or validation of the model*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Methods</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Participants and data</td>
          <td align="center">4a</td>
          <td>Describe eligibility criteria for participants and
          datasets*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">4b</td>
          <td>Describe the origin of the data, and how the data were
          identified, requested, and collected</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Sample size</td>
          <td align="center">5</td>
          <td>Explain how the sample size was arrived at*</td>
          <td align="center">Mar 21</td>
        </tr>
        <tr>
          <td>Outcomes and predictors</td>
          <td align="center">6a</td>
          <td>Define the outcome that is predicted by the model,
          including how and when assessed*</td>
          <td align="center">Mar 21</td>
        </tr>
        <tr>
          <td></td>
          <td align="center">6b</td>
          <td>Define all predictors used in developing or validating the
          model, including how and when measured*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Data preparation</td>
          <td align="center">7a</td>
          <td>Describe how the data were prepared for analysis,
          including any cleaning, harmonisation, linkage, and quality
          checks</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">7b</td>
          <td>Describe the method for assessing risk of bias and
          applicability in the individual clusters (eg, using
          PROBAST)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">7c</td>
          <td>For validation, identify any differences in definition and
          measurement from the development data (eg, setting,
          eligibility criteria, outcome, predictors)*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">7d</td>
          <td>Describe how missing data were handled*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Data analysis</td>
          <td align="center">8a</td>
          <td>Describe how predictors were handled in the analyses</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8b</td>
          <td>Specify the type of model, all model building procedures
          (eg, any predictor selection and penalisation), and method for
          validation*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8c</td>
          <td>Describe how any heterogeneity across clusters (eg,
          studies or settings) in model parameter values was
          handled</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8d</td>
          <td>For validation, describe how the predictions were
          calculated</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8e</td>
          <td>Specify all measures used to assess model performance (eg,
          calibration, discrimination, and decision curve analysis) and,
          if relevant, to compare multiple models</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8f</td>
          <td>Describe how any heterogeneity across clusters (eg,
          studies or settings) in model performance was handled and
          quantified</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8g</td>
          <td>Describe any model updating (eg, recalibration) arising
          from the validation, either overall or for particular
          populations or settings*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Sensitivity analysis</td>
          <td align="center">9</td>
          <td>Describe any planned subgroup or sensitivity analysis—eg,
          assessing performance according to sources of bias,
          participant characteristics, setting</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Results</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Participants and datasets</td>
          <td align="center">10a</td>
          <td>Describe the number of clusters and participants from data
          identified through to data analysed; a flowchart might be
          helpful*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">10b</td>
          <td>Report the characteristics overall and where applicable
          for each data source or setting, including the key dates,
          predictors, treatments received, sample size, number of
          outcome events, follow-up time, and amount of missing
          data*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">10c</td>
          <td>For validation, show a comparison with the development
          data of the distribution of important variables (demographics,
          predictors, and outcome)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Risk of bias</td>
          <td align="center">11</td>
          <td>Report the results of the risk-of-bias assessment in the
          individual clusters</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Model development and specification</td>
          <td align="center">12a</td>
          <td>Report the results of any assessments of heterogeneity
          across clusters that led to subsequent actions during the
          model’s development (eg, inclusion or exclusion of particular
          predictors or clusters)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">12b</td>
          <td>Present the final prediction model (ie, all regression
          coefficients, and model intercept or baseline estimate of the
          outcome at a given time point) and explain how to use it for
          predictions in new individuals*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Model performance</td>
          <td align="center">13a</td>
          <td>Report performance measures (with uncertainty intervals)
          for the prediction model, overall and for each cluster</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">13b</td>
          <td>Report results of any heterogeneity across clusters in
          model performance</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Model updating</td>
          <td align="center">14</td>
          <td>Report the results from any model updating (including the
          updated model equation and subsequent performance), overall
          and for each cluster*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Sensitivity analysis</td>
          <td align="center">15</td>
          <td>Report results from any subgroup or sensitivity
          analysis</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Discussion</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Interpretation</td>
          <td align="center">16a</td>
          <td>Give an overall interpretation of the main results,
          including heterogeneity across clusters in model performance,
          in the context of the objectives and previous studies*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">16b</td>
          <td>For validation, discuss the results with reference to the
          model performance in the development data, and in any previous
          validations</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">16c</td>
          <td>Discuss the strengths of the study and any limitations
          (eg, missing or incomplete data, non-representativeness, data
          harmonisation problems)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Implications</td>
          <td align="center">17</td>
          <td>Discuss the potential use of the model and implications
          for future research, with specific view to generalisability
          and applicability of the model across different settings or
          (sub)populations</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Other information</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Supplementary information</td>
          <td align="center">18</td>
          <td>Provide information about the availability of
          supplementary resources (eg, study protocol, analysis code,
          datasets)*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Funding</td>
          <td align="center">19</td>
          <td>Give the source of funding and the role of the funders for
          the present study</td>
          <td align="center"></td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</sec>
<sec id="introduction">
  <title>2. Introduction</title>
  <sec id="background-and-objectives">
    <title>2.1 Background and objectives</title>
    <p><bold>First paragraph:</bold> introduction about linezolid and
    associated ADR including thrombocytopenia</p>
    <p><bold>Second paragraph:</bold> what is already known in the
    literature about this association (magnitude and associated
    factors)</p>
    <p><bold>Third paragraph:</bold> the importance of investigation
    this association in Vietnamese settings and develop a risk
    prediction model. Why is this study needed?</p>
    <p>This study aimed to develop and validate a risk prediction model
    of linezolid-induced thrombocytopenia adapted to Vietnamese setting.
    In addition, we constructed a simplified risk score using this model
    to enhance the applicability of the prediction rule in clinical
    practice.</p>
  </sec>
</sec>
<sec id="methods">
  <title>3. Methods</title>
  <sec id="participants-and-data">
    <title>3.1 Participants and data</title>
    <sec id="a-describe-eligibility-criteria-for-participants-and-datasets">
      <title>3.1.1 4a: Describe eligibility criteria for participants
      and datasets</title>
      <p>This study used data from three tertiary hospitals in Northern
      Vietnam: Thanh Nhan Hospital, Bach Mai Hospital, and the National
      Hospital of Tropical Diseases. Patients hospitalized and treated
      with linezolid were included. The following patients were
      excluded: (i) those under 18 years of age; (ii) those treated with
      linezolid for less than 3 days; (iii) those without any recorded
      platelet count in the period before or after initiation of
      linezolid therapy; (iv) those with baseline platelet count of &gt;
      450 x 10<sup>9</sup> cells/L; (v) those with any missing recorded
      values among the specified predictors. Each patient was included
      only once per admission and the first linezolid treatment course
      was evaluated. Included patients were followed up until the end of
      the linezolid treatment course or discharge date whichever comes
      first.</p>
    </sec>
    <sec id="b-describe-the-origin-of-the-data-and-how-the-data-were-identified-requested-and-collected">
      <title>3.1.2 4b: Describe the origin of the data, and how the data
      were identified, requested, and collected</title>
      <p>The data was collected from each hospital in two phases: a
      pilot phase and an extension phase. In the pilot phase, we
      requested existing datasets at the hospitals. In the extension
      phase, additional data was collected prospectively. Data was
      extracted from the electronic medical records of the hospitals,
      except for the pilot dataset at Bach Mai Hospital which was
      extracted from physical records. In order to harmonise different
      datasets, data was filled out in a paper form and stored in
      Excel.</p>
      <p>The pilot datasets were collected from January 01 to June 30,
      2020 at Thanh Nhan Hospital; from November 01 to December 31, 2019
      at Bach Mai Hospital; from May 01 to December 31, 2021 at the
      National Hospital of Tropical Diseases. The extension datasets
      were collected from September 01, 2022 to March 31, 2023 at Thanh
      Nhan Hospital; from December 01, 2022 to March 31, 2023 at Bach
      Mai Hospital; from April 01 to September 31, 2022 at the National
      Hospital of Tropical Diseases. <italic>(comment: no data of total
      number of patients admitted to these hospitals during each
      period)</italic></p>
      <p>The anonymized data were extracted from electronical medical
      records at each medical institution, except data from Bach Mai
      Hospital in the pilot phase. Individual ID number were assigned to
      each patient’s hospital admission.</p>
      <p>Ethical approval was obtained from….</p>
    </sec>
  </sec>
  <sec id="sample-size">
    <title>3.2 Sample size</title>
    <p>Previous studies developing logistic regression models for LI-TP
    risk predictions have included 4-6 predictors in their final models
    [<xref alt="1" rid="ref-liu_analysis_2021" ref-type="bibr">1</xref>–<xref alt="4" rid="ref-xu_establishment_2023" ref-type="bibr">4</xref>].
    We expect to include about as many candidate predictors, based on
    results from the expert opinion survey and the Bayesian Model
    Selection algorithm
    <xref alt="see 3.3" rid="sec-outcomes-and-predictors">see 3.3</xref>.
    Some of the candidate predictors might be continuous, which may
    potentially require non-linear modelling and therefore slightly
    increase the number of variables.</p>
    <p>A general rule of thumb is for at least 10 events be available
    for each candidate predictor considered in a prediction model
    [<xref alt="5" rid="ref-peduzzi1995" ref-type="bibr">5</xref>]. We
    have a total of 816 eligible patients and 264 of those have
    experienced the outcome. If the number of candidate predictors is 7,
    we would have 37 events per candidate predictor, which is
    considerably greater than the minimum number required. Even if the
    number of parameters screened is 20, we would still have 13 events
    per candidate predictor.</p>
    <p>However, the aforementioned rule of thumb have generated some
    debate in the literature, with recent results suggesting that event
    per variable criterion is too simplistic and has no strong relation
    to the predictive performance of a model. Riley et al
    [<xref alt="6" rid="ref-riley2019" ref-type="bibr">6</xref>]
    proposed a different set of criteria to estimate minimum sample size
    for models developed using logistic regression, which are the
    following:</p>
    <list list-type="order">
      <list-item>
        <p>Small optimism in predictor effect estimates, defined as a
        global shrinkage factor of &gt;= 0.9.</p>
      </list-item>
      <list-item>
        <p>Small absolute difference of &lt;= 0.05 in the model’s
        apparent and adjusted Nagelkerke’s R-squared.</p>
      </list-item>
      <list-item>
        <p>Precise estimation of the overall risk in the population.</p>
      </list-item>
    </list>
    <p>Criteria 1 and 2 aims to reduce the potential of overfitting.
    Criteria 3 aims to ensure the overall risk is estimated
    precisely.</p>
    <sec id="step-1-choose-the-number-of-candidate-predictors-of-interest-for-inclusion-in-the-model-and-calculate-the-corresponding-number-of-predictor-parameters-p">
      <title>3.2.1 Step 1: Choose the number of candidate predictors of
      interest for inclusion in the model, and calculate the
      corresponding number of predictor parameters (p)</title>
      <p>Note that one predictor may require two or more parameters. For
      example, a k-category predictor requires k-1 parameters and a
      continuous predictor model with a non-linear trend requires more
      than one parameter to be estimated. Also include any potential
      interaction terms towards the total p.</p>
      <p>When using a predictor selection method, p should be defined as
      the total number of parameters screened, and not just the subset
      that are included in the final model.</p>
      <p>Assuming maximum total p to be 20.</p>
      <boxed-text>
      <p><bold>Note</bold></p>
      <p>The value of p is assumed to be no larger than 20 because
      univariate regression shows there are 20 variables that are
      significantly correlated with the outcome.</p>
      </boxed-text>
    </sec>
    <sec id="step-2-choose-sensible-values-for-r2cs_adj-and-maxr2cs_app-based-on-previous-studies-where-r2cs-is-the-cox-snell-r2-statistic.">
      <title>3.2.2 Step 2: Choose sensible values for
      R<sup>2</sup><sub>CS_adj</sub> and
      max(R<sup>2</sup><sub>CS_app</sub>) based on previous studies
      where R<sup>2</sup><sub>CS</sub> is the Cox-Snell R<sup>2</sup>
      statistic.</title>
      <p>The value of max(R<sup>2</sup><sub>CS_app</sub>) is based on
      the overall prevalence or overall rate of the outcome in the
      population of interest. The incidence of LI-TP in patients treated
      with linezolid was estimated to be 37% in a meta-analysis by Zhao
      et al
      [<xref alt="7" rid="ref-zhao_prediction_2024" ref-type="bibr">7</xref>].</p>
      <p>The value of R<sup>2</sup><sub>CS_adj</sub> could be based on
      that for a previously published model in the same setting and
      population (with similar outcome definition). However, as previous
      studies does not provide any information to identify a sensible
      value of the minimum expected Cox-Snell R<sup>2</sup>, the value
      R<sup>2</sup><sub>CS_adj</sub> will be assumed to correspond to a
      R<sup>2</sup><sub>Nagelkerke</sub> of 0.50, as baseline platelet
      count, a “direct” measurement of the outcome, is likely to be a
      predictor.</p>
      <preformat>[1] 0.2048324</preformat>
    </sec>
    <sec id="step-3-criterion-1">
      <title>3.2.3 Step 3: Criterion 1</title>
      <p>Calculate the sample size required to ensure Van Houwelingen’s
      global shrinkage factor (S<sub>VH</sub>) is close to 1. A value of
      S<sub>VH</sub> &gt;= 0.90 is generally recommended, which reflects
      a small amount of overfitting during model development.</p>
      <preformat>[1] 775</preformat>
      <preformat>[1] 21</preformat>
      <p>We see that 775 participants are required to meet criterion
      1.</p>
    </sec>
    <sec id="step-4-criterion-2">
      <title>3.2.4 Step 4: Criterion 2</title>
      <p>Calculate the shrinkage factor (S<sub>VH</sub>) required to
      ensure a small absolute difference of &lt;= 0.05 in the developed
      model’s apparent and adjusted Nagelkerke’s R<sup>2</sup>. Then
      derive the required sample size conditional on this value of
      S<sub>VH</sub>.</p>
      <preformat>[1] 478</preformat>
      <preformat>[1] 34</preformat>
      <p>We see that 478 participants are required to meet criterion
      2.</p>
    </sec>
    <sec id="step-5-criterion-3">
      <title>3.2.5 Step 5: Criterion 3</title>
      <p>Calculate the sample size required to ensure a precise estimate
      of the overall risk in the population. The suggested absolute
      margin of error is &lt;= 0.05.</p>
      <preformat>[1] 359</preformat>
      <p>We see that 359 participants are required to meet criterion
      3.</p>
    </sec>
    <sec id="step-6-final-sample-size">
      <title>3.2.6 Step 6: Final sample size</title>
      <p>The required minimum sample size is the maximum value from
      steps 3 to 5, to ensure that each of criteria 1 to 3 are met.</p>
      <preformat>[1] 775</preformat>
      <preformat>[1] 21</preformat>
      <p>The final estimate of minimum sample size is 775, therefore our
      data is sufficient for model development with 20 parameters.</p>
      <p>The maximum number of parameters that can be screened is
      21.</p>
    </sec>
  </sec>
  <sec id="sec-outcomes-and-predictors">
    <title>3.3 Outcomes and predictors</title>
    <sec id="a.-define-the-outcome-that-is-predicted-by-the-model-including-how-and-when-assessed">
      <title>3.3.1 6a. Define the outcome that is predicted by the
      model, including how and when assessed</title>
      <p>The outcome of interest is linezolid-induced thrombocytopenia,
      defined as (i) a platelet count of &lt; 112.5 x 10<sup>9</sup>
      cells/L (75% of the lower limit of normal) for patients with a
      baseline platelet count in the normal range; (ii) A reduction in
      platelet count of ≥ 25% from the baseline value for patients with
      a baseline platelet count of &lt; 150 x 10<sup>9</sup> cells/L
      [<xref alt="4" rid="ref-xu_establishment_2023" ref-type="bibr">4</xref>,<xref alt="8" rid="ref-zyvoxpr" ref-type="bibr">8</xref>,<xref alt="9" rid="ref-kawasuji_proposal_2021" ref-type="bibr">9</xref>].</p>
      <p>Normal platelet count is defined as 150-450 x 10<sup>9</sup>
      cells/L. Baseline platelet count is defined as the last recorded
      PLT value before the start of linezolid therapy. Participants are
      considered to have met the outcome if their platelet count value
      meets the above criteria at any time during linezolid therapy or
      within 5 days after the end of therapy.</p>
      <boxed-text>
      <p><bold>Warning</bold></p>
      <p>Thrombocytopenia may occur within a few days after stopping
      LZD, when the drug hasn’t been completely eliminated. However, it
      is unknown exactly how long after stopping LZD can a TP event
      still be attributed to LZD use. We deemed that any TP events that
      occur after 5 days of stopping LZD would not be related to LZD
      use.</p>
      <p>Our rationale is that after 5 days (120 hrs), LZD is guaranteed
      to be completely eliminated in all patients, as the longest
      t<sub>1/2</sub> is 8.3 ± 2.4 hrs in end-stage renal disease
      patients, +3 SD would be ~16 hrs, so 120 hrs is &gt;7 half-lives,
      therefore in patients with the worst clearance, 99% of them would
      have 99% of the drug eliminated from their systems. Furthermore,
      trough LZD concentration (C<sub>min</sub>) has previously been
      identified as a predictor of LI-TP development, and LI-TP itself
      is mostly reversible after discontinuation, so we would argue that
      any TP events that occur after LZD has been eliminated from the
      system would not be related to LZD use.</p>
      </boxed-text>
    </sec>
    <sec id="b.-define-all-predictors-used-in-developing-or-validating-the-model-including-how-and-when-measured">
      <title>3.3.2 6b. Define all predictors used in developing or
      validating the model, including how and when measured</title>
      <p>Predictors will be screened for inclusion in the model if they
      meet all of the following criteria: (i) has been identified as a
      risk factor of LI-TP in previous studies; (ii) can be collected or
      evaluated from the information in the datasets; (iii) for
      concomitant medications, has drug-induced immune thrombocytopenia
      as an adverse drug reaction with a frequency of at least &gt;
      1/1000 in the drug label or Micromedex; (iv) has consensus from a
      clinical expert panel as possibly related to LI-TP
      development.</p>
      <p>The following information was extracted from all records:</p>
      <list list-type="bullet">
        <list-item>
          <p>Patient demographics</p>
        </list-item>
        <list-item>
          <p>Clinical department where linezolid was initiated.</p>
        </list-item>
        <list-item>
          <p>Co-morbidities</p>
        </list-item>
        <list-item>
          <p>Invasive procedures performed</p>
        </list-item>
        <list-item>
          <p>Infection type</p>
        </list-item>
        <list-item>
          <p>Laboratory results</p>
        </list-item>
        <list-item>
          <p>Linezolid route of administration</p>
        </list-item>
        <list-item>
          <p>Linezolid dose in milligrams.</p>
        </list-item>
        <list-item>
          <p>Linezolid duration, defined as the number of days from the
          first to the last dose of linezolid.</p>
        </list-item>
        <list-item>
          <p>Concomitant medications during linezolid therapy</p>
        </list-item>
      </list>
    </sec>
  </sec>
  <sec id="data-preparation">
    <title>3.4 Data preparation</title>
    <sec id="a.-describe-how-the-data-were-prepared-for-analysis-including-any-cleaning-harmonisation-linkage-and-quality-checks">
      <title>3.4.1 7a. Describe how the data were prepared for analysis,
      including any cleaning, harmonisation, linkage, and quality
      checks</title>
      <p>Harmonisation between datasets was mainly done via manually
      recording data to a standardized form. Data was then entered into
      an Excel spreadsheet. Data cleaning was done by handling
      duplicates, checking for missing values and inconsistencies.
      Multiple linezolid treatment episodes in the same patient were
      treated as duplicates and only the first episode was included in
      the analysis. Patients with missing values were excluded from
      subsequent analyses. Inconsistencies were resolved by referring
      back to the original records.</p>
      <p>Before analysis, the extracted predictors are limited to those
      that meet criteria (i) to (iii) in the previous section:</p>
      <list list-type="bullet">
        <list-item>
          <p>Patient demographics were limited to age in years, gender,
          and weight in kilograms.</p>
        </list-item>
        <list-item>
          <p>Clinical department was recorded into binary variables:
          intensive care unit, emergency department, and others.</p>
        </list-item>
        <list-item>
          <p>Co-morbidities were recorded into binary variables:
          hypertension, heart failure, angina, myocardial infarction,
          cerebral vascular accident, diabetes, chronic obstructive
          pulmonary disease, cirrhosis, malignancies, and hematological
          disorders.</p>
        </list-item>
        <list-item>
          <p>Invasive procedures were recorded into binary variables:
          endotracheal intubation, central venous catheter insertion,
          intermittent hemodialysis, and continuous renal replacement
          therapy.</p>
        </list-item>
        <list-item>
          <p>Infection type was recorded into binary variables:
          community-acquired pneumonia, hospital-acquired pneumonia,
          skin and soft tissue infection, central nervous system
          infection, intra-abdominal infection, urinary tract infection,
          bone and joint infection, septicemia, and sepsis.</p>
        </list-item>
        <list-item>
          <p>Laboratory results were limited to serum creatinine,
          hemoglobin count, white blood cell count, and platelet count.
          Creatinine clearance was estimated from serum creatinine using
          the Cockcroft-Gault equation.</p>
        </list-item>
        <list-item>
          <p>Linezolid route of administration was recorded into binary
          variables: intravenous, oral, and both.</p>
        </list-item>
        <list-item>
          <p>Linezolid dose in milligrams.</p>
        </list-item>
        <list-item>
          <p>Linezolid duration in days.</p>
        </list-item>
        <list-item>
          <p>Concomitant medications were recoded to binary variables:
          carbapenems, daptomycin, teicoplanin, levofloxacin, ibuprofen,
          naproxen, heparin, clopidogrel, enoxaparin, eptifibatide,
          carbamazepine, valproic acid, quetiapine, atezolizumab,
          pembrolizumab, trastuzumab, tacrolimus, fluorouracil,
          irinotecan, leucovorin, oxaliplatin, pyrazinamide, and
          rifampin.</p>
        </list-item>
      </list>
    </sec>
    <sec id="b.-describe-the-method-for-assessing-risk-of-bias-and-applicability-in-the-individual-clusters-eg-using-probast">
      <title>3.4.2 7b. Describe the method for assessing risk of bias
      and applicability in the individual clusters (eg, using
      PROBAST)</title>
      <boxed-text>
      <p><bold>Important</bold></p>
      <p>Is this even possible for this study?</p>
      </boxed-text>
    </sec>
    <sec id="c.-for-validation-identify-any-differences-in-definition-and-measurement-from-the-development-data-eg-setting-eligibility-criteria-outcome-predictors">
      <title>3.4.3 7c. For validation, identify any differences in
      definition and measurement from the development data (eg, setting,
      eligibility criteria, outcome, predictors)</title>
    </sec>
    <sec id="d.-describe-how-missing-data-were-handled">
      <title>3.4.4 7d. Describe how missing data were handled</title>
      <p>Any subsequent analyses were conducted on the complete case
      dataset. There are ~5% of observations with missing values in the
      dataset, which is considered low. The missing data mechanism is
      assumed to be missing completely at random.</p>
      <boxed-text>
      <p><bold>Important</bold></p>
      <p>What is a possible reason for missing data?</p>
      </boxed-text>
    </sec>
  </sec>
  <sec id="data-analysis">
    <title>3.5 Data analysis</title>
    <sec id="a.-describe-how-predictors-were-handled-in-the-analyses">
      <title>3.5.1 8a. Describe how predictors were handled in the
      analyses</title>
    </sec>
    <sec id="b.-specify-the-type-of-model-all-model-building-procedures-eg-any-predictor-selection-and-penalisation-and-method-for-validation">
      <title>3.5.2 8b. Specify the type of model, all model building
      procedures (eg, any predictor selection and penalisation), and
      method for validation</title>
    </sec>
    <sec id="c.-describe-how-any-heterogeneity-across-clusters-eg-studies-or-settings-in-model-parameter-values-was-handled">
      <title>3.5.3 8c. Describe how any heterogeneity across clusters
      (eg, studies or settings) in model parameter values was
      handled</title>
    </sec>
    <sec id="d.-for-validation-describe-how-the-predictions-were-calculated">
      <title>3.5.4 8d. For validation, describe how the predictions were
      calculated</title>
    </sec>
    <sec id="e.-specify-all-measures-used-to-assess-model-performance-eg-calibration-discrimination-and-decision-curve-analysis-and-if-relevant-to-compare-multiple-models">
      <title>3.5.5 8e. Specify all measures used to assess model
      performance (eg, calibration, discrimination, and decision curve
      analysis) and, if relevant, to compare multiple models</title>
    </sec>
    <sec id="f.-describe-how-any-heterogeneity-across-clusters-eg-studies-or-settings-in-model-performance-was-handled-and-quantified">
      <title>3.5.6 8f. Describe how any heterogeneity across clusters
      (eg, studies or settings) in model performance was handled and
      quantified</title>
    </sec>
    <sec id="g.-describe-any-model-updating-eg-recalibration-arising-from-the-validation-either-overall-or-for-particular-populations-or-settings">
      <title>3.5.7 8g. Describe any model updating (eg, recalibration)
      arising from the validation, either overall or for particular
      populations or settings</title>
    </sec>
  </sec>
  <sec id="sensitivity-analysis">
    <title>3.6 Sensitivity analysis</title>
  </sec>
</sec>
<sec id="results">
  <title>4. Results</title>
  <sec id="participants-and-datasets">
    <title>4.1 Participants and datasets</title>
  </sec>
  <sec id="risk-of-bias">
    <title>4.2 Risk of bias</title>
  </sec>
  <sec id="model-development-and-specification">
    <title>4.3 Model development and specification</title>
  </sec>
  <sec id="model-performance">
    <title>4.4 Model performance</title>
  </sec>
  <sec id="model-updating">
    <title>4.5 Model updating</title>
  </sec>
  <sec id="sensitivity-analysis-1">
    <title>4.6 Sensitivity analysis</title>
  </sec>
</sec>
<sec id="discussion">
  <title>5. Discussion</title>
  <sec id="interpretation">
    <title>5.1 Interpretation</title>
  </sec>
  <sec id="implications">
    <title>5.2 Implications</title>
  </sec>
</sec>
<sec id="other-information">
  <title>6. Other information</title>
  <sec id="supplementary-information">
    <title>6.1 Supplementary information</title>
  </sec>
  <sec id="funding">
    <title>6.2 Funding</title>
  </sec>
  <sec id="references">
    <title>6.3 References</title>
    <ref-list>
      <ref id="ref-duan_regression_2022">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Duan</surname><given-names>L.</given-names></name>
            <name><surname>Zhou</surname><given-names>Q.</given-names></name>
            <name><surname>Feng</surname><given-names>Z.</given-names></name>
            <name><surname>Zhu</surname><given-names>C.</given-names></name>
            <name><surname>Cai</surname><given-names>Y.</given-names></name>
            <name><surname>Wang</surname><given-names>S.</given-names></name>
            <name><surname>Zhu</surname><given-names>M.</given-names></name>
            <name><surname>Li</surname><given-names>J.</given-names></name>
            <name><surname>Yuan</surname><given-names>Y.</given-names></name>
            <name><surname>Liu</surname><given-names>X.</given-names></name>
            <name><surname>Sun</surname><given-names>J.</given-names></name>
            <name><surname>Yang</surname><given-names>Z.</given-names></name>
            <name><surname>Tang</surname><given-names>L.</given-names></name>
          </person-group>
          <article-title>A Regression Model to Predict Linezolid Induced Thrombocytopenia in Neonatal Sepsis Patients: A Ten-Year Retrospective Cohort Study</article-title>
          <source>Front Pharmacol</source>
          <year iso-8601-date="2022">2022</year>
          <volume>13</volume>
          <issn>1663-9812 (Print) 1663-9812 (Electronic) 1663-9812 (Linking)</issn>
          <uri>https://www.ncbi.nlm.nih.gov/pubmed/35185555</uri>
          <pub-id pub-id-type="doi">10.3389/fphar.2022.710099</pub-id>
          <fpage>710099</fpage>
          <lpage></lpage>
        </element-citation>
      </ref>
      <ref id="ref-qin_development_2021">
        <element-citation publication-type="report">
          <person-group person-group-type="author">
            <name><surname>Qin</surname><given-names>Yan</given-names></name>
            <name><surname>Chen</surname><given-names>Zhe</given-names></name>
            <name><surname>Gao</surname><given-names>Shuai</given-names></name>
            <name><surname>Pan</surname><given-names>Ming Kun</given-names></name>
            <name><surname>Li</surname><given-names>Yu Xiao</given-names></name>
            <name><surname>Lv</surname><given-names>Zhou Qian</given-names></name>
            <name><surname>Shen</surname><given-names>Yun</given-names></name>
            <name><surname>Ye</surname><given-names>Yanrong</given-names></name>
          </person-group>
          <article-title>Development and Validation of a Risk Prediction Model of Linezolid-induced Thrombocytopenia in Elderly Patients</article-title>
          <publisher-name>In Review</publisher-name>
          <year iso-8601-date="2021-06">2021</year><month>06</month>
          <date-in-citation content-type="access-date"><year iso-8601-date="2023-08-17">2023</year><month>08</month><day>17</day></date-in-citation>
          <uri>https://www.researchsquare.com/article/rs-582799/v1</uri>
          <pub-id pub-id-type="doi">10.21203/rs.3.rs-582799/v1</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-kawasuji_proposal_2021">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Kawasuji</surname><given-names>Hitoshi</given-names></name>
            <name><surname>Tsuji</surname><given-names>Yasuhiro</given-names></name>
            <name><surname>Ogami</surname><given-names>Chika</given-names></name>
            <name><surname>Kimoto</surname><given-names>Kou</given-names></name>
            <name><surname>Ueno</surname><given-names>Akitoshi</given-names></name>
            <name><surname>Miyajima</surname><given-names>Yuki</given-names></name>
            <name><surname>Kawago</surname><given-names>Koyomi</given-names></name>
            <name><surname>Sakamaki</surname><given-names>Ippei</given-names></name>
            <name><surname>Yamamoto</surname><given-names>Yoshihiro</given-names></name>
          </person-group>
          <article-title>Proposal of initial and maintenance dosing regimens with linezolid for renal impairment patients</article-title>
          <source>BMC Pharmacology and Toxicology</source>
          <year iso-8601-date="2021-03">2021</year><month>03</month>
          <date-in-citation content-type="access-date"><year iso-8601-date="2024-02-26">2024</year><month>02</month><day>26</day></date-in-citation>
          <volume>22</volume>
          <issue>1</issue>
          <issn>2050-6511</issn>
          <uri>https://doi.org/10.1186/s40360-021-00479-w</uri>
          <pub-id pub-id-type="doi">10.1186/s40360-021-00479-w</pub-id>
          <fpage>13</fpage>
          <lpage></lpage>
        </element-citation>
      </ref>
      <ref id="ref-xu_establishment_2023">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Xu</surname><given-names>Jinhui</given-names></name>
            <name><surname>Lu</surname><given-names>Jian</given-names></name>
            <name><surname>Yuan</surname><given-names>Yunlong</given-names></name>
            <name><surname>Duan</surname><given-names>Lufen</given-names></name>
            <name><surname>Shi</surname><given-names>Lu</given-names></name>
            <name><surname>Chen</surname><given-names>Fang</given-names></name>
            <name><surname>Cao</surname><given-names>Yifei</given-names></name>
            <name><surname>Xu</surname><given-names>Guangjuan</given-names></name>
            <name><surname>Feng</surname><given-names>Zongtai</given-names></name>
            <name><surname>Li</surname><given-names>Lan</given-names></name>
            <name><surname>Xue</surname><given-names>Hongzhi</given-names></name>
            <name><surname>Sun</surname><given-names>Jiantong</given-names></name>
            <name><surname>Zhou</surname><given-names>Qin</given-names></name>
            <name><surname>Zhuang</surname><given-names>Zhiwei</given-names></name>
            <name><surname>Tang</surname><given-names>Lian</given-names></name>
          </person-group>
          <article-title>Establishment and validation of a risk prediction model incorporating concentrations of linezolid and its metabolite PNU142300 for linezolid-induced thrombocytopenia</article-title>
          <source>The Journal of Antimicrobial Chemotherapy</source>
          <year iso-8601-date="2023-08">2023</year><month>08</month>
          <volume>78</volume>
          <issue>8</issue>
          <issn>1460-2091</issn>
          <pub-id pub-id-type="doi">10.1093/jac/dkad191</pub-id>
          <pub-id pub-id-type="pmid">37341139</pub-id>
          <fpage>1974</fpage>
          <lpage>1981</lpage>
        </element-citation>
      </ref>
      <ref id="ref-liu_analysis_2021">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Liu</surname><given-names>YX</given-names></name>
            <name><surname>Liu</surname><given-names>TT</given-names></name>
            <name><surname>Wei</surname><given-names>G</given-names></name>
            <name><surname>Yan</surname><given-names>P</given-names></name>
            <name><surname>Fang</surname><given-names>XQ</given-names></name>
            <name><surname>Xie</surname><given-names>LX</given-names></name>
          </person-group>
          <article-title>Analysis of risk factors and establishment of risk prediction model for linezolid-associated thrombocytopenia.</article-title>
          <source>Medical Journal of Chinese People’s Liberation Army</source>
          <year iso-8601-date="2021">2021</year>
          <volume>46</volume>
          <issue>8</issue>
          <uri>https://d.wanfangdata.com.cn/periodical/jfjyxzz202108006</uri>
          <pub-id pub-id-type="doi">10.11855/j.issn.0577-7402.2021.08.06</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-zhao_prediction_2024">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Zhao</surname><given-names>Xian</given-names></name>
            <name><surname>Peng</surname><given-names>Qin</given-names></name>
            <name><surname>Hu</surname><given-names>Dongmei</given-names></name>
            <name><surname>Li</surname><given-names>Weiwei</given-names></name>
            <name><surname>Ji</surname><given-names>Qing</given-names></name>
            <name><surname>Dong</surname><given-names>Qianqian</given-names></name>
            <name><surname>Huang</surname><given-names>Luguang</given-names></name>
            <name><surname>Piao</surname><given-names>Miyang</given-names></name>
            <name><surname>Ding</surname><given-names>Yi</given-names></name>
            <name><surname>Wang</surname><given-names>Jingwen</given-names></name>
          </person-group>
          <article-title>Prediction of risk factors for linezolid-induced thrombocytopenia based on neural network model</article-title>
          <source>Frontiers in Pharmacology</source>
          <year iso-8601-date="2024">2024</year>
          <date-in-citation content-type="access-date"><year iso-8601-date="2024-02-27">2024</year><month>02</month><day>27</day></date-in-citation>
          <volume>15</volume>
          <issn>1663-9812</issn>
          <uri>https://www.frontiersin.org/journals/pharmacology/articles/10.3389/fphar.2024.1292828</uri>
        </element-citation>
      </ref>
      <ref id="ref-peduzzi1995">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Peduzzi</surname><given-names>Peter</given-names></name>
            <name><surname>Concato</surname><given-names>John</given-names></name>
            <name><surname>Feinstein</surname><given-names>Alvan R.</given-names></name>
            <name><surname>Holford</surname><given-names>Theodore R.</given-names></name>
          </person-group>
          <article-title>Importance of events per independent variable in proportional hazards regression analysis II. Accuracy and precision of regression estimates</article-title>
          <source>Journal of Clinical Epidemiology</source>
          <year iso-8601-date="1995-12-01">1995</year><month>12</month><day>01</day>
          <volume>48</volume>
          <issue>12</issue>
          <uri>https://www.jclinepi.com/article/0895-4356(95)00048-8/abstract</uri>
          <pub-id pub-id-type="doi">10.1016/0895-4356(95)00048-8</pub-id>
          <fpage>1503</fpage>
          <lpage>1510</lpage>
        </element-citation>
      </ref>
      <ref id="ref-riley2019">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Riley</surname><given-names>Richard D</given-names></name>
            <name><surname>Snell</surname><given-names>Kym IE</given-names></name>
            <name><surname>Ensor</surname><given-names>Joie</given-names></name>
            <name><surname>Burke</surname><given-names>Danielle L</given-names></name>
            <name><surname>Harrell Jr</surname><given-names>Frank E</given-names></name>
            <name><surname>Moons</surname><given-names>Karel GM</given-names></name>
            <name><surname>Collins</surname><given-names>Gary S</given-names></name>
          </person-group>
          <article-title>Minimum sample size for developing a multivariable prediction model: PART II - binary and time-to-event outcomes</article-title>
          <source>Statistics in Medicine</source>
          <year iso-8601-date="2019">2019</year>
          <volume>38</volume>
          <issue>7</issue>
          <uri>https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.7992</uri>
          <pub-id pub-id-type="doi">10.1002/sim.7992</pub-id>
          <fpage>1276</fpage>
          <lpage>1296</lpage>
        </element-citation>
      </ref>
      <ref id="ref-zyvoxpr">
        <element-citation>
          <article-title>Zyvox prescribing information</article-title>
          <uri>https://labeling.pfizer.com/showlabeling.aspx?id=649</uri>
        </element-citation>
      </ref>
    </ref-list>
  </sec>
</sec>
</body>

<back>
</back>

<sub-article article-type="notebook" id="nb-28-nb-article">
<front-stub>
<title-group>
<article-title>Development and Validation of a Risk Prediction Model of
linezolid-induced thrombocytopenia</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ha</surname>
<given-names>Nhi Nguyen</given-names>
</name>
<string-name>Nhi Nguyen Ha</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Quoc</surname>
<given-names>An Tang</given-names>
</name>
<string-name>An Tang Quoc</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ngan</surname>
<given-names>Ha Tran</given-names>
</name>
<string-name>Ha Tran Ngan</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Thu</surname>
<given-names>Hang Nguyen Thi</given-names>
</name>
<string-name>Hang Nguyen Thi Thu</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Dinh</surname>
<given-names>Hoa Vu</given-names>
</name>
<string-name>Hoa Vu Dinh</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Trinh</surname>
<given-names>Nhung TH</given-names>
</name>
<string-name>Nhung TH Trinh</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-2-nb-article">b</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Hoang</surname>
<given-names>Anh Nguyen</given-names>
</name>
<string-name>Anh Nguyen Hoang</string-name>

<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
<xref ref-type="corresp" rid="cor-7-nb-article">&#x002A;</xref>
</contrib>
</contrib-group>
<aff id="aff-1-nb-article">
<institution-wrap>
<institution>The National DI&amp;ADR Centre, Hanoi University of
Pharmacy</institution>
</institution-wrap>







</aff>
<aff id="aff-2-nb-article">
<institution-wrap>
<institution>Pharmacoepidemiology and Drug Safety Research Group,
Department of Pharmacy, Faculty of Mathematics and Natural Sciences,
University of Oslo, Oslo, Norway</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-7-nb-article"></corresp>
</author-notes>
<abstract>
<p>Write abstract here, note the indentation</p>
</abstract>
</front-stub>

<body>
<sec id="checklist-nb-article">
  <title>1. Checklist</title>
  <table-wrap>
    <caption>
      <p>TRIPOD-Cluster checklist of items to include when reporting a
      study developing or validating a multivariable prediction model
      using clustered data</p>
    </caption>
    <table>
      <colgroup>
        <col width="25%" />
        <col width="25%" />
        <col width="26%" />
        <col width="25%" />
      </colgroup>
      <thead>
        <tr>
          <th><bold>Section/topic</bold></th>
          <th align="center"><bold>Item No</bold></th>
          <th><bold>Description</bold></th>
          <th align="center"><bold>Draft date</bold></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><bold>Title and abstract</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Title</td>
          <td align="center">1</td>
          <td>Identify the study as developing and/or validating a
          multivariable prediction model, the target population, and the
          outcome to be predicted</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Abstract</td>
          <td align="center">2</td>
          <td>Provide a summary of research objectives, setting,
          participants, data source, sample size, predictors, outcome,
          statistical analysis, results, and conclusions*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Introduction</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Background and objectives</td>
          <td align="center">3a</td>
          <td>Explain the medical context (including whether diagnostic
          or prognostic) and rationale for developing or validating the
          prediction model, including references to existing models, and
          the advantages of the study design*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">3b</td>
          <td>Specify the objectives, including whether the study
          describes the development or validation of the model*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Methods</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Participants and data</td>
          <td align="center">4a</td>
          <td>Describe eligibility criteria for participants and
          datasets*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">4b</td>
          <td>Describe the origin of the data, and how the data were
          identified, requested, and collected</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Sample size</td>
          <td align="center">5</td>
          <td>Explain how the sample size was arrived at*</td>
          <td align="center">Mar 21</td>
        </tr>
        <tr>
          <td>Outcomes and predictors</td>
          <td align="center">6a</td>
          <td>Define the outcome that is predicted by the model,
          including how and when assessed*</td>
          <td align="center">Mar 21</td>
        </tr>
        <tr>
          <td></td>
          <td align="center">6b</td>
          <td>Define all predictors used in developing or validating the
          model, including how and when measured*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Data preparation</td>
          <td align="center">7a</td>
          <td>Describe how the data were prepared for analysis,
          including any cleaning, harmonisation, linkage, and quality
          checks</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">7b</td>
          <td>Describe the method for assessing risk of bias and
          applicability in the individual clusters (eg, using
          PROBAST)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">7c</td>
          <td>For validation, identify any differences in definition and
          measurement from the development data (eg, setting,
          eligibility criteria, outcome, predictors)*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">7d</td>
          <td>Describe how missing data were handled*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Data analysis</td>
          <td align="center">8a</td>
          <td>Describe how predictors were handled in the analyses</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8b</td>
          <td>Specify the type of model, all model building procedures
          (eg, any predictor selection and penalisation), and method for
          validation*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8c</td>
          <td>Describe how any heterogeneity across clusters (eg,
          studies or settings) in model parameter values was
          handled</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8d</td>
          <td>For validation, describe how the predictions were
          calculated</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8e</td>
          <td>Specify all measures used to assess model performance (eg,
          calibration, discrimination, and decision curve analysis) and,
          if relevant, to compare multiple models</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8f</td>
          <td>Describe how any heterogeneity across clusters (eg,
          studies or settings) in model performance was handled and
          quantified</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8g</td>
          <td>Describe any model updating (eg, recalibration) arising
          from the validation, either overall or for particular
          populations or settings*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Sensitivity analysis</td>
          <td align="center">9</td>
          <td>Describe any planned subgroup or sensitivity analysis—eg,
          assessing performance according to sources of bias,
          participant characteristics, setting</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Results</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Participants and datasets</td>
          <td align="center">10a</td>
          <td>Describe the number of clusters and participants from data
          identified through to data analysed; a flowchart might be
          helpful*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">10b</td>
          <td>Report the characteristics overall and where applicable
          for each data source or setting, including the key dates,
          predictors, treatments received, sample size, number of
          outcome events, follow-up time, and amount of missing
          data*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">10c</td>
          <td>For validation, show a comparison with the development
          data of the distribution of important variables (demographics,
          predictors, and outcome)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Risk of bias</td>
          <td align="center">11</td>
          <td>Report the results of the risk-of-bias assessment in the
          individual clusters</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Model development and specification</td>
          <td align="center">12a</td>
          <td>Report the results of any assessments of heterogeneity
          across clusters that led to subsequent actions during the
          model’s development (eg, inclusion or exclusion of particular
          predictors or clusters)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">12b</td>
          <td>Present the final prediction model (ie, all regression
          coefficients, and model intercept or baseline estimate of the
          outcome at a given time point) and explain how to use it for
          predictions in new individuals*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Model performance</td>
          <td align="center">13a</td>
          <td>Report performance measures (with uncertainty intervals)
          for the prediction model, overall and for each cluster</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">13b</td>
          <td>Report results of any heterogeneity across clusters in
          model performance</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Model updating</td>
          <td align="center">14</td>
          <td>Report the results from any model updating (including the
          updated model equation and subsequent performance), overall
          and for each cluster*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Sensitivity analysis</td>
          <td align="center">15</td>
          <td>Report results from any subgroup or sensitivity
          analysis</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Discussion</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Interpretation</td>
          <td align="center">16a</td>
          <td>Give an overall interpretation of the main results,
          including heterogeneity across clusters in model performance,
          in the context of the objectives and previous studies*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">16b</td>
          <td>For validation, discuss the results with reference to the
          model performance in the development data, and in any previous
          validations</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">16c</td>
          <td>Discuss the strengths of the study and any limitations
          (eg, missing or incomplete data, non-representativeness, data
          harmonisation problems)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Implications</td>
          <td align="center">17</td>
          <td>Discuss the potential use of the model and implications
          for future research, with specific view to generalisability
          and applicability of the model across different settings or
          (sub)populations</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Other information</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Supplementary information</td>
          <td align="center">18</td>
          <td>Provide information about the availability of
          supplementary resources (eg, study protocol, analysis code,
          datasets)*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Funding</td>
          <td align="center">19</td>
          <td>Give the source of funding and the role of the funders for
          the present study</td>
          <td align="center"></td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</sec>
<sec id="introduction-nb-article">
  <title>2. Introduction</title>
  <sec id="background-and-objectives-nb-article">
    <title>2.1 Background and objectives</title>
    <p><bold>First paragraph:</bold> introduction about linezolid and
    associated ADR including thrombocytopenia</p>
    <p><bold>Second paragraph:</bold> what is already known in the
    literature about this association (magnitude and associated
    factors)</p>
    <p><bold>Third paragraph:</bold> the importance of investigation
    this association in Vietnamese settings and develop a risk
    prediction model. Why is this study needed?</p>
    <p>This study aimed to develop and validate a risk prediction model
    of linezolid-induced thrombocytopenia adapted to Vietnamese setting.
    In addition, we constructed a simplified risk score using this model
    to enhance the applicability of the prediction rule in clinical
    practice.</p>
  </sec>
</sec>
<sec id="methods-nb-article">
  <title>3. Methods</title>
  <sec id="participants-and-data-nb-article">
    <title>3.1 Participants and data</title>
    <sec id="a-describe-eligibility-criteria-for-participants-and-datasets-nb-article">
      <title>3.1.1 4a: Describe eligibility criteria for participants
      and datasets</title>
      <p>This study used data from three tertiary hospitals in Northern
      Vietnam: Thanh Nhan Hospital, Bach Mai Hospital, and the National
      Hospital of Tropical Diseases. Patients hospitalized and treated
      with linezolid were included. The following patients were
      excluded: (i) those under 18 years of age; (ii) those treated with
      linezolid for less than 3 days; (iii) those without any recorded
      platelet count in the period before or after initiation of
      linezolid therapy; (iv) those with baseline platelet count of &gt;
      450 x 10<sup>9</sup> cells/L; (v) those with any missing recorded
      values among the specified predictors. Each patient was included
      only once per admission and the first linezolid treatment course
      was evaluated. Included patients were followed up until the end of
      the linezolid treatment course or discharge date whichever comes
      first.</p>
    </sec>
    <sec id="b-describe-the-origin-of-the-data-and-how-the-data-were-identified-requested-and-collected-nb-article">
      <title>3.1.2 4b: Describe the origin of the data, and how the data
      were identified, requested, and collected</title>
      <p>The data was collected from each hospital in two phases: a
      pilot phase and an extension phase. In the pilot phase, we
      requested existing datasets at the hospitals. In the extension
      phase, additional data was collected prospectively. Data was
      extracted from the electronic medical records of the hospitals,
      except for the pilot dataset at Bach Mai Hospital which was
      extracted from physical records. In order to harmonise different
      datasets, data was filled out in a paper form and stored in
      Excel.</p>
      <p>The pilot datasets were collected from January 01 to June 30,
      2020 at Thanh Nhan Hospital; from November 01 to December 31, 2019
      at Bach Mai Hospital; from May 01 to December 31, 2021 at the
      National Hospital of Tropical Diseases. The extension datasets
      were collected from September 01, 2022 to March 31, 2023 at Thanh
      Nhan Hospital; from December 01, 2022 to March 31, 2023 at Bach
      Mai Hospital; from April 01 to September 31, 2022 at the National
      Hospital of Tropical Diseases. <italic>(comment: no data of total
      number of patients admitted to these hospitals during each
      period)</italic></p>
      <p>The anonymized data were extracted from electronical medical
      records at each medical institution, except data from Bach Mai
      Hospital in the pilot phase. Individual ID number were assigned to
      each patient’s hospital admission.</p>
      <p>Ethical approval was obtained from….</p>
    </sec>
  </sec>
  <sec id="sample-size-nb-article">
    <title>3.2 Sample size</title>
    <p>Previous studies developing logistic regression models for LI-TP
    risk predictions have included 4-6 predictors in their final models
    [<xref alt="1" rid="ref-liu_analysis_2021-nb-article" ref-type="bibr">1</xref>–<xref alt="4" rid="ref-xu_establishment_2023-nb-article" ref-type="bibr">4</xref>].
    We expect to include about as many candidate predictors, based on
    results from the expert opinion survey and the Bayesian Model
    Selection algorithm
    <xref alt="see 3.3" rid="sec-outcomes-and-predictors-nb-article">see 3.3</xref>.
    Some of the candidate predictors might be continuous, which may
    potentially require non-linear modelling and therefore slightly
    increase the number of variables.</p>
    <p>A general rule of thumb is for at least 10 events be available
    for each candidate predictor considered in a prediction model
    [<xref alt="5" rid="ref-peduzzi1995-nb-article" ref-type="bibr">5</xref>]. We
    have a total of 816 eligible patients and 264 of those have
    experienced the outcome. If the number of candidate predictors is 7,
    we would have 37 events per candidate predictor, which is
    considerably greater than the minimum number required. Even if the
    number of parameters screened is 20, we would still have 13 events
    per candidate predictor.</p>
    <p>However, the aforementioned rule of thumb have generated some
    debate in the literature, with recent results suggesting that event
    per variable criterion is too simplistic and has no strong relation
    to the predictive performance of a model. Riley et al
    [<xref alt="6" rid="ref-riley2019-nb-article" ref-type="bibr">6</xref>]
    proposed a different set of criteria to estimate minimum sample size
    for models developed using logistic regression, which are the
    following:</p>
    <list list-type="order">
      <list-item>
        <p>Small optimism in predictor effect estimates, defined as a
        global shrinkage factor of &gt;= 0.9.</p>
      </list-item>
      <list-item>
        <p>Small absolute difference of &lt;= 0.05 in the model’s
        apparent and adjusted Nagelkerke’s R-squared.</p>
      </list-item>
      <list-item>
        <p>Precise estimation of the overall risk in the population.</p>
      </list-item>
    </list>
    <p>Criteria 1 and 2 aims to reduce the potential of overfitting.
    Criteria 3 aims to ensure the overall risk is estimated
    precisely.</p>
    <sec id="step-1-choose-the-number-of-candidate-predictors-of-interest-for-inclusion-in-the-model-and-calculate-the-corresponding-number-of-predictor-parameters-p-nb-article">
      <title>3.2.1 Step 1: Choose the number of candidate predictors of
      interest for inclusion in the model, and calculate the
      corresponding number of predictor parameters (p)</title>
      <p>Note that one predictor may require two or more parameters. For
      example, a k-category predictor requires k-1 parameters and a
      continuous predictor model with a non-linear trend requires more
      than one parameter to be estimated. Also include any potential
      interaction terms towards the total p.</p>
      <p>When using a predictor selection method, p should be defined as
      the total number of parameters screened, and not just the subset
      that are included in the final model.</p>
      <p>Assuming maximum total p to be 20.</p>
      <boxed-text>
        <disp-quote>
          <p><bold>Note</bold></p>
          <p>The value of p is assumed to be no larger than 20 because
          univariate regression shows there are 20 variables that are
          significantly correlated with the outcome.</p>
        </disp-quote>
      </boxed-text>
      <sec id="nb-code-cell-1-nb-article" specific-use="notebook-code">
      <code language="r script">parameter_number &lt;- 20
sample_size &lt;- 816</code>
      </sec>
    </sec>
    <sec id="step-2-choose-sensible-values-for-r2cs_adj-and-maxr2cs_app-based-on-previous-studies-where-r2cs-is-the-cox-snell-r2-statistic.-nb-article">
      <title>3.2.2 Step 2: Choose sensible values for
      R<sup>2</sup><sub>CS_adj</sub> and
      max(R<sup>2</sup><sub>CS_app</sub>) based on previous studies
      where R<sup>2</sup><sub>CS</sub> is the Cox-Snell R<sup>2</sup>
      statistic.</title>
      <p>The value of max(R<sup>2</sup><sub>CS_app</sub>) is based on
      the overall prevalence or overall rate of the outcome in the
      population of interest. The incidence of LI-TP in patients treated
      with linezolid was estimated to be 37% in a meta-analysis by Zhao
      et al
      [<xref alt="7" rid="ref-zhao_prediction_2024-nb-article" ref-type="bibr">7</xref>].</p>
      <p>The value of R<sup>2</sup><sub>CS_adj</sub> could be based on
      that for a previously published model in the same setting and
      population (with similar outcome definition). However, as previous
      studies does not provide any information to identify a sensible
      value of the minimum expected Cox-Snell R<sup>2</sup>, the value
      R<sup>2</sup><sub>CS_adj</sub> will be assumed to correspond to a
      R<sup>2</sup><sub>Nagelkerke</sub> of 0.50, as baseline platelet
      count, a “direct” measurement of the outcome, is likely to be a
      predictor.</p>
      <sec id="nb-code-cell-2-nb-article" specific-use="notebook-code">
      <code language="r script">calculate_R2_CS_adj &lt;- function(n = 100, E, R2_N = 0.15) {
  ln_L_null &lt;- E * log(E / n) + (n - E) * log(1 - E / n)
  max_R2_CS_app &lt;- 1 - exp(2 * ln_L_null / n)
  R2_CS_adj &lt;- R2_N / max_R2_CS_app
  return(list(R2_CS_adj = R2_CS_adj, max_R2_CS_app = max_R2_CS_app))
}

(cox_snell_r2 &lt;- calculate_R2_CS_adj(E = 37)$R2_CS_adj)</code>
      <code language="r script">max_apparent_cox_snell_r2 &lt;- calculate_R2_CS_adj(E = 37)$max_R2_CS_app</code>
      <sec id="nb-code-cell-2-output-0-nb-article" specific-use="notebook-output">
      <preformat>[1] 0.2048324</preformat>
      </sec>
      </sec>
    </sec>
    <sec id="step-3-criterion-1-nb-article">
      <title>3.2.3 Step 3: Criterion 1</title>
      <p>Calculate the sample size required to ensure Van Houwelingen’s
      global shrinkage factor (S<sub>VH</sub>) is close to 1. A value of
      S<sub>VH</sub> &gt;= 0.90 is generally recommended, which reflects
      a small amount of overfitting during model development.</p>
      <sec id="nb-code-cell-3-nb-article" specific-use="notebook-code">
      <code language="r script">calculate_sample_size_1 &lt;- function(p, R2_CS_adj, S_VH = 0.90) {
  n &lt;- p / ((S_VH - 1) * log(1 - R2_CS_adj / S_VH))
  return(n)
}

(
  sample_size_criterion_1 &lt;-
    calculate_sample_size_1(
      p = parameter_number,
      R2_CS_adj = cox_snell_r2
    ) |&gt; ceiling()
)</code>
      <code language="r script">calculate_param_limit_1 &lt;- function(n, R2_CS_adj, S_VH = 0.90) {
  p &lt;- n * ((S_VH - 1) * log(1 - R2_CS_adj / S_VH))
  return(p)
}

(
  parameter_limit_1 &lt;- calculate_param_limit_1(
    n = sample_size,
    R2_CS_adj = cox_snell_r2
  ) |&gt; floor()
)</code>
      <sec id="nb-code-cell-3-output-0-nb-article" specific-use="notebook-output">
      <preformat>[1] 775</preformat>
      </sec>
      <sec id="nb-code-cell-3-output-1-nb-article" specific-use="notebook-output">
      <preformat>[1] 21</preformat>
      </sec>
      </sec>
      <p>We see that 775 participants are required to meet criterion
      1.</p>
    </sec>
    <sec id="step-4-criterion-2-nb-article">
      <title>3.2.4 Step 4: Criterion 2</title>
      <p>Calculate the shrinkage factor (S<sub>VH</sub>) required to
      ensure a small absolute difference of &lt;= 0.05 in the developed
      model’s apparent and adjusted Nagelkerke’s R<sup>2</sup>. Then
      derive the required sample size conditional on this value of
      S<sub>VH</sub>.</p>
      <sec id="nb-code-cell-4-nb-article" specific-use="notebook-code">
      <code language="r script">calculate_sample_size_2 &lt;- function(p, R2_CS_adj, max_R2_CS_app, delta = 0.05) {
  S_VH &lt;- R2_CS_adj / (R2_CS_adj + delta * max_R2_CS_app)
  n &lt;- p / ((S_VH - 1) * log(1 - R2_CS_adj / S_VH))
  return(n)
}

(
  sample_size_criterion_2 &lt;-
    calculate_sample_size_2(
      p = parameter_number,
      R2_CS_adj = cox_snell_r2,
      max_R2_CS_app = max_apparent_cox_snell_r2
    ) |&gt; ceiling()
)</code>
      <code language="r script">calculate_param_limit_2 &lt;- function(n, R2_CS_adj, max_R2_CS_app, delta = 0.05) {
  S_VH &lt;- R2_CS_adj / (R2_CS_adj + delta * max_R2_CS_app)
  p &lt;- n * ((S_VH - 1) * log(1 - R2_CS_adj / S_VH))
  return(p)
}

(
  parameter_limit_2 &lt;- calculate_param_limit_2(
    n = sample_size,
    R2_CS_adj = cox_snell_r2,
    max_R2_CS_app = max_apparent_cox_snell_r2
  ) |&gt; floor()
) </code>
      <sec id="nb-code-cell-4-output-0-nb-article" specific-use="notebook-output">
      <preformat>[1] 478</preformat>
      </sec>
      <sec id="nb-code-cell-4-output-1-nb-article" specific-use="notebook-output">
      <preformat>[1] 34</preformat>
      </sec>
      </sec>
      <p>We see that 478 participants are required to meet criterion
      2.</p>
    </sec>
    <sec id="step-5-criterion-3-nb-article">
      <title>3.2.5 Step 5: Criterion 3</title>
      <p>Calculate the sample size required to ensure a precise estimate
      of the overall risk in the population. The suggested absolute
      margin of error is &lt;= 0.05.</p>
      <sec id="nb-code-cell-5-nb-article" specific-use="notebook-code">
      <code language="r script">calculate_sample_size_3 &lt;- function(phi_hat, delta = 0.05) {
  n &lt;- (1.96 / delta)^2 * phi_hat * (1 - phi_hat)
  return(n)
}

(
  sample_size_criterion_3 &lt;-
    calculate_sample_size_3(phi_hat = 0.37) |&gt; ceiling()
)</code>
      <sec id="nb-code-cell-5-output-0-nb-article" specific-use="notebook-output">
      <preformat>[1] 359</preformat>
      </sec>
      </sec>
      <p>We see that 359 participants are required to meet criterion
      3.</p>
    </sec>
    <sec id="step-6-final-sample-size-nb-article">
      <title>3.2.6 Step 6: Final sample size</title>
      <p>The required minimum sample size is the maximum value from
      steps 3 to 5, to ensure that each of criteria 1 to 3 are met.</p>
      <sec id="nb-code-cell-6-nb-article" specific-use="notebook-code">
      <code language="r script">(minimum_sample_size &lt;- max(sample_size_criterion_1, sample_size_criterion_2, sample_size_criterion_3))</code>
      <code language="r script">(maximum_parameter_limit &lt;- min(parameter_limit_1, parameter_limit_2))</code>
      <sec id="nb-code-cell-6-output-0-nb-article" specific-use="notebook-output">
      <preformat>[1] 775</preformat>
      </sec>
      <sec id="nb-code-cell-6-output-1-nb-article" specific-use="notebook-output">
      <preformat>[1] 21</preformat>
      </sec>
      </sec>
      <p>The final estimate of minimum sample size is 775, therefore our
      data is sufficient for model development with 20 parameters.</p>
      <p>The maximum number of parameters that can be screened is
      21.</p>
    </sec>
  </sec>
  <sec id="sec-outcomes-and-predictors-nb-article">
    <title>3.3 Outcomes and predictors</title>
    <sec id="a.-define-the-outcome-that-is-predicted-by-the-model-including-how-and-when-assessed-nb-article">
      <title>3.3.1 6a. Define the outcome that is predicted by the
      model, including how and when assessed</title>
      <p>The outcome of interest is linezolid-induced thrombocytopenia,
      defined as (i) a platelet count of &lt; 112.5 x 10<sup>9</sup>
      cells/L (75% of the lower limit of normal) for patients with a
      baseline platelet count in the normal range; (ii) A reduction in
      platelet count of ≥ 25% from the baseline value for patients with
      a baseline platelet count of &lt; 150 x 10<sup>9</sup> cells/L
      [<xref alt="4" rid="ref-xu_establishment_2023-nb-article" ref-type="bibr">4</xref>,<xref alt="8" rid="ref-zyvoxpr-nb-article" ref-type="bibr">8</xref>,<xref alt="9" rid="ref-kawasuji_proposal_2021-nb-article" ref-type="bibr">9</xref>].</p>
      <p>Normal platelet count is defined as 150-450 x 10<sup>9</sup>
      cells/L. Baseline platelet count is defined as the last recorded
      PLT value before the start of linezolid therapy. Participants are
      considered to have met the outcome if their platelet count value
      meets the above criteria at any time during linezolid therapy or
      within 5 days after the end of therapy.</p>
      <boxed-text>
        <disp-quote>
          <p><bold>Warning</bold></p>
          <p>Thrombocytopenia may occur within a few days after stopping
          LZD, when the drug hasn’t been completely eliminated. However,
          it is unknown exactly how long after stopping LZD can a TP
          event still be attributed to LZD use. We deemed that any TP
          events that occur after 5 days of stopping LZD would not be
          related to LZD use.</p>
          <p>Our rationale is that after 5 days (120 hrs), LZD is
          guaranteed to be completely eliminated in all patients, as the
          longest t<sub>1/2</sub> is 8.3 ± 2.4 hrs in end-stage renal
          disease patients, +3 SD would be ~16 hrs, so 120 hrs is &gt;7
          half-lives, therefore in patients with the worst clearance,
          99% of them would have 99% of the drug eliminated from their
          systems. Furthermore, trough LZD concentration
          (C<sub>min</sub>) has previously been identified as a
          predictor of LI-TP development, and LI-TP itself is mostly
          reversible after discontinuation, so we would argue that any
          TP events that occur after LZD has been eliminated from the
          system would not be related to LZD use.</p>
        </disp-quote>
      </boxed-text>
    </sec>
    <sec id="b.-define-all-predictors-used-in-developing-or-validating-the-model-including-how-and-when-measured-nb-article">
      <title>3.3.2 6b. Define all predictors used in developing or
      validating the model, including how and when measured</title>
      <p>Predictors will be screened for inclusion in the model if they
      meet all of the following criteria: (i) has been identified as a
      risk factor of LI-TP in previous studies; (ii) can be collected or
      evaluated from the information in the datasets; (iii) for
      concomitant medications, has drug-induced immune thrombocytopenia
      as an adverse drug reaction with a frequency of at least &gt;
      1/1000 in the drug label or Micromedex; (iv) has consensus from a
      clinical expert panel as possibly related to LI-TP
      development.</p>
      <p>The following information was extracted from all records:</p>
      <list list-type="bullet">
        <list-item>
          <p>Patient demographics</p>
        </list-item>
        <list-item>
          <p>Clinical department where linezolid was initiated.</p>
        </list-item>
        <list-item>
          <p>Co-morbidities</p>
        </list-item>
        <list-item>
          <p>Invasive procedures performed</p>
        </list-item>
        <list-item>
          <p>Infection type</p>
        </list-item>
        <list-item>
          <p>Laboratory results</p>
        </list-item>
        <list-item>
          <p>Linezolid route of administration</p>
        </list-item>
        <list-item>
          <p>Linezolid dose in milligrams.</p>
        </list-item>
        <list-item>
          <p>Linezolid duration, defined as the number of days from the
          first to the last dose of linezolid.</p>
        </list-item>
        <list-item>
          <p>Concomitant medications during linezolid therapy</p>
        </list-item>
      </list>
    </sec>
  </sec>
  <sec id="data-preparation-nb-article">
    <title>3.4 Data preparation</title>
    <sec id="a.-describe-how-the-data-were-prepared-for-analysis-including-any-cleaning-harmonisation-linkage-and-quality-checks-nb-article">
      <title>3.4.1 7a. Describe how the data were prepared for analysis,
      including any cleaning, harmonisation, linkage, and quality
      checks</title>
      <p>Harmonisation between datasets was mainly done via manually
      recording data to a standardized form. Data was then entered into
      an Excel spreadsheet. Data cleaning was done by handling
      duplicates, checking for missing values and inconsistencies.
      Multiple linezolid treatment episodes in the same patient were
      treated as duplicates and only the first episode was included in
      the analysis. Patients with missing values were excluded from
      subsequent analyses. Inconsistencies were resolved by referring
      back to the original records.</p>
      <p>Before analysis, the extracted predictors are limited to those
      that meet criteria (i) to (iii) in the previous section:</p>
      <list list-type="bullet">
        <list-item>
          <p>Patient demographics were limited to age in years, gender,
          and weight in kilograms.</p>
        </list-item>
        <list-item>
          <p>Clinical department was recorded into binary variables:
          intensive care unit, emergency department, and others.</p>
        </list-item>
        <list-item>
          <p>Co-morbidities were recorded into binary variables:
          hypertension, heart failure, angina, myocardial infarction,
          cerebral vascular accident, diabetes, chronic obstructive
          pulmonary disease, cirrhosis, malignancies, and hematological
          disorders.</p>
        </list-item>
        <list-item>
          <p>Invasive procedures were recorded into binary variables:
          endotracheal intubation, central venous catheter insertion,
          intermittent hemodialysis, and continuous renal replacement
          therapy.</p>
        </list-item>
        <list-item>
          <p>Infection type was recorded into binary variables:
          community-acquired pneumonia, hospital-acquired pneumonia,
          skin and soft tissue infection, central nervous system
          infection, intra-abdominal infection, urinary tract infection,
          bone and joint infection, septicemia, and sepsis.</p>
        </list-item>
        <list-item>
          <p>Laboratory results were limited to serum creatinine,
          hemoglobin count, white blood cell count, and platelet count.
          Creatinine clearance was estimated from serum creatinine using
          the Cockcroft-Gault equation.</p>
        </list-item>
        <list-item>
          <p>Linezolid route of administration was recorded into binary
          variables: intravenous, oral, and both.</p>
        </list-item>
        <list-item>
          <p>Linezolid dose in milligrams.</p>
        </list-item>
        <list-item>
          <p>Linezolid duration in days.</p>
        </list-item>
        <list-item>
          <p>Concomitant medications were recoded to binary variables:
          carbapenems, daptomycin, teicoplanin, levofloxacin, ibuprofen,
          naproxen, heparin, clopidogrel, enoxaparin, eptifibatide,
          carbamazepine, valproic acid, quetiapine, atezolizumab,
          pembrolizumab, trastuzumab, tacrolimus, fluorouracil,
          irinotecan, leucovorin, oxaliplatin, pyrazinamide, and
          rifampin.</p>
        </list-item>
      </list>
    </sec>
    <sec id="b.-describe-the-method-for-assessing-risk-of-bias-and-applicability-in-the-individual-clusters-eg-using-probast-nb-article">
      <title>3.4.2 7b. Describe the method for assessing risk of bias
      and applicability in the individual clusters (eg, using
      PROBAST)</title>
      <boxed-text>
        <disp-quote>
          <p><bold>Important</bold></p>
          <p>Is this even possible for this study?</p>
        </disp-quote>
      </boxed-text>
    </sec>
    <sec id="c.-for-validation-identify-any-differences-in-definition-and-measurement-from-the-development-data-eg-setting-eligibility-criteria-outcome-predictors-nb-article">
      <title>3.4.3 7c. For validation, identify any differences in
      definition and measurement from the development data (eg, setting,
      eligibility criteria, outcome, predictors)</title>
    </sec>
    <sec id="d.-describe-how-missing-data-were-handled-nb-article">
      <title>3.4.4 7d. Describe how missing data were handled</title>
      <p>Any subsequent analyses were conducted on the complete case
      dataset. There are ~5% of observations with missing values in the
      dataset, which is considered low. The missing data mechanism is
      assumed to be missing completely at random.</p>
      <boxed-text>
        <disp-quote>
          <p><bold>Important</bold></p>
          <p>What is a possible reason for missing data?</p>
        </disp-quote>
      </boxed-text>
    </sec>
  </sec>
  <sec id="data-analysis-nb-article">
    <title>3.5 Data analysis</title>
    <sec id="a.-describe-how-predictors-were-handled-in-the-analyses-nb-article">
      <title>3.5.1 8a. Describe how predictors were handled in the
      analyses</title>
    </sec>
    <sec id="b.-specify-the-type-of-model-all-model-building-procedures-eg-any-predictor-selection-and-penalisation-and-method-for-validation-nb-article">
      <title>3.5.2 8b. Specify the type of model, all model building
      procedures (eg, any predictor selection and penalisation), and
      method for validation</title>
    </sec>
    <sec id="c.-describe-how-any-heterogeneity-across-clusters-eg-studies-or-settings-in-model-parameter-values-was-handled-nb-article">
      <title>3.5.3 8c. Describe how any heterogeneity across clusters
      (eg, studies or settings) in model parameter values was
      handled</title>
    </sec>
    <sec id="d.-for-validation-describe-how-the-predictions-were-calculated-nb-article">
      <title>3.5.4 8d. For validation, describe how the predictions were
      calculated</title>
    </sec>
    <sec id="e.-specify-all-measures-used-to-assess-model-performance-eg-calibration-discrimination-and-decision-curve-analysis-and-if-relevant-to-compare-multiple-models-nb-article">
      <title>3.5.5 8e. Specify all measures used to assess model
      performance (eg, calibration, discrimination, and decision curve
      analysis) and, if relevant, to compare multiple models</title>
    </sec>
    <sec id="f.-describe-how-any-heterogeneity-across-clusters-eg-studies-or-settings-in-model-performance-was-handled-and-quantified-nb-article">
      <title>3.5.6 8f. Describe how any heterogeneity across clusters
      (eg, studies or settings) in model performance was handled and
      quantified</title>
    </sec>
    <sec id="g.-describe-any-model-updating-eg-recalibration-arising-from-the-validation-either-overall-or-for-particular-populations-or-settings-nb-article">
      <title>3.5.7 8g. Describe any model updating (eg, recalibration)
      arising from the validation, either overall or for particular
      populations or settings</title>
    </sec>
  </sec>
  <sec id="sensitivity-analysis-nb-article">
    <title>3.6 Sensitivity analysis</title>
  </sec>
</sec>
<sec id="results-nb-article">
  <title>4. Results</title>
  <sec id="participants-and-datasets-nb-article">
    <title>4.1 Participants and datasets</title>
  </sec>
  <sec id="risk-of-bias-nb-article">
    <title>4.2 Risk of bias</title>
  </sec>
  <sec id="model-development-and-specification-nb-article">
    <title>4.3 Model development and specification</title>
  </sec>
  <sec id="model-performance-nb-article">
    <title>4.4 Model performance</title>
  </sec>
  <sec id="model-updating-nb-article">
    <title>4.5 Model updating</title>
  </sec>
  <sec id="sensitivity-analysis-1-nb-article">
    <title>4.6 Sensitivity analysis</title>
  </sec>
</sec>
<sec id="discussion-nb-article">
  <title>5. Discussion</title>
  <sec id="interpretation-nb-article">
    <title>5.1 Interpretation</title>
  </sec>
  <sec id="implications-nb-article">
    <title>5.2 Implications</title>
  </sec>
</sec>
<sec id="other-information-nb-article">
  <title>6. Other information</title>
  <sec id="supplementary-information-nb-article">
    <title>6.1 Supplementary information</title>
  </sec>
  <sec id="funding-nb-article">
    <title>6.2 Funding</title>
  </sec>
  <sec id="references-nb-article">
    <title>6.3 References</title>
    <ref-list>
      <ref id="ref-duan_regression_2022-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Duan</surname><given-names>L.</given-names></name>
            <name><surname>Zhou</surname><given-names>Q.</given-names></name>
            <name><surname>Feng</surname><given-names>Z.</given-names></name>
            <name><surname>Zhu</surname><given-names>C.</given-names></name>
            <name><surname>Cai</surname><given-names>Y.</given-names></name>
            <name><surname>Wang</surname><given-names>S.</given-names></name>
            <name><surname>Zhu</surname><given-names>M.</given-names></name>
            <name><surname>Li</surname><given-names>J.</given-names></name>
            <name><surname>Yuan</surname><given-names>Y.</given-names></name>
            <name><surname>Liu</surname><given-names>X.</given-names></name>
            <name><surname>Sun</surname><given-names>J.</given-names></name>
            <name><surname>Yang</surname><given-names>Z.</given-names></name>
            <name><surname>Tang</surname><given-names>L.</given-names></name>
          </person-group>
          <article-title>A Regression Model to Predict Linezolid Induced Thrombocytopenia in Neonatal Sepsis Patients: A Ten-Year Retrospective Cohort Study</article-title>
          <source>Front Pharmacol</source>
          <year iso-8601-date="2022">2022</year>
          <volume>13</volume>
          <issn>1663-9812 (Print) 1663-9812 (Electronic) 1663-9812 (Linking)</issn>
          <uri>https://www.ncbi.nlm.nih.gov/pubmed/35185555</uri>
          <pub-id pub-id-type="doi">10.3389/fphar.2022.710099</pub-id>
          <fpage>710099</fpage>
          <lpage></lpage>
        </element-citation>
      </ref>
      <ref id="ref-qin_development_2021-nb-article">
        <element-citation publication-type="report">
          <person-group person-group-type="author">
            <name><surname>Qin</surname><given-names>Yan</given-names></name>
            <name><surname>Chen</surname><given-names>Zhe</given-names></name>
            <name><surname>Gao</surname><given-names>Shuai</given-names></name>
            <name><surname>Pan</surname><given-names>Ming Kun</given-names></name>
            <name><surname>Li</surname><given-names>Yu Xiao</given-names></name>
            <name><surname>Lv</surname><given-names>Zhou Qian</given-names></name>
            <name><surname>Shen</surname><given-names>Yun</given-names></name>
            <name><surname>Ye</surname><given-names>Yanrong</given-names></name>
          </person-group>
          <article-title>Development and Validation of a Risk Prediction Model of Linezolid-induced Thrombocytopenia in Elderly Patients</article-title>
          <publisher-name>In Review</publisher-name>
          <year iso-8601-date="2021-06">2021</year><month>06</month>
          <date-in-citation content-type="access-date"><year iso-8601-date="2023-08-17">2023</year><month>08</month><day>17</day></date-in-citation>
          <uri>https://www.researchsquare.com/article/rs-582799/v1</uri>
          <pub-id pub-id-type="doi">10.21203/rs.3.rs-582799/v1</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-kawasuji_proposal_2021-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Kawasuji</surname><given-names>Hitoshi</given-names></name>
            <name><surname>Tsuji</surname><given-names>Yasuhiro</given-names></name>
            <name><surname>Ogami</surname><given-names>Chika</given-names></name>
            <name><surname>Kimoto</surname><given-names>Kou</given-names></name>
            <name><surname>Ueno</surname><given-names>Akitoshi</given-names></name>
            <name><surname>Miyajima</surname><given-names>Yuki</given-names></name>
            <name><surname>Kawago</surname><given-names>Koyomi</given-names></name>
            <name><surname>Sakamaki</surname><given-names>Ippei</given-names></name>
            <name><surname>Yamamoto</surname><given-names>Yoshihiro</given-names></name>
          </person-group>
          <article-title>Proposal of initial and maintenance dosing regimens with linezolid for renal impairment patients</article-title>
          <source>BMC Pharmacology and Toxicology</source>
          <year iso-8601-date="2021-03">2021</year><month>03</month>
          <date-in-citation content-type="access-date"><year iso-8601-date="2024-02-26">2024</year><month>02</month><day>26</day></date-in-citation>
          <volume>22</volume>
          <issue>1</issue>
          <issn>2050-6511</issn>
          <uri>https://doi.org/10.1186/s40360-021-00479-w</uri>
          <pub-id pub-id-type="doi">10.1186/s40360-021-00479-w</pub-id>
          <fpage>13</fpage>
          <lpage></lpage>
        </element-citation>
      </ref>
      <ref id="ref-xu_establishment_2023-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Xu</surname><given-names>Jinhui</given-names></name>
            <name><surname>Lu</surname><given-names>Jian</given-names></name>
            <name><surname>Yuan</surname><given-names>Yunlong</given-names></name>
            <name><surname>Duan</surname><given-names>Lufen</given-names></name>
            <name><surname>Shi</surname><given-names>Lu</given-names></name>
            <name><surname>Chen</surname><given-names>Fang</given-names></name>
            <name><surname>Cao</surname><given-names>Yifei</given-names></name>
            <name><surname>Xu</surname><given-names>Guangjuan</given-names></name>
            <name><surname>Feng</surname><given-names>Zongtai</given-names></name>
            <name><surname>Li</surname><given-names>Lan</given-names></name>
            <name><surname>Xue</surname><given-names>Hongzhi</given-names></name>
            <name><surname>Sun</surname><given-names>Jiantong</given-names></name>
            <name><surname>Zhou</surname><given-names>Qin</given-names></name>
            <name><surname>Zhuang</surname><given-names>Zhiwei</given-names></name>
            <name><surname>Tang</surname><given-names>Lian</given-names></name>
          </person-group>
          <article-title>Establishment and validation of a risk prediction model incorporating concentrations of linezolid and its metabolite PNU142300 for linezolid-induced thrombocytopenia</article-title>
          <source>The Journal of Antimicrobial Chemotherapy</source>
          <year iso-8601-date="2023-08">2023</year><month>08</month>
          <volume>78</volume>
          <issue>8</issue>
          <issn>1460-2091</issn>
          <pub-id pub-id-type="doi">10.1093/jac/dkad191</pub-id>
          <pub-id pub-id-type="pmid">37341139</pub-id>
          <fpage>1974</fpage>
          <lpage>1981</lpage>
        </element-citation>
      </ref>
      <ref id="ref-liu_analysis_2021-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Liu</surname><given-names>YX</given-names></name>
            <name><surname>Liu</surname><given-names>TT</given-names></name>
            <name><surname>Wei</surname><given-names>G</given-names></name>
            <name><surname>Yan</surname><given-names>P</given-names></name>
            <name><surname>Fang</surname><given-names>XQ</given-names></name>
            <name><surname>Xie</surname><given-names>LX</given-names></name>
          </person-group>
          <article-title>Analysis of risk factors and establishment of risk prediction model for linezolid-associated thrombocytopenia.</article-title>
          <source>Medical Journal of Chinese People’s Liberation Army</source>
          <year iso-8601-date="2021">2021</year>
          <volume>46</volume>
          <issue>8</issue>
          <uri>https://d.wanfangdata.com.cn/periodical/jfjyxzz202108006</uri>
          <pub-id pub-id-type="doi">10.11855/j.issn.0577-7402.2021.08.06</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-zhao_prediction_2024-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Zhao</surname><given-names>Xian</given-names></name>
            <name><surname>Peng</surname><given-names>Qin</given-names></name>
            <name><surname>Hu</surname><given-names>Dongmei</given-names></name>
            <name><surname>Li</surname><given-names>Weiwei</given-names></name>
            <name><surname>Ji</surname><given-names>Qing</given-names></name>
            <name><surname>Dong</surname><given-names>Qianqian</given-names></name>
            <name><surname>Huang</surname><given-names>Luguang</given-names></name>
            <name><surname>Piao</surname><given-names>Miyang</given-names></name>
            <name><surname>Ding</surname><given-names>Yi</given-names></name>
            <name><surname>Wang</surname><given-names>Jingwen</given-names></name>
          </person-group>
          <article-title>Prediction of risk factors for linezolid-induced thrombocytopenia based on neural network model</article-title>
          <source>Frontiers in Pharmacology</source>
          <year iso-8601-date="2024">2024</year>
          <date-in-citation content-type="access-date"><year iso-8601-date="2024-02-27">2024</year><month>02</month><day>27</day></date-in-citation>
          <volume>15</volume>
          <issn>1663-9812</issn>
          <uri>https://www.frontiersin.org/journals/pharmacology/articles/10.3389/fphar.2024.1292828</uri>
        </element-citation>
      </ref>
      <ref id="ref-peduzzi1995-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Peduzzi</surname><given-names>Peter</given-names></name>
            <name><surname>Concato</surname><given-names>John</given-names></name>
            <name><surname>Feinstein</surname><given-names>Alvan R.</given-names></name>
            <name><surname>Holford</surname><given-names>Theodore R.</given-names></name>
          </person-group>
          <article-title>Importance of events per independent variable in proportional hazards regression analysis II. Accuracy and precision of regression estimates</article-title>
          <source>Journal of Clinical Epidemiology</source>
          <year iso-8601-date="1995-12-01">1995</year><month>12</month><day>01</day>
          <volume>48</volume>
          <issue>12</issue>
          <uri>https://www.jclinepi.com/article/0895-4356(95)00048-8/abstract</uri>
          <pub-id pub-id-type="doi">10.1016/0895-4356(95)00048-8</pub-id>
          <fpage>1503</fpage>
          <lpage>1510</lpage>
        </element-citation>
      </ref>
      <ref id="ref-riley2019-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Riley</surname><given-names>Richard D</given-names></name>
            <name><surname>Snell</surname><given-names>Kym IE</given-names></name>
            <name><surname>Ensor</surname><given-names>Joie</given-names></name>
            <name><surname>Burke</surname><given-names>Danielle L</given-names></name>
            <name><surname>Harrell Jr</surname><given-names>Frank E</given-names></name>
            <name><surname>Moons</surname><given-names>Karel GM</given-names></name>
            <name><surname>Collins</surname><given-names>Gary S</given-names></name>
          </person-group>
          <article-title>Minimum sample size for developing a multivariable prediction model: PART II - binary and time-to-event outcomes</article-title>
          <source>Statistics in Medicine</source>
          <year iso-8601-date="2019">2019</year>
          <volume>38</volume>
          <issue>7</issue>
          <uri>https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.7992</uri>
          <pub-id pub-id-type="doi">10.1002/sim.7992</pub-id>
          <fpage>1276</fpage>
          <lpage>1296</lpage>
        </element-citation>
      </ref>
      <ref id="ref-zyvoxpr-nb-article">
        <element-citation>
          <article-title>Zyvox prescribing information</article-title>
          <uri>https://labeling.pfizer.com/showlabeling.aspx?id=649</uri>
        </element-citation>
      </ref>
    </ref-list>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-4-nb-1">
<front-stub>
<title-group>
<article-title>Data Cleaning</article-title>
</title-group>
</front-stub>

<body>
<sec id="inputs-nb-1">
  <title>Inputs</title>
  <p>Import processed original data from the
  <monospace>data-original-processed</monospace> directory, which is
  available on Github.</p>
  <p>The import code is in the <monospace>process-data.R</monospace>
  file in the <monospace>data-original-processed</monospace>
  directory.</p>
  <p>The unprocessed data in Excel format is not available on GitHub as
  it contains non-anonymized patient data.</p>
  <p>Some cleaning steps were performed in Excel before importing the
  data into R.</p>
  <sec id="nb-code-cell-1-nb-1" specific-use="notebook-code">
  <code language="r script">library(tidyverse)
  </code>
  <code language="r script">load(&quot;data/data-original-processed/data-processed.rda&quot;)
  </code>
  <sec id="nb-code-cell-1-output-0-nb-1" specific-use="notebook-output">
  <preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
  </sec>
  </sec>
</sec>
<sec id="cleaning-nb-1">
  <title>Cleaning</title>
  <p>This code cleans and filters the ‘inputs_general’ data.</p>
  <list list-type="order">
    <list-item>
      <p>Replaces ‘TrTM’ with ‘IV’ in the ‘LZD_route’ column.</p>
    </list-item>
    <list-item>
      <p>Replaces any occurrence of ‘IV’ followed by ‘PO’ or ‘PO’
      followed by ‘IV’ in the ‘LZD_route’ column with ‘IV&amp;PO’.</p>
    </list-item>
    <list-item>
      <p>Removes rows where ‘LZD_route’ is ‘0’.</p>
    </list-item>
    <list-item>
      <p>Removes rows where ‘patient_age’ is less than 18.</p>
    </list-item>
    <list-item>
      <p>Removes rows where ‘LZD_duration’ is less than 3.</p>
    </list-item>
    <list-item>
      <p>Removes rows where ‘LZD_start’ or ‘LZD_end’ is not within the
      study period.</p>
    </list-item>
    <list-item>
      <p>Removes rows where any variable that starts with “comed” is
      NA.</p>
    </list-item>
    <list-item>
      <p>Removes second treatment period (if any) by removing rows where
      ‘patient_ID’ contains “_2”.</p>
    </list-item>
  </list>
  <sec id="nb-code-cell-2-nb-1" specific-use="notebook-code">
  <code language="r script">inputs_cleaned &lt;- inputs_general |&gt;
  mutate(
    LZD_route = str_replace(LZD_route, &quot;TrTM&quot;, &quot;IV&quot;),
    LZD_route = str_replace(LZD_route, &quot;IV.*PO|PO.*IV&quot;, &quot;IV&amp;PO&quot;)
  ) |&gt;
  filter(!LZD_route == &quot;0&quot;) |&gt;
  filter(patient_age &gt;= 18) |&gt;
  filter(LZD_duration &gt;= 3) |&gt;
  filter(complete.cases(across(starts_with(&quot;comed&quot;)))) |&gt;
  filter(
    site == &quot;ND1&quot; &amp;
      (between(LZD_start, as_date(&quot;2021-05-01&quot;), as_date(&quot;2021-12-31&quot;)) |
        between(LZD_end, as_date(&quot;2021-05-01&quot;), as_date(&quot;2021-12-31&quot;))) |
      site == &quot;ND2&quot; &amp;
        (between(LZD_start, as_date(&quot;2022-04-01&quot;), as_date(&quot;2022-09-30&quot;)) |
          between(LZD_end, as_date(&quot;2022-04-01&quot;), as_date(&quot;2022-09-30&quot;))) |
      site == &quot;BM1&quot; &amp;
        (between(LZD_start, as_date(&quot;2019-11-01&quot;), as_date(&quot;2019-12-31&quot;)) |
          between(LZD_end, as_date(&quot;2019-11-01&quot;), as_date(&quot;2019-12-31&quot;))) |
      site == &quot;BM2&quot; &amp;
        (between(LZD_start, as_date(&quot;2022-12-01&quot;), as_date(&quot;2023-03-31&quot;)) |
          between(LZD_end, as_date(&quot;2022-12-01&quot;), as_date(&quot;2023-03-31&quot;))) |
      site == &quot;TN1&quot; &amp;
        (between(LZD_start, as_date(&quot;2020-01-01&quot;), as_date(&quot;2020-06-30&quot;)) |
          between(LZD_end, as_date(&quot;2020-01-01&quot;), as_date(&quot;2020-06-30&quot;))) |
      site == &quot;TN2&quot; &amp;
        (between(LZD_start, as_date(&quot;2022-09-01&quot;), as_date(&quot;2023-02-28&quot;)) |
          between(LZD_end, as_date(&quot;2022-09-01&quot;), as_date(&quot;2023-02-28&quot;)))
  ) |&gt;
  filter(!str_detect(patient_ID, &quot;_2&quot;)) |&gt;
  filter(!comorb_hematological &amp; !comorb_SLE &amp; !disorder_out)
  </code>
  </sec>
  <p>This code filters the ‘inputs_labs_general’ data frame.</p>
  <list list-type="order">
    <list-item>
      <p>Remove rows with LZD use duration less than 3 days.</p>
    </list-item>
    <list-item>
      <p>Remove second LZD episode.</p>
    </list-item>
    <list-item>
      <p>Keeps only the rows with the minimum ‘test_PLT’ for each
      ‘test_date’ in each ‘patient_ID’</p>
    </list-item>
  </list>
  <sec id="nb-code-cell-3-nb-1" specific-use="notebook-code">
  <code language="r script">inputs_labs_pipe_1 &lt;- inputs_labs_general |&gt;
  filter(LZD_end - LZD_start &gt;= 2) |&gt;
  filter(!str_detect(patient_ID, &quot;_2&quot;)) |&gt;
  group_by(patient_ID, test_date) |&gt;
  filter(test_PLT == min(test_PLT, na.rm = TRUE)) |&gt;
  mutate(test_PLT = na_if(test_PLT, Inf)) |&gt;
  ungroup()
  </code>
  <sec id="nb-code-cell-3-output-0-nb-1" specific-use="notebook-output">
  <preformat>Warning: There were 450 warnings in `filter()`.
The first warning was:
ℹ In argument: `test_PLT == min(test_PLT, na.rm = TRUE)`.
ℹ In group 3: `patient_ID = &quot;000847&quot;` and `test_date = 2020-06-09`.
Caused by warning in `min()`:
! no non-missing arguments to min; returning Inf
ℹ Run `dplyr::last_dplyr_warnings()` to see the 449 remaining warnings.</preformat>
  </sec>
  </sec>
  <p>This code remove ‘patient_ID’ that has no valid ‘test_PLT’ either
  in 7 days prior to ‘LZD_start’ or during LZD use.</p>
  <list list-type="order">
    <list-item>
      <p>Two rows are added to each ‘patient_ID’ to ensure there is at
      least one row in both time periods of each patient that can be
      used for flagging.</p>
    </list-item>
    <list-item>
      <p>‘flag_post_start’ is used to separate two time periods for each
      ‘patient_ID’. The first period is 7 days prior to ‘LZD_start’ and
      the second period is during LZD use.</p>
    </list-item>
    <list-item>
      <p>‘flag_too_early’ and ‘flag_post_end’ are used to flag
      observations that are before 7 days prior to ‘LZD_start’ or after
      ‘LZD_end’, so ‘test_PLT’ in these periods will not be valid.</p>
    </list-item>
    <list-item>
      <p>‘flag_remove_check’ is used to check if all ‘test_PLT’ values
      are NAs in each time periods of each ‘patient_ID’. If any time
      period initially had no rows, the new row added in step 1 will be
      used. That group will have only one ‘test_PLT’ with the value NA
      and so the flag will be TRUE. The ‘test_PLT’ in ‘flag_too_early’
      and ‘flag_post_end’ periods are not included in the check as they
      are not valid.</p>
    </list-item>
    <list-item>
      <p>For each ‘patient_ID’, if any ‘flag_remove_check’ is TRUE, all
      rows of that ‘patient_ID’ will be removed.</p>
    </list-item>
    <list-item>
      <p>Finally, rows with ‘flag_temp’ as TRUE are removed. These rows
      were added in step 1 and are no longer needed. The column itself
      is also removed.</p>
    </list-item>
  </list>
  <sec id="nb-code-cell-4-nb-1" specific-use="notebook-code">
  <code language="r script"># Helper function to add new rows to each group in a data frame.
# reframe() generate new rows where its arguments are variables in the data frame.
# bind_rows() bind the new rows to the original data frame.
# group_modify() apply the previous functions to each group in a data frame.
add_reframe_rows &lt;- function(.data, ...) {
  group_modify(.data, function(x, y) {
    bind_rows(x, reframe(x, ...))
  })
}

inputs_labs_cleaned &lt;- inputs_labs_pipe_1 |&gt;
  group_by(patient_ID) |&gt;
  arrange(test_date, .by_group = TRUE) |&gt;
  add_reframe_rows(test_date = min(test_date) - 100, LZD_start = min(LZD_start), flag_temp = TRUE) |&gt;
  add_reframe_rows(test_date = max(test_date) + 100, LZD_start = max(LZD_start), flag_temp = TRUE) |&gt;
  mutate(
    flag_too_early = test_date &lt;= LZD_start - 8,
    flag_post_start = test_date &gt;= LZD_start + 1,
    flag_post_end = test_date &gt;= LZD_end + 1
  ) |&gt;
  group_by(patient_ID, flag_post_start) |&gt;
  mutate(flag_remove_check = all(is.na(test_PLT[which((!flag_too_early &amp; !flag_post_end) | flag_temp)]))) |&gt;
  group_by(patient_ID) |&gt;
  filter(!any(flag_remove_check)) |&gt;
  filter(is.na(flag_temp)) |&gt;
  select(-flag_temp)
  </code>
  </sec>
  <p>inner_join() keeps only patients present in both data frames,
  essentially removing patients without lab tests or other
  comorbidity/medication data.</p>
  <sec id="nb-code-cell-5-nb-1" specific-use="notebook-code">
  <code language="r script">inputs_cleaned_joined &lt;-
  inner_join(inputs_cleaned, inputs_labs_cleaned)
  </code>
  <sec id="nb-code-cell-5-output-0-nb-1" specific-use="notebook-output">
  <preformat>Joining with `by = join_by(patient_ID, LZD_start, LZD_end)`</preformat>
  </sec>
  </sec>
</sec>
<sec id="mutating-nb-1">
  <title>Mutating</title>
  <p>This code flags ‘patient_ID’ that had at least one thrombocytopenia
  event during LZD use.</p>
  <p>Thrombocytopenia is defined as follows:</p>
  <list list-type="alpha-lower">
    <list-item>
      <p>If baseline PLT is normal (150-450), then thrombocytopenia is
      defined as PLT &lt; 112.5.</p>
    </list-item>
    <list-item>
      <p>If baseline PLT is low (&lt; 150), then thrombocytopenia is
      defined as PLT &lt;= 75% of baseline.</p>
    </list-item>
  </list>
  <p>Baseline date is defined as the latest ‘test_date’ before
  ‘LZD_start’ that has a non-NA ‘test_PLT.’</p>
  <p>This ‘test_date’ must be within 7 days before ‘LZD_start’, which
  means ‘flag_too_early’ must be FALSE.</p>
  <p>The code performs the following operations: 1. Groups the data by
  ‘patient_ID’. 2. Flags all ‘test_date’ after the baseline date.
  Baseline is defined above. 3. Flags all ‘test_date’ that meet the
  thrombocytopenia definition. This is an ADR event. 4. Flags all
  ‘patient_ID’ that have at least one thrombocytopenia ADR event during
  LZD use.</p>
  <p>Notes: max(which()) finds the index of the last TRUE value in a
  logical vector.</p>
  <p>while which.max() finds the index of the first TRUE value in a
  logical vector.</p>
  <sec id="nb-code-cell-6-nb-1" specific-use="notebook-code">
  <code language="r script">inputs_analyze_1 &lt;- inputs_cleaned_joined |&gt;
  group_by(patient_ID) |&gt;
  mutate(
    flag_too_late = test_date &gt;= LZD_end + 6,
    flag_post_baseline = test_date &gt;= test_date[max(which(test_date &lt;= LZD_start &amp; !is.na(test_PLT) &amp; !flag_too_early))],
    test_ADR_TP = flag_post_baseline &amp; !flag_too_late &amp; (
      (test_PLT[which.max(flag_post_baseline)] &gt;= 150 &amp; test_PLT &lt;= 112.5) |
        (test_PLT[which.max(flag_post_baseline)] &lt; 150 &amp; test_PLT &lt;= 0.75 * test_PLT[which.max(flag_post_baseline)])
    ),
    flag_ADR_TP_ID = any(test_ADR_TP, na.rm = TRUE)
  )
  </code>
  </sec>
  <p>This code adds a new column ‘test_CTCAE’ based on the Common
  Terminology Criteria for Adverse Events (CTCAE) for decreased platelet
  count.</p>
  <p>If ‘test_ADR_TP’ is TRUE, it assigns a value to ‘test_CTCAE’ based
  on the ‘test_PLT’ column.</p>
  <list list-type="alpha-lower">
    <list-item>
      <p>If ‘test_PLT’ is less than 25, ‘test_CTCAE’ is assigned a value
      of 4.</p>
    </list-item>
    <list-item>
      <p>If ‘test_PLT’ is between 25 and 50, ‘test_CTCAE’ is assigned a
      value of 3.</p>
    </list-item>
    <list-item>
      <p>If ‘test_PLT’ is between 50 and 75, ‘test_CTCAE’ is assigned a
      value of 2.</p>
    </list-item>
    <list-item>
      <p>If ‘test_PLT’ is between 75 and 150, ‘test_CTCAE’ is assigned a
      value of 1.</p>
    </list-item>
  </list>
  <p>If ‘test_ADR_TP’ is FALSE, ‘test_CTCAE’ is assigned NA.</p>
  <p>Finally, ‘test_CTCAE_max’ is assigned the maximum value of
  ‘test_CTCAE’ for each ‘patient_ID’.</p>
  <sec id="nb-code-cell-7-nb-1" specific-use="notebook-code">
  <code language="r script">inputs_analyze_2 &lt;- inputs_analyze_1 |&gt;
  mutate(
    test_CTCAE =
      if_else(
        test_ADR_TP,
        case_when(
          test_PLT &lt; 25 ~ 4,
          test_PLT &lt; 50 ~ 3,
          test_PLT &lt; 75 ~ 2,
          test_PLT &lt; 150 ~ 1
        ),
        NA_real_
      ),
    ADR_CTCAE_max = max(test_CTCAE, na.rm = TRUE),
    ADR_CTCAE_max = na_if(ADR_CTCAE_max, -Inf)
  )
  </code>
  <sec id="nb-code-cell-7-output-0-nb-1" specific-use="notebook-output">
  <preformat>Warning: There were 614 warnings in `mutate()`.
The first warning was:
ℹ In argument: `ADR_CTCAE_max = max(test_CTCAE, na.rm = TRUE)`.
ℹ In group 1: `patient_ID = &quot;000847&quot;`.
Caused by warning in `max()`:
! no non-missing arguments to max; returning -Inf
ℹ Run `dplyr::last_dplyr_warnings()` to see the 613 remaining warnings.</preformat>
  </sec>
  </sec>
  <p>This code adds a new column ‘test_onset’, which is the number of
  days from ‘LZD_start’ to the thrombocytopenia event.</p>
  <p>If ‘test_ADR_TP’ is TRUE, ‘test_onset’ is assigned the value of
  ‘test_date’ minus ‘LZD_start’.</p>
  <p>If ‘test_ADR_TP’ is FALSE, ‘test_onset’ is assigned NA.</p>
  <p>Finally, ‘test_onset_first’ is assigned the first non-NA value of
  ‘test_onset’ for each ‘patient_ID’.</p>
  <sec id="nb-code-cell-8-nb-1" specific-use="notebook-code">
  <code language="r script">inputs_analyze_3 &lt;- inputs_analyze_2 |&gt;
  mutate(
    ADR_onset =
      if_else(
        test_ADR_TP,
        as.double(test_date - LZD_start),
        NA_real_
      ),
    ADR_onset_first = first(na.omit(ADR_onset))
  )
  </code>
  </sec>
  <p>This code adds a new column ‘test_PLT_ratio’, which is the ratio of
  the minimum ‘test_PLT’ to the baseline ‘test_PLT’.</p>
  <p>If ‘flag_ADR_TP_ID’ is TRUE, ‘test_PLT_ratio’ is assigned the value
  of the ratio.</p>
  <p>If ‘flag_ADR_TP_ID’ is FALSE, ‘test_PLT_ratio’ is assigned NA.</p>
  <sec id="nb-code-cell-9-nb-1" specific-use="notebook-code">
  <code language="r script">inputs_analyze_4 &lt;- inputs_analyze_3 |&gt;
  mutate(
    ADR_PLT_ratio =
      if_else(
        flag_ADR_TP_ID,
        test_PLT[which.min(test_PLT)] / test_PLT[which.max(flag_post_baseline)],
        NA_real_
      )
  )
  </code>
  </sec>
  <p>Changes existing data to get values from data_lab_test instead of
  relying on data_patient The code also removes duplicates and sorts the
  data by ‘site’ and ‘patient_ID’.</p>
  <sec id="nb-code-cell-10-nb-1" specific-use="notebook-code">
  <code language="r script">inputs_analyze_5 &lt;- inputs_analyze_4 |&gt;
  mutate(
    LZD_duration = as.numeric(LZD_end - LZD_start) + 1,
    baseline_date = test_date[which.max(flag_post_baseline)],
    baseline_PLT = test_PLT[which.max(flag_post_baseline)],
    baseline_HGB = test_HGB[which.max(flag_post_baseline)],
    baseline_WBC = test_WBC[which.max(flag_post_baseline)],
    ADR_PLT_min = min(test_PLT[which.max(flag_post_baseline) + 1:max(which(flag_post_baseline))], na.rm = TRUE),
  ) 
  </code>
  </sec>
</sec>
<sec id="outputs-nb-1">
  <title>Outputs</title>
  <p>This code prepares the final data for analysis and exports it to
  the ‘data-cleaned’ directory.</p>
  <list list-type="order">
    <list-item>
      <p>The ‘data_patient_complete’ data frame contains only the first
      complete row of each ‘patient_ID’ in ‘data_complete’.</p>
    </list-item>
  </list>
  <list list-type="bullet">
    <list-item>
      <p>Patients with any missing initial data are removed.</p>
    </list-item>
    <list-item>
      <p>Patients with baseline PLT &gt; 450 are removed.</p>
    </list-item>
    <list-item>
      <p>The ‘data_patient_complete’ data frame is used for
      patient-level analysis.</p>
    </list-item>
  </list>
  <list list-type="order">
    <list-item>
      <label>2.</label>
      <p>The ‘data_complete’ data frame contains all the cleaned and
      filtered data.</p>
    </list-item>
  </list>
  <list list-type="bullet">
    <list-item>
      <p>The ‘data_complete’ data frame is used for event-level
      analysis.</p>
    </list-item>
  </list>
  <sec id="nb-code-cell-11-nb-1" specific-use="notebook-code">
  <code language="r script">data_patient_complete &lt;- inputs_analyze_5 |&gt;
  arrange(site, patient_ID) |&gt;
  slice_head(n = 1) |&gt;
  select(-starts_with(&quot;test&quot;)) |&gt;
  filter(complete.cases(across(-starts_with(&quot;ADR&quot;)))) |&gt;
  filter(baseline_PLT &lt;= 450) |&gt;
  ungroup()

data_complete &lt;- inputs_analyze_5 |&gt;
  filter(patient_ID %in% data_patient_complete$patient_ID) |&gt;
  ungroup()

write_csv(data_complete, &quot;data/data-cleaned/data-complete.csv&quot;)
write_csv(data_patient_complete, &quot;data/data-cleaned/data-patient-complete.csv&quot;)

save(data_complete, data_patient_complete, file = &quot;data/data-cleaned/data-cleaned.rda&quot;)
  </code>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-8-nb-2">
<front-stub>
<title-group>
<article-title>Descriptive Statistics</article-title>
</title-group>
</front-stub>

<body>
<p>Initialize data to analyze.</p>
<sec id="nb-code-cell-1-nb-2" specific-use="notebook-code">
<code language="r script">source(&quot;notebooks/initialize-data-analysis.r&quot;)
</code>
<sec id="nb-code-cell-1-output-0-nb-2" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
</sec>
<p>Summary statistics, by thrombocytopenia status.</p>
<sec id="nb-code-cell-2-nb-2" specific-use="notebook-code">
<code language="r script">library(gtsummary)

table_stats &lt;- data_patient_transformed |&gt;
  select(
    all_of(predictor_transformed), starts_with(&quot;comed&quot;), flag_ADR_TP_ID
  ) |&gt;

  tbl_summary(
    by = flag_ADR_TP_ID,
    statistic = list(all_continuous() ~ &quot;{median} ({p25} - {p75})&quot;),
    missing = &quot;no&quot;
  ) |&gt;
    add_overall() |&gt;
    bold_labels()
</code>
</sec>
<p>Univariate logistic regression, by thrombocytopenia status.</p>
<sec id="nb-code-cell-3-nb-2" specific-use="notebook-code">
<code language="r script">library(tidymodels)
</code>
<code language="r script">library(furrr)
</code>
<code language="r script">data_patient_transformed_response_as_factor &lt;- data_patient_transformed |&gt;
  mutate(
    flag_ADR_TP_ID = as.factor(flag_ADR_TP_ID),
    LZD_route = as.factor(LZD_route)
  )

fit_univariate_regression &lt;- function(predictor) {
  model &lt;- logistic_reg() |&gt;
    set_engine(&quot;glm&quot;) |&gt;
    set_mode(&quot;classification&quot;) |&gt;
    fit(
      reformulate(
        termlabels = predictor,
        response = &quot;flag_ADR_TP_ID&quot;
      ),
      data = data_patient_transformed_response_as_factor
    )
}

arrange_univariate_regression &lt;- function(model) {
  model |&gt;
    tbl_regression(
      exponentiate = TRUE,
      show_single_row = everything() &amp; -any_of(&quot;LZD_route&quot;)
    ) |&gt;
    bold_p()
}

plan(multisession, workers = max(min(parallel::detectCores() - 1, 10), 2))
uni_model_list &lt;- future_map(predictor_transformed, fit_univariate_regression)
table_uni_list &lt;- future_map(uni_model_list, arrange_univariate_regression)
</code>
<code language="r script">plan(sequential)

table_uni &lt;- tbl_stack(table_uni_list)
</code>
<sec id="nb-code-cell-3-output-0-nb-2" specific-use="notebook-output">
<preformat>── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──</preformat>
</sec>
<sec id="nb-code-cell-3-output-1-nb-2" specific-use="notebook-output">
<preformat>✔ broom        1.0.5      ✔ rsample      1.2.0 
✔ dials        1.2.1      ✔ tune         1.2.0 
✔ infer        1.0.6      ✔ workflows    1.1.4 
✔ modeldata    1.3.0      ✔ workflowsets 1.1.0 
✔ parsnip      1.2.0      ✔ yardstick    1.3.0 
✔ recipes      1.0.10     </preformat>
</sec>
<sec id="nb-code-cell-3-output-2-nb-2" specific-use="notebook-output">
<preformat>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ recipes::all_double()  masks gtsummary::all_double()
✖ recipes::all_factor()  masks gtsummary::all_factor()
✖ recipes::all_integer() masks gtsummary::all_integer()
✖ recipes::all_logical() masks gtsummary::all_logical()
✖ recipes::all_numeric() masks gtsummary::all_numeric()
✖ scales::discard()      masks purrr::discard()
✖ dplyr::filter()        masks stats::filter()
✖ recipes::fixed()       masks stringr::fixed()
✖ dplyr::lag()           masks stats::lag()
✖ yardstick::spec()      masks readr::spec()
✖ recipes::step()        masks stats::step()
• Learn how to get started at https://www.tidymodels.org/start/</preformat>
</sec>
<sec id="nb-code-cell-3-output-3-nb-2" specific-use="notebook-output">
<preformat>Loading required package: future</preformat>
</sec>
<sec id="nb-code-cell-3-output-4-nb-2" specific-use="notebook-output">
<preformat>Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`</preformat>
</sec>
<sec id="nb-code-cell-3-output-5-nb-2" specific-use="notebook-output">
<preformat>Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`</preformat>
</sec>
<sec id="nb-code-cell-3-output-6-nb-2" specific-use="notebook-output">
<preformat>Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`</preformat>
</sec>
<sec id="nb-code-cell-3-output-7-nb-2" specific-use="notebook-output">
<preformat>Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`</preformat>
</sec>
</sec>
<p>Print and save results.</p>
<sec id="nb-code-cell-4-nb-2" specific-use="notebook-code">
<code language="r script">table_descriptive &lt;- tbl_merge(
  list(table_stats, table_uni),
  tab_spanner = c(
    &quot;**Thrombocytopenia Status**&quot;,
    &quot;**Univariate Regression**&quot;
  )
)

table_descriptive
</code>
<table-wrap>
  <table>
    <colgroup>
      <col width="14%" />
      <col width="14%" />
      <col width="14%" />
      <col width="14%" />
      <col width="14%" />
      <col width="14%" />
      <col width="14%" />
    </colgroup>
    <thead>
      <tr>
        <th rowspan="2" id="U003CstrongU003ECharacteristicU003CU002FstrongU003E-nb-2" scope="col"><bold>Characteristic</bold></th>
        <th colspan="3" id="U003CstrongU003EThrombocytopeniaU0020StatusU003CU002FstrongU003E-nb-2" scope="colgroup"><named-content content-type="gt_column_spanner"><bold>Thrombocytopenia
        Status</bold></named-content></th>
        <th colspan="3" id="U003CstrongU003EUnivariateU0020RegressionU003CU002FstrongU003E-nb-2" scope="colgroup"><named-content content-type="gt_column_spanner"><bold>Univariate
        Regression</bold></named-content></th>
      </tr>
      <tr>
        <th id="U003CstrongU003EOverallU003CU002FstrongU003EU002CU0020NU0020U003DU0020776U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>Overall</bold>,
        N =
        776<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003EFALSEU003CU002FstrongU003EU002CU0020NU0020U003DU0020529U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>FALSE</bold>,
        N =
        529<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003ETRUEU003CU002FstrongU003EU002CU0020NU0020U003DU0020247U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>TRUE</bold>,
        N =
        247<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003EORU003CU002FstrongU003EU003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E2U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>OR</bold><named-content content-type="gt_footnote_marks"><sup>2</sup></named-content></th>
        <th id="U003CstrongU003E95U0025U0020CIU003CU002FstrongU003EU003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E2U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>95%
        CI</bold><named-content content-type="gt_footnote_marks"><sup>2</sup></named-content></th>
        <th id="U003CstrongU003Ep-valueU003CU002FstrongU003E-nb-2" scope="col"><bold>p-value</bold></th>
      </tr>
    </thead>
    <tfoot>
      <tr>
        <td colspan="7"><named-content content-type="gt_footnote_marks"><sup>1</sup></named-content>
        Median (IQR); n (%)</td>
      </tr>
      <tr>
        <td colspan="7"><named-content content-type="gt_footnote_marks"><sup>2</sup></named-content>
        OR = Odds Ratio, CI = Confidence Interval</td>
      </tr>
    </tfoot>
    <tbody>
      <tr>
        <td headers="label" style="font-weight: bold">patient_age_per_10</td>
        <td headers="stat_0_1">6.20 (5.00 - 7.30)</td>
        <td headers="stat_1_1">6.10 (4.80 - 7.20)</td>
        <td headers="stat_2_1">6.40 (5.50 - 7.40)</td>
        <td headers="estimate_2">1.18</td>
        <td headers="ci_2">1.08, 1.30</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">patient_age_60</td>
        <td headers="stat_0_1">455 (59%)</td>
        <td headers="stat_1_1">290 (55%)</td>
        <td headers="stat_2_1">165 (67%)</td>
        <td headers="estimate_2">1.66</td>
        <td headers="ci_2">1.21, 2.28</td>
        <td headers="p.value_2" style="font-weight: bold">0.002</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">patient_age_65</td>
        <td headers="stat_0_1">351 (45%)</td>
        <td headers="stat_1_1">228 (43%)</td>
        <td headers="stat_2_1">123 (50%)</td>
        <td headers="estimate_2">1.31</td>
        <td headers="ci_2">0.97, 1.77</td>
        <td headers="p.value_2">0.081</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">patient_sex</td>
        <td headers="stat_0_1">288 (37%)</td>
        <td headers="stat_1_1">195 (37%)</td>
        <td headers="stat_2_1">93 (38%)</td>
        <td headers="estimate_2">1.03</td>
        <td headers="ci_2">0.76, 1.41</td>
        <td headers="p.value_2">0.8</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">patient_weight_per_10</td>
        <td headers="stat_0_1">5.50 (5.00 - 6.00)</td>
        <td headers="stat_1_1">5.50 (5.00 - 6.00)</td>
        <td headers="stat_2_1">5.50 (4.85 - 6.20)</td>
        <td headers="estimate_2">1.02</td>
        <td headers="ci_2">0.87, 1.20</td>
        <td headers="p.value_2">0.8</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">patient_weight_50</td>
        <td headers="stat_0_1">181 (23%)</td>
        <td headers="stat_1_1">117 (22%)</td>
        <td headers="stat_2_1">64 (26%)</td>
        <td headers="estimate_2">1.23</td>
        <td headers="ci_2">0.86, 1.74</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_CLCR_per_10</td>
        <td headers="stat_0_1">4.9 (2.1 - 8.3)</td>
        <td headers="stat_1_1">5.5 (2.6 - 8.8)</td>
        <td headers="stat_2_1">3.3 (1.6 - 6.4)</td>
        <td headers="estimate_2">0.90</td>
        <td headers="ci_2">0.86, 0.93</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_CLCR_60</td>
        <td headers="stat_0_1">462 (60%)</td>
        <td headers="stat_1_1">280 (53%)</td>
        <td headers="stat_2_1">182 (74%)</td>
        <td headers="estimate_2">2.49</td>
        <td headers="ci_2">1.80, 3.48</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_CLCR_30</td>
        <td headers="stat_0_1">272 (35%)</td>
        <td headers="stat_1_1">153 (29%)</td>
        <td headers="stat_2_1">119 (48%)</td>
        <td headers="estimate_2">2.28</td>
        <td headers="ci_2">1.67, 3.13</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">dept_ER</td>
        <td headers="stat_0_1">136 (18%)</td>
        <td headers="stat_1_1">93 (18%)</td>
        <td headers="stat_2_1">43 (17%)</td>
        <td headers="estimate_2">0.99</td>
        <td headers="ci_2">0.66, 1.46</td>
        <td headers="p.value_2">&gt;0.9</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">dept_ICU</td>
        <td headers="stat_0_1">377 (49%)</td>
        <td headers="stat_1_1">233 (44%)</td>
        <td headers="stat_2_1">144 (58%)</td>
        <td headers="estimate_2">1.78</td>
        <td headers="ci_2">1.31, 2.41</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_HGB_per_10</td>
        <td headers="stat_0_1">10.30 (9.00 - 12.10)</td>
        <td headers="stat_1_1">10.50 (9.20 - 12.20)</td>
        <td headers="stat_2_1">9.80 (8.60 - 11.80)</td>
        <td headers="estimate_2">0.89</td>
        <td headers="ci_2">0.83, 0.95</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_WBC_per_10</td>
        <td headers="stat_0_1">1.22 (0.82 - 1.69)</td>
        <td headers="stat_1_1">1.21 (0.83 - 1.67)</td>
        <td headers="stat_2_1">1.25 (0.78 - 1.77)</td>
        <td headers="estimate_2">1.09</td>
        <td headers="ci_2">0.90, 1.31</td>
        <td headers="p.value_2">0.4</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_PLT_per_10</td>
        <td headers="stat_0_1">21 (15 - 29)</td>
        <td headers="stat_1_1">24 (17 - 31)</td>
        <td headers="stat_2_1">16 (11 - 21)</td>
        <td headers="estimate_2">0.92</td>
        <td headers="ci_2">0.90, 0.94</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_PLT_200</td>
        <td headers="stat_0_1">349 (45%)</td>
        <td headers="stat_1_1">183 (35%)</td>
        <td headers="stat_2_1">166 (67%)</td>
        <td headers="estimate_2">3.87</td>
        <td headers="ci_2">2.82, 5.36</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_PLT_150</td>
        <td headers="stat_0_1">203 (26%)</td>
        <td headers="stat_1_1">90 (17%)</td>
        <td headers="stat_2_1">113 (46%)</td>
        <td headers="estimate_2">4.11</td>
        <td headers="ci_2">2.94, 5.78</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_duration</td>
        <td headers="stat_0_1">9.0 (6.0 - 14.0)</td>
        <td headers="stat_1_1">9.0 (6.0 - 13.0)</td>
        <td headers="stat_2_1">10.0 (6.0 - 14.0)</td>
        <td headers="estimate_2">1.03</td>
        <td headers="ci_2">1.00, 1.06</td>
        <td headers="p.value_2" style="font-weight: bold">0.020</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_duration_7</td>
        <td headers="stat_0_1">566 (73%)</td>
        <td headers="stat_1_1">386 (73%)</td>
        <td headers="stat_2_1">180 (73%)</td>
        <td headers="estimate_2">1.00</td>
        <td headers="ci_2">0.71, 1.40</td>
        <td headers="p.value_2">&gt;0.9</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_duration_10</td>
        <td headers="stat_0_1">383 (49%)</td>
        <td headers="stat_1_1">248 (47%)</td>
        <td headers="stat_2_1">135 (55%)</td>
        <td headers="estimate_2">1.37</td>
        <td headers="ci_2">1.01, 1.85</td>
        <td headers="p.value_2" style="font-weight: bold">0.044</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_duration_14</td>
        <td headers="stat_0_1">201 (26%)</td>
        <td headers="stat_1_1">120 (23%)</td>
        <td headers="stat_2_1">81 (33%)</td>
        <td headers="estimate_2">1.66</td>
        <td headers="ci_2">1.19, 2.32</td>
        <td headers="p.value_2" style="font-weight: bold">0.003</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_route</td>
        <td headers="stat_0_1"><break/></td>
        <td headers="stat_1_1"><break/></td>
        <td headers="stat_2_1"><break/></td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label">    IV</td>
        <td headers="stat_0_1">756 (97%)</td>
        <td headers="stat_1_1">513 (97%)</td>
        <td headers="stat_2_1">243 (98%)</td>
        <td headers="estimate_2">—</td>
        <td headers="ci_2">—</td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label">    IV&amp;PO</td>
        <td headers="stat_0_1">9 (1.2%)</td>
        <td headers="stat_1_1">7 (1.3%)</td>
        <td headers="stat_2_1">2 (0.8%)</td>
        <td headers="estimate_2">0.60</td>
        <td headers="ci_2">0.09, 2.52</td>
        <td headers="p.value_2">0.5</td>
      </tr>
      <tr>
        <td headers="label">    PO</td>
        <td headers="stat_0_1">11 (1.4%)</td>
        <td headers="stat_1_1">9 (1.7%)</td>
        <td headers="stat_2_1">2 (0.8%)</td>
        <td headers="estimate_2">0.47</td>
        <td headers="ci_2">0.07, 1.84</td>
        <td headers="p.value_2">0.3</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_ETI</td>
        <td headers="stat_0_1">366 (47%)</td>
        <td headers="stat_1_1">218 (41%)</td>
        <td headers="stat_2_1">148 (60%)</td>
        <td headers="estimate_2">2.13</td>
        <td headers="ci_2">1.57, 2.91</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_CVC</td>
        <td headers="stat_0_1">390 (50%)</td>
        <td headers="stat_1_1">225 (43%)</td>
        <td headers="stat_2_1">165 (67%)</td>
        <td headers="estimate_2">2.72</td>
        <td headers="ci_2">1.99, 3.74</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_IHD</td>
        <td headers="stat_0_1">97 (13%)</td>
        <td headers="stat_1_1">57 (11%)</td>
        <td headers="stat_2_1">40 (16%)</td>
        <td headers="estimate_2">1.60</td>
        <td headers="ci_2">1.03, 2.47</td>
        <td headers="p.value_2" style="font-weight: bold">0.035</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_CRRT</td>
        <td headers="stat_0_1">130 (17%)</td>
        <td headers="stat_1_1">60 (11%)</td>
        <td headers="stat_2_1">70 (28%)</td>
        <td headers="estimate_2">3.09</td>
        <td headers="ci_2">2.10, 4.56</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_HTN</td>
        <td headers="stat_0_1">330 (43%)</td>
        <td headers="stat_1_1">219 (41%)</td>
        <td headers="stat_2_1">111 (45%)</td>
        <td headers="estimate_2">1.16</td>
        <td headers="ci_2">0.85, 1.57</td>
        <td headers="p.value_2">0.4</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_DM</td>
        <td headers="stat_0_1">212 (27%)</td>
        <td headers="stat_1_1">145 (27%)</td>
        <td headers="stat_2_1">67 (27%)</td>
        <td headers="estimate_2">0.99</td>
        <td headers="ci_2">0.70, 1.38</td>
        <td headers="p.value_2">&gt;0.9</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_HF</td>
        <td headers="stat_0_1">219 (28%)</td>
        <td headers="stat_1_1">126 (24%)</td>
        <td headers="stat_2_1">93 (38%)</td>
        <td headers="estimate_2">1.93</td>
        <td headers="ci_2">1.39, 2.68</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_angina</td>
        <td headers="stat_0_1">35 (4.5%)</td>
        <td headers="stat_1_1">20 (3.8%)</td>
        <td headers="stat_2_1">15 (6.1%)</td>
        <td headers="estimate_2">1.65</td>
        <td headers="ci_2">0.81, 3.26</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_cirr</td>
        <td headers="stat_0_1">47 (6.1%)</td>
        <td headers="stat_1_1">19 (3.6%)</td>
        <td headers="stat_2_1">28 (11%)</td>
        <td headers="estimate_2">3.43</td>
        <td headers="ci_2">1.89, 6.37</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_COPD</td>
        <td headers="stat_0_1">39 (5.0%)</td>
        <td headers="stat_1_1">25 (4.7%)</td>
        <td headers="stat_2_1">14 (5.7%)</td>
        <td headers="estimate_2">1.21</td>
        <td headers="ci_2">0.60, 2.34</td>
        <td headers="p.value_2">0.6</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_CVA</td>
        <td headers="stat_0_1">88 (11%)</td>
        <td headers="stat_1_1">63 (12%)</td>
        <td headers="stat_2_1">25 (10%)</td>
        <td headers="estimate_2">0.83</td>
        <td headers="ci_2">0.50, 1.34</td>
        <td headers="p.value_2">0.5</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_MI</td>
        <td headers="stat_0_1">20 (2.6%)</td>
        <td headers="stat_1_1">15 (2.8%)</td>
        <td headers="stat_2_1">5 (2.0%)</td>
        <td headers="estimate_2">0.71</td>
        <td headers="ci_2">0.23, 1.85</td>
        <td headers="p.value_2">0.5</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_K</td>
        <td headers="stat_0_1">58 (7.5%)</td>
        <td headers="stat_1_1">36 (6.8%)</td>
        <td headers="stat_2_1">22 (8.9%)</td>
        <td headers="estimate_2">1.34</td>
        <td headers="ci_2">0.76, 2.31</td>
        <td headers="p.value_2">0.3</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_sepsis</td>
        <td headers="stat_0_1">121 (16%)</td>
        <td headers="stat_1_1">53 (10%)</td>
        <td headers="stat_2_1">68 (28%)</td>
        <td headers="estimate_2">3.41</td>
        <td headers="ci_2">2.30, 5.10</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_CAP</td>
        <td headers="stat_0_1">116 (15%)</td>
        <td headers="stat_1_1">68 (13%)</td>
        <td headers="stat_2_1">48 (19%)</td>
        <td headers="estimate_2">1.64</td>
        <td headers="ci_2">1.09, 2.45</td>
        <td headers="p.value_2" style="font-weight: bold">0.017</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_HAP</td>
        <td headers="stat_0_1">353 (45%)</td>
        <td headers="stat_1_1">243 (46%)</td>
        <td headers="stat_2_1">110 (45%)</td>
        <td headers="estimate_2">0.95</td>
        <td headers="ci_2">0.70, 1.28</td>
        <td headers="p.value_2">0.7</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_SSTI</td>
        <td headers="stat_0_1">139 (18%)</td>
        <td headers="stat_1_1">101 (19%)</td>
        <td headers="stat_2_1">38 (15%)</td>
        <td headers="estimate_2">0.77</td>
        <td headers="ci_2">0.51, 1.15</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_CNS</td>
        <td headers="stat_0_1">62 (8.0%)</td>
        <td headers="stat_1_1">44 (8.3%)</td>
        <td headers="stat_2_1">18 (7.3%)</td>
        <td headers="estimate_2">0.87</td>
        <td headers="ci_2">0.48, 1.51</td>
        <td headers="p.value_2">0.6</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_IAI</td>
        <td headers="stat_0_1">47 (6.1%)</td>
        <td headers="stat_1_1">33 (6.2%)</td>
        <td headers="stat_2_1">14 (5.7%)</td>
        <td headers="estimate_2">0.90</td>
        <td headers="ci_2">0.46, 1.69</td>
        <td headers="p.value_2">0.8</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_UTI</td>
        <td headers="stat_0_1">48 (6.2%)</td>
        <td headers="stat_1_1">32 (6.0%)</td>
        <td headers="stat_2_1">16 (6.5%)</td>
        <td headers="estimate_2">1.08</td>
        <td headers="ci_2">0.57, 1.97</td>
        <td headers="p.value_2">0.8</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_BJI</td>
        <td headers="stat_0_1">12 (1.5%)</td>
        <td headers="stat_1_1">11 (2.1%)</td>
        <td headers="stat_2_1">1 (0.4%)</td>
        <td headers="estimate_2">0.19</td>
        <td headers="ci_2">0.01, 0.99</td>
        <td headers="p.value_2">0.11</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_septicemia</td>
        <td headers="stat_0_1">240 (31%)</td>
        <td headers="stat_1_1">161 (30%)</td>
        <td headers="stat_2_1">79 (32%)</td>
        <td headers="estimate_2">1.07</td>
        <td headers="ci_2">0.77, 1.49</td>
        <td headers="p.value_2">0.7</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_ibuprofen</td>
        <td headers="stat_0_1">19 (2.4%)</td>
        <td headers="stat_1_1">14 (2.6%)</td>
        <td headers="stat_2_1">5 (2.0%)</td>
        <td headers="estimate_2">0.76</td>
        <td headers="ci_2">0.24, 2.01</td>
        <td headers="p.value_2">0.6</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_carbapenem</td>
        <td headers="stat_0_1">565 (73%)</td>
        <td headers="stat_1_1">371 (70%)</td>
        <td headers="stat_2_1">194 (79%)</td>
        <td headers="estimate_2">1.56</td>
        <td headers="ci_2">1.10, 2.24</td>
        <td headers="p.value_2" style="font-weight: bold">0.015</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_vancomycin</td>
        <td headers="stat_0_1">67 (8.6%)</td>
        <td headers="stat_1_1">41 (7.8%)</td>
        <td headers="stat_2_1">26 (11%)</td>
        <td headers="estimate_2">1.40</td>
        <td headers="ci_2">0.83, 2.33</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_levofloxacin</td>
        <td headers="stat_0_1">240 (31%)</td>
        <td headers="stat_1_1">156 (29%)</td>
        <td headers="stat_2_1">84 (34%)</td>
        <td headers="estimate_2">1.23</td>
        <td headers="ci_2">0.89, 1.70</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_teicoplanin</td>
        <td headers="stat_0_1">38 (4.9%)</td>
        <td headers="stat_1_1">23 (4.3%)</td>
        <td headers="stat_2_1">15 (6.1%)</td>
        <td headers="estimate_2">1.42</td>
        <td headers="ci_2">0.71, 2.75</td>
        <td headers="p.value_2">0.3</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_pyrazinamid</td>
        <td headers="stat_0_1">13 (1.7%)</td>
        <td headers="stat_1_1">5 (0.9%)</td>
        <td headers="stat_2_1">8 (3.2%)</td>
        <td headers="estimate_2">3.51</td>
        <td headers="ci_2">1.16, 11.7</td>
        <td headers="p.value_2" style="font-weight: bold">0.029</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_rifampin</td>
        <td headers="stat_0_1">15 (1.9%)</td>
        <td headers="stat_1_1">7 (1.3%)</td>
        <td headers="stat_2_1">8 (3.2%)</td>
        <td headers="estimate_2">2.50</td>
        <td headers="ci_2">0.89, 7.20</td>
        <td headers="p.value_2">0.081</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_heparin</td>
        <td headers="stat_0_1">215 (28%)</td>
        <td headers="stat_1_1">106 (20%)</td>
        <td headers="stat_2_1">109 (44%)</td>
        <td headers="estimate_2">3.15</td>
        <td headers="ci_2">2.27, 4.39</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_clopidogrel</td>
        <td headers="stat_0_1">40 (5.2%)</td>
        <td headers="stat_1_1">30 (5.7%)</td>
        <td headers="stat_2_1">10 (4.0%)</td>
        <td headers="estimate_2">0.70</td>
        <td headers="ci_2">0.32, 1.41</td>
        <td headers="p.value_2">0.3</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_enoxaparin</td>
        <td headers="stat_0_1">358 (46%)</td>
        <td headers="stat_1_1">235 (44%)</td>
        <td headers="stat_2_1">123 (50%)</td>
        <td headers="estimate_2">1.24</td>
        <td headers="ci_2">0.92, 1.68</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_valproic</td>
        <td headers="stat_0_1">32 (4.1%)</td>
        <td headers="stat_1_1">22 (4.2%)</td>
        <td headers="stat_2_1">10 (4.0%)</td>
        <td headers="estimate_2">0.97</td>
        <td headers="ci_2">0.43, 2.03</td>
        <td headers="p.value_2">&gt;0.9</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_aspirin</td>
        <td headers="stat_0_1">42 (5.4%)</td>
        <td headers="stat_1_1">28 (5.3%)</td>
        <td headers="stat_2_1">14 (5.7%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_aceclofenac</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_diclofenac</td>
        <td headers="stat_0_1">27 (3.5%)</td>
        <td headers="stat_1_1">20 (3.8%)</td>
        <td headers="stat_2_1">7 (2.8%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_naproxen</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_paracetamol</td>
        <td headers="stat_0_1">351 (45%)</td>
        <td headers="stat_1_1">242 (46%)</td>
        <td headers="stat_2_1">109 (44%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_penicillin</td>
        <td headers="stat_0_1">168 (22%)</td>
        <td headers="stat_1_1">106 (20%)</td>
        <td headers="stat_2_1">62 (25%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_cepha</td>
        <td headers="stat_0_1">196 (25%)</td>
        <td headers="stat_1_1">142 (27%)</td>
        <td headers="stat_2_1">54 (22%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_cotrimoxazol</td>
        <td headers="stat_0_1">71 (9.1%)</td>
        <td headers="stat_1_1">44 (8.3%)</td>
        <td headers="stat_2_1">27 (11%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_daptomycin</td>
        <td headers="stat_0_1">1 (0.1%)</td>
        <td headers="stat_1_1">1 (0.2%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_ethambutol</td>
        <td headers="stat_0_1">8 (1.0%)</td>
        <td headers="stat_1_1">4 (0.8%)</td>
        <td headers="stat_2_1">4 (1.6%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_cetirizin</td>
        <td headers="stat_0_1">6 (0.8%)</td>
        <td headers="stat_1_1">5 (0.9%)</td>
        <td headers="stat_2_1">1 (0.4%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_dexamethason</td>
        <td headers="stat_0_1">109 (14%)</td>
        <td headers="stat_1_1">76 (14%)</td>
        <td headers="stat_2_1">33 (13%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_amiodaron</td>
        <td headers="stat_0_1">35 (4.5%)</td>
        <td headers="stat_1_1">17 (3.2%)</td>
        <td headers="stat_2_1">18 (7.3%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_furosemid</td>
        <td headers="stat_0_1">422 (54%)</td>
        <td headers="stat_1_1">242 (46%)</td>
        <td headers="stat_2_1">180 (73%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_simvas</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_bisoprolol</td>
        <td headers="stat_0_1">5 (0.6%)</td>
        <td headers="stat_1_1">4 (0.8%)</td>
        <td headers="stat_2_1">1 (0.4%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_diltiazem</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_eptifibatid</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_quinidin</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_haloperidol</td>
        <td headers="stat_0_1">51 (6.6%)</td>
        <td headers="stat_1_1">35 (6.6%)</td>
        <td headers="stat_2_1">16 (6.5%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_carbamazepin</td>
        <td headers="stat_0_1">8 (1.0%)</td>
        <td headers="stat_1_1">8 (1.5%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_phenytoin</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_mirtazapin</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_quetiapin</td>
        <td headers="stat_0_1">4 (0.5%)</td>
        <td headers="stat_1_1">4 (0.8%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_ondansetron</td>
        <td headers="stat_0_1">5 (0.6%)</td>
        <td headers="stat_1_1">2 (0.4%)</td>
        <td headers="stat_2_1">3 (1.2%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_palonosetron</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_oseltamivir</td>
        <td headers="stat_0_1">2 (0.3%)</td>
        <td headers="stat_1_1">1 (0.2%)</td>
        <td headers="stat_2_1">1 (0.4%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_quinin</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_pembrolizumab</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_trastuzumab</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_atezolizumab</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_durvalumab</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_IVIG</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_tacrolimus</td>
        <td headers="stat_0_1">1 (0.1%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">1 (0.4%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_fluorouracil</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_irinotecan</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_leucovorin</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_oxaliplatin</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
    </tbody>
  </table>
</table-wrap>
<code language="r script">save(table_descriptive, file = &quot;data/results/table-descriptive.rda&quot;)
</code>
</sec>
<p>Summary statistics, by site.</p>
<sec id="nb-code-cell-5-nb-2" specific-use="notebook-code">
<code language="r script">table_descriptive_site &lt;- data_patient_transformed |&gt;
  select(
    all_of(predictor_transformed), starts_with(&quot;comed&quot;), flag_ADR_TP_ID, site, ADR_CTCAE_max, ADR_onset_first, ADR_PLT_ratio
  ) |&gt;
  tbl_summary(
    by = site,
    statistic = list(all_continuous() ~ &quot;{median} ({p25} - {p75})&quot;),
    missing = &quot;no&quot;
  ) |&gt;
  add_overall() |&gt;
  bold_labels() |&gt;
  add_p(
    test.args = all_tests(&quot;fisher.test&quot;) ~ list(simulate.p.value = TRUE)
  ) |&gt;
  bold_p()
</code>
<code language="r script">table_descriptive_site
</code>
<table-wrap>
  <table>
    <colgroup>
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
    </colgroup>
    <thead>
      <tr>
        <th id="U003CstrongU003ECharacteristicU003CU002FstrongU003E-nb-2" scope="col"><bold>Characteristic</bold></th>
        <th id="U003CstrongU003EOverallU003CU002FstrongU003EU002CU0020NU0020U003DU0020776U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>Overall</bold>,
        N =
        776<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003EBM1U003CU002FstrongU003EU002CU0020NU0020U003DU0020117U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>BM1</bold>,
        N =
        117<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003EBM2U003CU002FstrongU003EU002CU0020NU0020U003DU002069U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>BM2</bold>,
        N =
        69<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003END1U003CU002FstrongU003EU002CU0020NU0020U003DU0020170U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>ND1</bold>,
        N =
        170<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003END2U003CU002FstrongU003EU002CU0020NU0020U003DU0020111U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>ND2</bold>,
        N =
        111<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003ETN1U003CU002FstrongU003EU002CU0020NU0020U003DU002098U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>TN1</bold>,
        N =
        98<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003ETN2U003CU002FstrongU003EU002CU0020NU0020U003DU0020211U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>TN2</bold>,
        N =
        211<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003Ep-valueU003CU002FstrongU003EU003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E2U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>p-value</bold><named-content content-type="gt_footnote_marks"><sup>2</sup></named-content></th>
      </tr>
    </thead>
    <tfoot>
      <tr>
        <td colspan="9"><named-content content-type="gt_footnote_marks"><sup>1</sup></named-content>
        Median (IQR); n (%)</td>
      </tr>
      <tr>
        <td colspan="9"><named-content content-type="gt_footnote_marks"><sup>2</sup></named-content>
        Kruskal-Wallis rank sum test; Pearson’s Chi-squared test;
        Fisher’s Exact Test for Count Data with simulated p-value (based
        on 2000 replicates)</td>
      </tr>
    </tfoot>
    <tbody>
      <tr>
        <td headers="label" style="font-weight: bold">patient_age_per_10</td>
        <td headers="stat_0">6.20 (5.00 - 7.30)</td>
        <td headers="stat_1">5.80 (4.80 - 6.90)</td>
        <td headers="stat_2">6.00 (4.50 - 7.20)</td>
        <td headers="stat_3">6.00 (4.43 - 6.88)</td>
        <td headers="stat_4">5.90 (4.65 - 6.95)</td>
        <td headers="stat_5">6.85 (6.00 - 7.80)</td>
        <td headers="stat_6">6.60 (5.80 - 7.80)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">patient_age_60</td>
        <td headers="stat_0">455 (59%)</td>
        <td headers="stat_1">54 (46%)</td>
        <td headers="stat_2">36 (52%)</td>
        <td headers="stat_3">86 (51%)</td>
        <td headers="stat_4">53 (48%)</td>
        <td headers="stat_5">75 (77%)</td>
        <td headers="stat_6">151 (72%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">patient_age_65</td>
        <td headers="stat_0">351 (45%)</td>
        <td headers="stat_1">41 (35%)</td>
        <td headers="stat_2">26 (38%)</td>
        <td headers="stat_3">64 (38%)</td>
        <td headers="stat_4">41 (37%)</td>
        <td headers="stat_5">59 (60%)</td>
        <td headers="stat_6">120 (57%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">patient_sex</td>
        <td headers="stat_0">288 (37%)</td>
        <td headers="stat_1">49 (42%)</td>
        <td headers="stat_2">22 (32%)</td>
        <td headers="stat_3">69 (41%)</td>
        <td headers="stat_4">28 (25%)</td>
        <td headers="stat_5">46 (47%)</td>
        <td headers="stat_6">74 (35%)</td>
        <td headers="p.value" style="font-weight: bold">0.016</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">patient_weight_per_10</td>
        <td headers="stat_0">5.50 (5.00 - 6.00)</td>
        <td headers="stat_1">5.30 (4.70 - 6.00)</td>
        <td headers="stat_2">5.60 (5.10 - 6.50)</td>
        <td headers="stat_3">5.80 (5.00 - 6.20)</td>
        <td headers="stat_4">5.50 (5.00 - 6.00)</td>
        <td headers="stat_5">5.00 (4.83 - 6.00)</td>
        <td headers="stat_6">5.50 (5.00 - 6.00)</td>
        <td headers="p.value" style="font-weight: bold">0.008</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">patient_weight_50</td>
        <td headers="stat_0">181 (23%)</td>
        <td headers="stat_1">37 (32%)</td>
        <td headers="stat_2">11 (16%)</td>
        <td headers="stat_3">33 (19%)</td>
        <td headers="stat_4">25 (23%)</td>
        <td headers="stat_5">26 (27%)</td>
        <td headers="stat_6">49 (23%)</td>
        <td headers="p.value">0.12</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_CLCR_per_10</td>
        <td headers="stat_0">4.9 (2.1 - 8.3)</td>
        <td headers="stat_1">5.0 (2.4 - 8.0)</td>
        <td headers="stat_2">4.0 (1.9 - 9.3)</td>
        <td headers="stat_3">7.0 (4.1 - 10.8)</td>
        <td headers="stat_4">6.0 (2.8 - 9.3)</td>
        <td headers="stat_5">2.8 (1.4 - 5.3)</td>
        <td headers="stat_6">3.5 (1.7 - 6.7)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_CLCR_60</td>
        <td headers="stat_0">462 (60%)</td>
        <td headers="stat_1">68 (58%)</td>
        <td headers="stat_2">42 (61%)</td>
        <td headers="stat_3">71 (42%)</td>
        <td headers="stat_4">53 (48%)</td>
        <td headers="stat_5">81 (83%)</td>
        <td headers="stat_6">147 (70%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_CLCR_30</td>
        <td headers="stat_0">272 (35%)</td>
        <td headers="stat_1">33 (28%)</td>
        <td headers="stat_2">30 (43%)</td>
        <td headers="stat_3">33 (19%)</td>
        <td headers="stat_4">33 (30%)</td>
        <td headers="stat_5">52 (53%)</td>
        <td headers="stat_6">91 (43%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">dept_ER</td>
        <td headers="stat_0">136 (18%)</td>
        <td headers="stat_1">7 (6.0%)</td>
        <td headers="stat_2">9 (13%)</td>
        <td headers="stat_3">66 (39%)</td>
        <td headers="stat_4">14 (13%)</td>
        <td headers="stat_5">15 (15%)</td>
        <td headers="stat_6">25 (12%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">dept_ICU</td>
        <td headers="stat_0">377 (49%)</td>
        <td headers="stat_1">9 (7.7%)</td>
        <td headers="stat_2">21 (30%)</td>
        <td headers="stat_3">73 (43%)</td>
        <td headers="stat_4">40 (36%)</td>
        <td headers="stat_5">76 (78%)</td>
        <td headers="stat_6">158 (75%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_HGB_per_10</td>
        <td headers="stat_0">10.30 (9.00 - 12.10)</td>
        <td headers="stat_1">10.70 (9.30 - 12.40)</td>
        <td headers="stat_2">10.10 (8.40 - 11.90)</td>
        <td headers="stat_3">10.55 (9.03 - 12.38)</td>
        <td headers="stat_4">10.00 (8.95 - 11.90)</td>
        <td headers="stat_5">9.90 (8.93 - 11.60)</td>
        <td headers="stat_6">10.40 (9.05 - 12.00)</td>
        <td headers="p.value">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_WBC_per_10</td>
        <td headers="stat_0">1.22 (0.82 - 1.69)</td>
        <td headers="stat_1">1.21 (0.79 - 1.62)</td>
        <td headers="stat_2">1.12 (0.73 - 1.65)</td>
        <td headers="stat_3">1.20 (0.77 - 1.77)</td>
        <td headers="stat_4">1.10 (0.71 - 1.48)</td>
        <td headers="stat_5">1.19 (0.80 - 1.80)</td>
        <td headers="stat_6">1.32 (0.97 - 1.78)</td>
        <td headers="p.value" style="font-weight: bold">0.013</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_PLT_per_10</td>
        <td headers="stat_0">21 (15 - 29)</td>
        <td headers="stat_1">20 (14 - 25)</td>
        <td headers="stat_2">23 (17 - 32)</td>
        <td headers="stat_3">21 (13 - 29)</td>
        <td headers="stat_4">23 (14 - 31)</td>
        <td headers="stat_5">17 (12 - 25)</td>
        <td headers="stat_6">23 (17 - 30)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_PLT_200</td>
        <td headers="stat_0">349 (45%)</td>
        <td headers="stat_1">59 (50%)</td>
        <td headers="stat_2">26 (38%)</td>
        <td headers="stat_3">77 (45%)</td>
        <td headers="stat_4">41 (37%)</td>
        <td headers="stat_5">65 (66%)</td>
        <td headers="stat_6">81 (38%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_PLT_150</td>
        <td headers="stat_0">203 (26%)</td>
        <td headers="stat_1">34 (29%)</td>
        <td headers="stat_2">13 (19%)</td>
        <td headers="stat_3">52 (31%)</td>
        <td headers="stat_4">31 (28%)</td>
        <td headers="stat_5">40 (41%)</td>
        <td headers="stat_6">33 (16%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_duration</td>
        <td headers="stat_0">9.0 (6.0 - 14.0)</td>
        <td headers="stat_1">8.0 (6.0 - 13.0)</td>
        <td headers="stat_2">10.0 (7.0 - 14.0)</td>
        <td headers="stat_3">10.0 (6.0 - 14.0)</td>
        <td headers="stat_4">9.0 (6.0 - 12.0)</td>
        <td headers="stat_5">11.5 (6.0 - 15.0)</td>
        <td headers="stat_6">9.0 (6.0 - 12.0)</td>
        <td headers="p.value">0.4</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_duration_7</td>
        <td headers="stat_0">566 (73%)</td>
        <td headers="stat_1">83 (71%)</td>
        <td headers="stat_2">52 (75%)</td>
        <td headers="stat_3">124 (73%)</td>
        <td headers="stat_4">81 (73%)</td>
        <td headers="stat_5">69 (70%)</td>
        <td headers="stat_6">157 (74%)</td>
        <td headers="p.value">&gt;0.9</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_duration_10</td>
        <td headers="stat_0">383 (49%)</td>
        <td headers="stat_1">52 (44%)</td>
        <td headers="stat_2">35 (51%)</td>
        <td headers="stat_3">87 (51%)</td>
        <td headers="stat_4">54 (49%)</td>
        <td headers="stat_5">54 (55%)</td>
        <td headers="stat_6">101 (48%)</td>
        <td headers="p.value">0.7</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_duration_14</td>
        <td headers="stat_0">201 (26%)</td>
        <td headers="stat_1">29 (25%)</td>
        <td headers="stat_2">20 (29%)</td>
        <td headers="stat_3">56 (33%)</td>
        <td headers="stat_4">19 (17%)</td>
        <td headers="stat_5">36 (37%)</td>
        <td headers="stat_6">41 (19%)</td>
        <td headers="p.value" style="font-weight: bold">0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_route</td>
        <td headers="stat_0"><break/></td>
        <td headers="stat_1"><break/></td>
        <td headers="stat_2"><break/></td>
        <td headers="stat_3"><break/></td>
        <td headers="stat_4"><break/></td>
        <td headers="stat_5"><break/></td>
        <td headers="stat_6"><break/></td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label">    IV</td>
        <td headers="stat_0">756 (97%)</td>
        <td headers="stat_1">105 (90%)</td>
        <td headers="stat_2">61 (88%)</td>
        <td headers="stat_3">170 (100%)</td>
        <td headers="stat_4">111 (100%)</td>
        <td headers="stat_5">98 (100%)</td>
        <td headers="stat_6">211 (100%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label">    IV&amp;PO</td>
        <td headers="stat_0">9 (1.2%)</td>
        <td headers="stat_1">6 (5.1%)</td>
        <td headers="stat_2">3 (4.3%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label">    PO</td>
        <td headers="stat_0">11 (1.4%)</td>
        <td headers="stat_1">6 (5.1%)</td>
        <td headers="stat_2">5 (7.2%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_ETI</td>
        <td headers="stat_0">366 (47%)</td>
        <td headers="stat_1">62 (53%)</td>
        <td headers="stat_2">28 (41%)</td>
        <td headers="stat_3">111 (65%)</td>
        <td headers="stat_4">43 (39%)</td>
        <td headers="stat_5">47 (48%)</td>
        <td headers="stat_6">75 (36%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_CVC</td>
        <td headers="stat_0">390 (50%)</td>
        <td headers="stat_1">71 (61%)</td>
        <td headers="stat_2">27 (39%)</td>
        <td headers="stat_3">99 (58%)</td>
        <td headers="stat_4">42 (38%)</td>
        <td headers="stat_5">49 (50%)</td>
        <td headers="stat_6">102 (48%)</td>
        <td headers="p.value" style="font-weight: bold">0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_IHD</td>
        <td headers="stat_0">97 (13%)</td>
        <td headers="stat_1">15 (13%)</td>
        <td headers="stat_2">14 (20%)</td>
        <td headers="stat_3">7 (4.1%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">27 (28%)</td>
        <td headers="stat_6">34 (16%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_CRRT</td>
        <td headers="stat_0">130 (17%)</td>
        <td headers="stat_1">17 (15%)</td>
        <td headers="stat_2">7 (10%)</td>
        <td headers="stat_3">51 (30%)</td>
        <td headers="stat_4">5 (4.5%)</td>
        <td headers="stat_5">20 (20%)</td>
        <td headers="stat_6">30 (14%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_HTN</td>
        <td headers="stat_0">330 (43%)</td>
        <td headers="stat_1">41 (35%)</td>
        <td headers="stat_2">28 (41%)</td>
        <td headers="stat_3">48 (28%)</td>
        <td headers="stat_4">38 (34%)</td>
        <td headers="stat_5">57 (58%)</td>
        <td headers="stat_6">118 (56%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_DM</td>
        <td headers="stat_0">212 (27%)</td>
        <td headers="stat_1">28 (24%)</td>
        <td headers="stat_2">24 (35%)</td>
        <td headers="stat_3">28 (16%)</td>
        <td headers="stat_4">22 (20%)</td>
        <td headers="stat_5">29 (30%)</td>
        <td headers="stat_6">81 (38%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_HF</td>
        <td headers="stat_0">219 (28%)</td>
        <td headers="stat_1">54 (46%)</td>
        <td headers="stat_2">11 (16%)</td>
        <td headers="stat_3">14 (8.2%)</td>
        <td headers="stat_4">5 (4.5%)</td>
        <td headers="stat_5">68 (69%)</td>
        <td headers="stat_6">67 (32%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_angina</td>
        <td headers="stat_0">35 (4.5%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">1 (0.6%)</td>
        <td headers="stat_4">1 (0.9%)</td>
        <td headers="stat_5">12 (12%)</td>
        <td headers="stat_6">21 (10.0%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_cirr</td>
        <td headers="stat_0">47 (6.1%)</td>
        <td headers="stat_1">6 (5.1%)</td>
        <td headers="stat_2">1 (1.4%)</td>
        <td headers="stat_3">10 (5.9%)</td>
        <td headers="stat_4">4 (3.6%)</td>
        <td headers="stat_5">12 (12%)</td>
        <td headers="stat_6">14 (6.6%)</td>
        <td headers="p.value">0.091</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_COPD</td>
        <td headers="stat_0">39 (5.0%)</td>
        <td headers="stat_1">3 (2.6%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">2 (1.2%)</td>
        <td headers="stat_4">2 (1.8%)</td>
        <td headers="stat_5">9 (9.2%)</td>
        <td headers="stat_6">23 (11%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_CVA</td>
        <td headers="stat_0">88 (11%)</td>
        <td headers="stat_1">19 (16%)</td>
        <td headers="stat_2">9 (13%)</td>
        <td headers="stat_3">5 (2.9%)</td>
        <td headers="stat_4">4 (3.6%)</td>
        <td headers="stat_5">16 (16%)</td>
        <td headers="stat_6">35 (17%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_MI</td>
        <td headers="stat_0">20 (2.6%)</td>
        <td headers="stat_1">10 (8.5%)</td>
        <td headers="stat_2">3 (4.3%)</td>
        <td headers="stat_3">2 (1.2%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">1 (1.0%)</td>
        <td headers="stat_6">4 (1.9%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_K</td>
        <td headers="stat_0">58 (7.5%)</td>
        <td headers="stat_1">2 (1.7%)</td>
        <td headers="stat_2">4 (5.8%)</td>
        <td headers="stat_3">6 (3.5%)</td>
        <td headers="stat_4">6 (5.4%)</td>
        <td headers="stat_5">11 (11%)</td>
        <td headers="stat_6">29 (14%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_sepsis</td>
        <td headers="stat_0">121 (16%)</td>
        <td headers="stat_1">9 (7.7%)</td>
        <td headers="stat_2">11 (16%)</td>
        <td headers="stat_3">16 (9.4%)</td>
        <td headers="stat_4">16 (14%)</td>
        <td headers="stat_5">43 (44%)</td>
        <td headers="stat_6">26 (12%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_CAP</td>
        <td headers="stat_0">116 (15%)</td>
        <td headers="stat_1">7 (6.0%)</td>
        <td headers="stat_2">5 (7.2%)</td>
        <td headers="stat_3">11 (6.5%)</td>
        <td headers="stat_4">2 (1.8%)</td>
        <td headers="stat_5">26 (27%)</td>
        <td headers="stat_6">65 (31%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_HAP</td>
        <td headers="stat_0">353 (45%)</td>
        <td headers="stat_1">34 (29%)</td>
        <td headers="stat_2">31 (45%)</td>
        <td headers="stat_3">88 (52%)</td>
        <td headers="stat_4">55 (50%)</td>
        <td headers="stat_5">50 (51%)</td>
        <td headers="stat_6">95 (45%)</td>
        <td headers="p.value" style="font-weight: bold">0.004</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_SSTI</td>
        <td headers="stat_0">139 (18%)</td>
        <td headers="stat_1">31 (26%)</td>
        <td headers="stat_2">30 (43%)</td>
        <td headers="stat_3">4 (2.4%)</td>
        <td headers="stat_4">15 (14%)</td>
        <td headers="stat_5">23 (23%)</td>
        <td headers="stat_6">36 (17%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_CNS</td>
        <td headers="stat_0">62 (8.0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">5 (7.2%)</td>
        <td headers="stat_3">22 (13%)</td>
        <td headers="stat_4">17 (15%)</td>
        <td headers="stat_5">4 (4.1%)</td>
        <td headers="stat_6">14 (6.6%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_IAI</td>
        <td headers="stat_0">47 (6.1%)</td>
        <td headers="stat_1">8 (6.8%)</td>
        <td headers="stat_2">7 (10%)</td>
        <td headers="stat_3">1 (0.6%)</td>
        <td headers="stat_4">1 (0.9%)</td>
        <td headers="stat_5">12 (12%)</td>
        <td headers="stat_6">18 (8.5%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_UTI</td>
        <td headers="stat_0">48 (6.2%)</td>
        <td headers="stat_1">5 (4.3%)</td>
        <td headers="stat_2">7 (10%)</td>
        <td headers="stat_3">10 (5.9%)</td>
        <td headers="stat_4">2 (1.8%)</td>
        <td headers="stat_5">4 (4.1%)</td>
        <td headers="stat_6">20 (9.5%)</td>
        <td headers="p.value" style="font-weight: bold">0.047</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_BJI</td>
        <td headers="stat_0">12 (1.5%)</td>
        <td headers="stat_1">3 (2.6%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">3 (2.7%)</td>
        <td headers="stat_5">1 (1.0%)</td>
        <td headers="stat_6">5 (2.4%)</td>
        <td headers="p.value">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_septicemia</td>
        <td headers="stat_0">240 (31%)</td>
        <td headers="stat_1">31 (26%)</td>
        <td headers="stat_2">22 (32%)</td>
        <td headers="stat_3">49 (29%)</td>
        <td headers="stat_4">59 (53%)</td>
        <td headers="stat_5">7 (7.1%)</td>
        <td headers="stat_6">72 (34%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_ibuprofen</td>
        <td headers="stat_0">19 (2.4%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">1 (0.9%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">18 (8.5%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_carbapenem</td>
        <td headers="stat_0">565 (73%)</td>
        <td headers="stat_1">46 (39%)</td>
        <td headers="stat_2">40 (58%)</td>
        <td headers="stat_3">151 (89%)</td>
        <td headers="stat_4">80 (72%)</td>
        <td headers="stat_5">78 (80%)</td>
        <td headers="stat_6">170 (81%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_vancomycin</td>
        <td headers="stat_0">67 (8.6%)</td>
        <td headers="stat_1">7 (6.0%)</td>
        <td headers="stat_2">3 (4.3%)</td>
        <td headers="stat_3">7 (4.1%)</td>
        <td headers="stat_4">17 (15%)</td>
        <td headers="stat_5">3 (3.1%)</td>
        <td headers="stat_6">30 (14%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_levofloxacin</td>
        <td headers="stat_0">240 (31%)</td>
        <td headers="stat_1">25 (21%)</td>
        <td headers="stat_2">6 (8.7%)</td>
        <td headers="stat_3">23 (14%)</td>
        <td headers="stat_4">21 (19%)</td>
        <td headers="stat_5">34 (35%)</td>
        <td headers="stat_6">131 (62%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_teicoplanin</td>
        <td headers="stat_0">38 (4.9%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">7 (4.1%)</td>
        <td headers="stat_4">2 (1.8%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">29 (14%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_pyrazinamid</td>
        <td headers="stat_0">13 (1.7%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">4 (2.4%)</td>
        <td headers="stat_4">9 (8.1%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_rifampin</td>
        <td headers="stat_0">15 (1.9%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">4 (2.4%)</td>
        <td headers="stat_4">10 (9.0%)</td>
        <td headers="stat_5">1 (1.0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_heparin</td>
        <td headers="stat_0">215 (28%)</td>
        <td headers="stat_1">12 (10%)</td>
        <td headers="stat_2">2 (2.9%)</td>
        <td headers="stat_3">72 (42%)</td>
        <td headers="stat_4">28 (25%)</td>
        <td headers="stat_5">33 (34%)</td>
        <td headers="stat_6">68 (32%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_clopidogrel</td>
        <td headers="stat_0">40 (5.2%)</td>
        <td headers="stat_1">7 (6.0%)</td>
        <td headers="stat_2">4 (5.8%)</td>
        <td headers="stat_3">1 (0.6%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">8 (8.2%)</td>
        <td headers="stat_6">20 (9.5%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_enoxaparin</td>
        <td headers="stat_0">358 (46%)</td>
        <td headers="stat_1">32 (27%)</td>
        <td headers="stat_2">12 (17%)</td>
        <td headers="stat_3">118 (69%)</td>
        <td headers="stat_4">52 (47%)</td>
        <td headers="stat_5">39 (40%)</td>
        <td headers="stat_6">105 (50%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_valproic</td>
        <td headers="stat_0">32 (4.1%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">1 (1.4%)</td>
        <td headers="stat_3">10 (5.9%)</td>
        <td headers="stat_4">5 (4.5%)</td>
        <td headers="stat_5">3 (3.1%)</td>
        <td headers="stat_6">13 (6.2%)</td>
        <td headers="p.value" style="font-weight: bold">0.034</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_aspirin</td>
        <td headers="stat_0">42 (5.4%)</td>
        <td headers="stat_1">8 (6.8%)</td>
        <td headers="stat_2">8 (12%)</td>
        <td headers="stat_3">3 (1.8%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">5 (5.1%)</td>
        <td headers="stat_6">18 (8.5%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_aceclofenac</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_diclofenac</td>
        <td headers="stat_0">27 (3.5%)</td>
        <td headers="stat_1">24 (21%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">1 (0.9%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">2 (0.9%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_naproxen</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_paracetamol</td>
        <td headers="stat_0">351 (45%)</td>
        <td headers="stat_1">63 (54%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">84 (49%)</td>
        <td headers="stat_4">70 (63%)</td>
        <td headers="stat_5">47 (48%)</td>
        <td headers="stat_6">87 (41%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_penicillin</td>
        <td headers="stat_0">168 (22%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">5 (7.2%)</td>
        <td headers="stat_3">32 (19%)</td>
        <td headers="stat_4">15 (14%)</td>
        <td headers="stat_5">17 (17%)</td>
        <td headers="stat_6">99 (47%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_cepha</td>
        <td headers="stat_0">196 (25%)</td>
        <td headers="stat_1">11 (9.4%)</td>
        <td headers="stat_2">9 (13%)</td>
        <td headers="stat_3">33 (19%)</td>
        <td headers="stat_4">29 (26%)</td>
        <td headers="stat_5">11 (11%)</td>
        <td headers="stat_6">103 (49%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_cotrimoxazol</td>
        <td headers="stat_0">71 (9.1%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">5 (7.2%)</td>
        <td headers="stat_3">20 (12%)</td>
        <td headers="stat_4">16 (14%)</td>
        <td headers="stat_5">9 (9.2%)</td>
        <td headers="stat_6">21 (10.0%)</td>
        <td headers="p.value" style="font-weight: bold">0.004</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_daptomycin</td>
        <td headers="stat_0">1 (0.1%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">1 (0.9%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value">0.4</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_ethambutol</td>
        <td headers="stat_0">8 (1.0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">2 (1.2%)</td>
        <td headers="stat_4">6 (5.4%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_cetirizin</td>
        <td headers="stat_0">6 (0.8%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">6 (2.8%)</td>
        <td headers="p.value" style="font-weight: bold">0.022</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_dexamethason</td>
        <td headers="stat_0">109 (14%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">74 (44%)</td>
        <td headers="stat_4">25 (23%)</td>
        <td headers="stat_5">2 (2.0%)</td>
        <td headers="stat_6">8 (3.8%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_amiodaron</td>
        <td headers="stat_0">35 (4.5%)</td>
        <td headers="stat_1">8 (6.8%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">14 (8.2%)</td>
        <td headers="stat_4">4 (3.6%)</td>
        <td headers="stat_5">4 (4.1%)</td>
        <td headers="stat_6">5 (2.4%)</td>
        <td headers="p.value" style="font-weight: bold">0.022</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_furosemid</td>
        <td headers="stat_0">422 (54%)</td>
        <td headers="stat_1">68 (58%)</td>
        <td headers="stat_2">14 (20%)</td>
        <td headers="stat_3">78 (46%)</td>
        <td headers="stat_4">47 (42%)</td>
        <td headers="stat_5">70 (71%)</td>
        <td headers="stat_6">145 (69%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_simvas</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_bisoprolol</td>
        <td headers="stat_0">5 (0.6%)</td>
        <td headers="stat_1">4 (3.4%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">1 (0.6%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value" style="font-weight: bold">0.010</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_diltiazem</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_eptifibatid</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_quinidin</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_haloperidol</td>
        <td headers="stat_0">51 (6.6%)</td>
        <td headers="stat_1">3 (2.6%)</td>
        <td headers="stat_2">4 (5.8%)</td>
        <td headers="stat_3">21 (12%)</td>
        <td headers="stat_4">4 (3.6%)</td>
        <td headers="stat_5">5 (5.1%)</td>
        <td headers="stat_6">14 (6.6%)</td>
        <td headers="p.value" style="font-weight: bold">0.021</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_carbamazepin</td>
        <td headers="stat_0">8 (1.0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">7 (4.1%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">1 (0.5%)</td>
        <td headers="p.value" style="font-weight: bold">0.005</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_phenytoin</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_mirtazapin</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_quetiapin</td>
        <td headers="stat_0">4 (0.5%)</td>
        <td headers="stat_1">1 (0.9%)</td>
        <td headers="stat_2">1 (1.4%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">2 (0.9%)</td>
        <td headers="p.value">0.5</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_ondansetron</td>
        <td headers="stat_0">5 (0.6%)</td>
        <td headers="stat_1">2 (1.7%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">3 (2.7%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value" style="font-weight: bold">0.016</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_palonosetron</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_oseltamivir</td>
        <td headers="stat_0">2 (0.3%)</td>
        <td headers="stat_1">1 (0.9%)</td>
        <td headers="stat_2">1 (1.4%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value">0.13</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_quinin</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_pembrolizumab</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_trastuzumab</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_atezolizumab</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_durvalumab</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_IVIG</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_tacrolimus</td>
        <td headers="stat_0">1 (0.1%)</td>
        <td headers="stat_1">1 (0.9%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value">0.5</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_fluorouracil</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_irinotecan</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_leucovorin</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_oxaliplatin</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">flag_ADR_TP_ID</td>
        <td headers="stat_0">247 (32%)</td>
        <td headers="stat_1">32 (27%)</td>
        <td headers="stat_2">18 (26%)</td>
        <td headers="stat_3">55 (32%)</td>
        <td headers="stat_4">32 (29%)</td>
        <td headers="stat_5">38 (39%)</td>
        <td headers="stat_6">72 (34%)</td>
        <td headers="p.value">0.4</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">ADR_CTCAE_max</td>
        <td headers="stat_0"><break/></td>
        <td headers="stat_1"><break/></td>
        <td headers="stat_2"><break/></td>
        <td headers="stat_3"><break/></td>
        <td headers="stat_4"><break/></td>
        <td headers="stat_5"><break/></td>
        <td headers="stat_6"><break/></td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label">    1</td>
        <td headers="stat_0">80 (32%)</td>
        <td headers="stat_1">10 (31%)</td>
        <td headers="stat_2">6 (33%)</td>
        <td headers="stat_3">17 (31%)</td>
        <td headers="stat_4">7 (22%)</td>
        <td headers="stat_5">7 (18%)</td>
        <td headers="stat_6">33 (46%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label">    2</td>
        <td headers="stat_0">76 (31%)</td>
        <td headers="stat_1">10 (31%)</td>
        <td headers="stat_2">5 (28%)</td>
        <td headers="stat_3">12 (22%)</td>
        <td headers="stat_4">6 (19%)</td>
        <td headers="stat_5">17 (45%)</td>
        <td headers="stat_6">26 (36%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label">    3</td>
        <td headers="stat_0">48 (19%)</td>
        <td headers="stat_1">4 (13%)</td>
        <td headers="stat_2">3 (17%)</td>
        <td headers="stat_3">16 (29%)</td>
        <td headers="stat_4">7 (22%)</td>
        <td headers="stat_5">6 (16%)</td>
        <td headers="stat_6">12 (17%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label">    4</td>
        <td headers="stat_0">43 (17%)</td>
        <td headers="stat_1">8 (25%)</td>
        <td headers="stat_2">4 (22%)</td>
        <td headers="stat_3">10 (18%)</td>
        <td headers="stat_4">12 (38%)</td>
        <td headers="stat_5">8 (21%)</td>
        <td headers="stat_6">1 (1.4%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">ADR_onset_first</td>
        <td headers="stat_0">4.0 (2.0 - 9.5)</td>
        <td headers="stat_1">2.0 (1.0 - 9.3)</td>
        <td headers="stat_2">2.5 (2.0 - 7.0)</td>
        <td headers="stat_3">4.0 (2.0 - 8.5)</td>
        <td headers="stat_4">6.0 (3.0 - 11.0)</td>
        <td headers="stat_5">4.0 (2.0 - 9.0)</td>
        <td headers="stat_6">6.0 (2.0 - 11.0)</td>
        <td headers="p.value">0.050</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">ADR_PLT_ratio</td>
        <td headers="stat_0">0.37 (0.23 - 0.52)</td>
        <td headers="stat_1">0.55 (0.27 - 0.62)</td>
        <td headers="stat_2">0.39 (0.21 - 0.53)</td>
        <td headers="stat_3">0.37 (0.25 - 0.50)</td>
        <td headers="stat_4">0.32 (0.17 - 0.45)</td>
        <td headers="stat_5">0.36 (0.20 - 0.48)</td>
        <td headers="stat_6">0.35 (0.25 - 0.50)</td>
        <td headers="p.value">0.15</td>
      </tr>
    </tbody>
  </table>
</table-wrap>
<code language="r script">save(table_descriptive_site, file = &quot;data/results/table-descriptive-site.rda&quot;)
</code>
<sec id="nb-code-cell-5-output-0-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_aceclofenac', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-1-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_naproxen', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-2-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_simvas', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-3-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_diltiazem', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-4-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_eptifibatid', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-5-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_quinidin', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-6-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_phenytoin', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-7-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_mirtazapin', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-8-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_palonosetron', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-9-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_quinin', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-10-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_pembrolizumab', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-11-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_trastuzumab', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-12-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_atezolizumab', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-13-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_durvalumab', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-14-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_IVIG', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-15-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_fluorouracil', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-16-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_irinotecan', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-17-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_leucovorin', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-18-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_oxaliplatin', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-12-nb-3">
<front-stub>
<title-group>
<article-title>Expert Opinion Survey processing</article-title>
</title-group>
</front-stub>

<body>
<sec id="sample-code-nb-3">
  <title>Sample code</title>
  <sec id="nb-code-cell-1-nb-3" specific-use="notebook-code">
  <code language="r script">library(tidyverse)
  </code>
  <code language="r script">library(ggstats)
library(gtsummary)
  </code>
  <sec id="nb-code-cell-1-output-0-nb-3" specific-use="notebook-output">
  <preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
  </sec>
  </sec>
  <sec id="nb-code-cell-2-nb-3" specific-use="notebook-code">
  <code language="r script">data_survey &lt;- read_csv(&quot;data/data-original-processed/survey_results.csv&quot;) |&gt;
  select(-comorb_hematological)
  </code>
  <sec id="nb-code-cell-2-output-0-nb-3" specific-use="notebook-output">
  <preformat>Rows: 16 Columns: 67
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
dbl (67): patient_age, patient_age_65, patient_sex, patient_weight, patient_...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
  </sec>
  </sec>
  <sec id="nb-code-cell-3-nb-3" specific-use="notebook-code">
  <code language="r script">data_survey_factor &lt;- data_survey |&gt;
  mutate(across(everything(), ~ factor(.x, levels = c(1:5))))
  </code>
  </sec>
  <sec id="nb-code-cell-4-nb-3" specific-use="notebook-code">
  <code language="r script">gglikert(data_survey_factor, sort = &quot;descending&quot;, sort_method = &quot;mean&quot;)
  </code>
  <graphic mimetype="image" mime-subtype="png" xlink:href="03A-expert-survey-processing_files/figure-jats/unnamed-chunk-4-1.png" />
  <code language="r script">gglikert_stacked(data_survey_factor, sort = &quot;descending&quot;, sort_method = &quot;mean&quot;, add_median_line = TRUE)
  </code>
  <graphic mimetype="image" mime-subtype="png" xlink:href="03A-expert-survey-processing_files/figure-jats/unnamed-chunk-4-2.png" />
  </sec>
  <sec id="nb-code-cell-5-nb-3" specific-use="notebook-code">
  <code language="r script">table_survey_summary &lt;- data_survey |&gt;
  tbl_summary(type = ~&quot;continuous&quot;, statistic = list(all_continuous() ~ &quot;{mean} | {median} ({p25} - {p75})&quot;))

survey_summary &lt;- data_survey |&gt;
  summarise(across(everything(), list(median = median, IQR = IQR, mean = mean, sd = sd), .names = &quot;{.fn}.{.col}&quot;)) |&gt;
  pivot_longer(
    cols = everything(),
    names_to = c(&quot;.value&quot;, &quot;variable&quot;),
    names_pattern = &quot;(mean|median|IQR|sd)\\.(.*)&quot;
  )

variables_consensus &lt;- survey_summary |&gt;
  filter((median &gt;= 4 &amp; IQR &lt;= 1) | (mean &gt;= 3.5 &amp; sd &lt;= 1)) |&gt;
  arrange(desc(median), desc(mean)) |&gt;
  pull(variable)

data_survey_factor |&gt;
  select(all_of(variables_consensus)) |&gt;
  gglikert(sort = &quot;descending&quot;, sort_method = &quot;mean&quot;)
  </code>
  <graphic mimetype="image" mime-subtype="png" xlink:href="03A-expert-survey-processing_files/figure-jats/unnamed-chunk-5-1.png" />
  </sec>
  <sec id="nb-code-cell-6-nb-3" specific-use="notebook-code">
  <code language="r script">variables_to_screen_short &lt;- variables_consensus

variables_to_screen_short[str_detect(variables_to_screen_short, &quot;\\d&quot;)] &lt;- str_remove(variables_to_screen_short[str_detect(variables_to_screen_short, &quot;_\\d+&quot;)], &quot;_\\d+&quot;)

variables_to_screen_short[str_detect(variables_to_screen_short, &quot;LZD_duration&quot;)] &lt;- &quot;LZD_duration_14&quot;

variables_to_screen_short &lt;- unique(variables_to_screen_short)
  </code>
  </sec>
  <sec id="nb-code-cell-7-nb-3" specific-use="notebook-code">
  <code language="r script">variables_to_screen_short_binary &lt;- variables_consensus

variables_to_screen_short_binary[str_detect(variables_to_screen_short_binary, &quot;\\d&quot;)] &lt;- str_remove(variables_to_screen_short_binary[str_detect(variables_to_screen_short_binary, &quot;_\\d+&quot;)], &quot;_\\d+&quot;)

variables_to_screen_short_binary[str_detect(variables_to_screen_short_binary, &quot;LZD_duration&quot;)] &lt;- &quot;LZD_duration_14&quot;

variables_to_screen_short_binary[str_detect(variables_to_screen_short_binary, &quot;baseline_CLCR&quot;)] &lt;- &quot;baseline_CLCR_30&quot;

variables_to_screen_short_binary &lt;- unique(variables_to_screen_short_binary)
  </code>
  </sec>
  <sec id="nb-code-cell-8-nb-3" specific-use="notebook-code">
  <code language="r script">variables_to_screen &lt;- survey_summary |&gt;
  arrange(desc(median), desc(mean)) |&gt;
  pull(variable)

variables_to_screen[str_detect(variables_to_screen, &quot;\\d&quot;)] &lt;- str_remove(variables_to_screen[str_detect(variables_to_screen, &quot;_\\d+&quot;)], &quot;_\\d+&quot;)

variables_to_screen[str_detect(variables_to_screen, &quot;LZD_duration&quot;)] &lt;- &quot;LZD_duration_14&quot;

variables_to_screen &lt;- unique(variables_to_screen)

variables_to_screen &lt;- variables_to_screen[1:21]

variables_to_force &lt;- variables_to_screen[1:5]

variables_to_force_top_3 &lt;- variables_to_screen[1:3]

variables_out &lt;- survey_summary |&gt;
  filter(!variable %in% variables_to_screen)
  </code>
  </sec>
  <sec id="nb-code-cell-9-nb-3" specific-use="notebook-code">
  <code language="r script">variables_to_force_binary &lt;- survey_summary |&gt;
  arrange(desc(median), desc(mean)) |&gt;
  pull(variable) |&gt;
  head(5)
  </code>
  </sec>
  <sec id="nb-code-cell-10-nb-3" specific-use="notebook-code">
  <code language="r script">save(variables_to_screen, file = &quot;data/results/variables-to-screen.rda&quot;)
save(variables_to_screen_short, file = &quot;data/results/variables-to-screen-short.rda&quot;)
save(variables_to_screen_short_binary, file = &quot;data/results/variables-to-screen-short-binary.rda&quot;)
save(variables_to_force, file = &quot;data/results/variables-to-force.rda&quot;)
save(variables_to_force_binary, file = &quot;data/results/variables-to-force-binary.rda&quot;)
save(variables_to_force_top_3, file = &quot;data/results/variables-to-force-top-3.rda&quot;)
  </code>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-16-nb-4">
<front-stub>
<title-group>
<article-title>Model Development and Apparent Validation</article-title>
</title-group>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-4" specific-use="notebook-code">
<code language="r script">source(&quot;notebooks/initialize-data-analysis.r&quot;)
</code>
<code language="r script">source(&quot;notebooks/BMA-model-no-initial-var.r&quot;) # run_bas_glm() function
source(&quot;notebooks/prob-cal_intercept.r&quot;) # valProbggplot() function
</code>
<code language="r script">source(&quot;notebooks/prob-cal_slope.r&quot;)

load(&quot;data/results/variables-to-screen.rda&quot;)
load(&quot;data/results/variables-to-screen-short.rda&quot;)
load(&quot;data/results/variables-to-screen-short-binary.rda&quot;)
load(&quot;data/results/variables-to-force.rda&quot;)
load(&quot;data/results/variables-to-force-binary.rda&quot;)
load(&quot;data/results/variables-to-force-top-3.rda&quot;)
</code>
<sec id="nb-code-cell-1-output-0-nb-4" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
<sec id="nb-code-cell-1-output-1-nb-4" specific-use="notebook-output">
<preformat>
Attaching package: 'yardstick'

The following object is masked from 'package:readr':

    spec

Loading required package: rms
Loading required package: Hmisc

Attaching package: 'Hmisc'

The following objects are masked from 'package:dplyr':

    src, summarize

The following objects are masked from 'package:base':

    format.pval, units</preformat>
</sec>
</sec>
<sec id="penalized-likelihood-methods-nb-4">
  <title>Penalized Likelihood Methods</title>
  <sec id="backwards-stepwise-logistic-regression-obsolete-nb-4">
    <title>Backwards Stepwise Logistic Regression (obsolete)</title>
    <sec id="nb-code-cell-2-nb-4" specific-use="notebook-code">
    <code language="r script"># library(StepReg)
# run_stepwise_logit &lt;- function(data, formula) {
#   stepwise(
#     formula,
#     data = data,
#     type = &quot;logit&quot;,
#     include = NULL,
#     strategy = &quot;backward&quot;,
#     metric = &quot;AIC&quot;
#   )
# }

# stepwise_model &lt;- data_patient_transformed |&gt;
#   select(all_of(variables_to_screen_short), flag_ADR_TP_ID) |&gt;
#   run_stepwise_logit(
#     formula = flag_ADR_TP_ID ~ .
#   )

# stepwise_model
    </code>
    </sec>
    <sec id="nb-code-cell-3-nb-4" specific-use="notebook-code">
    <code language="r script"># run_step_AIC &lt;- function(data, formula) {
#   MASS::stepAIC(
#     glm(
#       formula = formula,
#       data = data
#     ),
#     direction = &quot;backward&quot;,
#     trace = FALSE
#   )
# }

# stepwise_model_MASS &lt;- data_patient_transformed |&gt;
#   select(all_of(predictor_transformed), flag_ADR_TP_ID) |&gt;
#   run_step_AIC(
#     formula = flag_ADR_TP_ID ~ .
#   )

# stepwise_model_MASS |&gt; str()
    </code>
    </sec>
  </sec>
  <sec id="lasso-variable-selection-obsolete-see-elastic-net-regularization-nb-4">
    <title>LASSO Variable Selection (obsolete, see Elastic Net
    Regularization)</title>
    <sec id="nb-code-cell-4-nb-4" specific-use="notebook-code">
    <code language="r script"># library(glmnet)
# predictor_matrix &lt;- data_patient_complete |&gt;
#   select(all_of(predictor_list)) |&gt;
#   as.matrix()
# response_matrix &lt;- data_patient_complete |&gt;
#   select(flag_ADR_TP_ID) |&gt;
#   pull()

# lasso_fit &lt;- glmnet(
#   x = predictor_matrix,
#   y = response_matrix,
#   family = &quot;binomial&quot;,
#   alpha = 1
# )

# cv_lasso_fit &lt;- cv.glmnet(
#   x = predictor_matrix,
#   y = response_matrix,
#   family = &quot;binomial&quot;,
#   alpha = 1,
#   nfolds = 5
# )

# coef(lasso_fit, s = cv_lasso_fit$lambda.min)@i |&gt; length() - 1
    </code>
    </sec>
  </sec>
  <sec id="elastic-net-regularization-nb-4">
    <title>Elastic Net Regularization</title>
    <sec id="nb-code-cell-5-nb-4" specific-use="notebook-code">
    <code language="r script">library(tidymodels)
    </code>
    <code language="r script">library(future)
library(tictoc)

data_patient_cross_prep_factor &lt;- data_patient_transformed |&gt;
  select(all_of(variables_to_screen_short), flag_ADR_TP_ID, site) |&gt;
  mutate(
    across(where(is.logical), as.factor)
  )

data_patient_screen &lt;- data_patient_transformed |&gt;
  select(all_of(variables_to_screen_short), flag_ADR_TP_ID) |&gt;
  mutate(
    across(where(is.logical), as.factor)
  )

data_patient_screen_binary &lt;- data_patient_transformed |&gt;
  select(all_of(variables_to_screen_short_binary), flag_ADR_TP_ID) |&gt;
  mutate(
    across(where(is.logical), as.factor)
  )

cross_splits &lt;- group_initial_split(data_patient_cross_prep_factor, group = &quot;site&quot;)

cross_samples &lt;- group_vfold_cv(data_patient_cross_prep_factor, group = &quot;site&quot;)
    </code>
    <sec id="nb-code-cell-5-output-0-nb-4" specific-use="notebook-output">
    <preformat>── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──</preformat>
    </sec>
    <sec id="nb-code-cell-5-output-1-nb-4" specific-use="notebook-output">
    <preformat>✔ broom        1.0.5      ✔ recipes      1.0.10
✔ dials        1.2.1      ✔ rsample      1.2.0 
✔ infer        1.0.6      ✔ tune         1.2.0 
✔ modeldata    1.3.0      ✔ workflows    1.1.4 
✔ parsnip      1.2.0      ✔ workflowsets 1.1.0 </preformat>
    </sec>
    <sec id="nb-code-cell-5-output-2-nb-4" specific-use="notebook-output">
    <preformat>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ scales::discard()    masks purrr::discard()
✖ dplyr::filter()      masks stats::filter()
✖ recipes::fixed()     masks stringr::fixed()
✖ dplyr::lag()         masks stats::lag()
✖ yardstick::spec()    masks readr::spec()
✖ Hmisc::src()         masks dplyr::src()
✖ recipes::step()      masks stats::step()
✖ Hmisc::summarize()   masks dplyr::summarize()
✖ parsnip::translate() masks Hmisc::translate()
• Learn how to get started at https://www.tidymodels.org/start/</preformat>
    </sec>
    </sec>
    <sec id="nb-code-cell-6-nb-4" specific-use="notebook-code">
    <code language="r script">rec &lt;- recipe(flag_ADR_TP_ID ~ ., data = data_patient_screen) |&gt;
  step_dummy(all_nominal_predictors())

model_elastic &lt;- logistic_reg(penalty = tune(), mixture = tune()) |&gt;
  set_engine(&quot;glmnet&quot;) |&gt;
  set_mode(&quot;classification&quot;)

model_workflow &lt;- workflow() |&gt;
  add_model(model_elastic) |&gt;
  add_recipe(rec)

tune_params &lt;- model_workflow |&gt;
  extract_parameter_set_dials() |&gt;
  update(
    penalty = penalty(range = c(-3, 0)),
    mixture = mixture(range = c(0.5, 1))
  ) |&gt;
  grid_latin_hypercube(size = 1000)

tic()
plan(multisession, workers = max(min(parallel::detectCores() - 1, 12), 2))

model_tune_results &lt;- model_workflow |&gt;
  tune_grid(
    resamples = cross_samples,
    grid = tune_params,
    control = control_grid(save_pred = TRUE)
  )

plan(sequential)
toc()
    </code>
    <code language="r script">model_accepted_flow &lt;- model_tune_results |&gt;
  select_by_one_std_err(desc(mixture), desc(penalty), metric = &quot;roc_auc&quot;)

model_glmnet &lt;- model_workflow |&gt;
  finalize_workflow(model_accepted_flow) |&gt;
  fit(data = data_patient_screen)

model_workflow |&gt;
  finalize_workflow(model_accepted_flow) |&gt;
  fit_resamples(
    resamples = cross_samples,
    metrics = metric_set(roc_auc, brier_class, cal_intercept, cal_slope),
    control = control_resamples(save_pred = TRUE)
  ) |&gt;
  collect_metrics()
    </code>
    <code language="r script">model_glmnet |&gt; tidy()
    </code>
    <sec id="nb-code-cell-6-output-0-nb-4" specific-use="notebook-output">
    <preformat>388.701 sec elapsed</preformat>
    </sec>
    <sec id="nb-code-cell-6-output-1-nb-4" specific-use="notebook-output">
    <preformat># A tibble: 4 × 6
  .metric       .estimator    mean     n std_err .config             
  &lt;chr&gt;         &lt;chr&gt;        &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 brier_class   binary      0.173      6  0.0123 Preprocessor1_Model1
2 cal_intercept binary     -0.0236     6  0.147  Preprocessor1_Model1
3 cal_slope     binary      1.09       6  0.148  Preprocessor1_Model1
4 roc_auc       binary      0.785      6  0.0198 Preprocessor1_Model1</preformat>
    </sec>
    <sec id="nb-code-cell-6-output-2-nb-4" specific-use="notebook-output">
    <preformat># A tibble: 14 × 3
   term                    estimate penalty
   &lt;chr&gt;                      &lt;dbl&gt;   &lt;dbl&gt;
 1 (Intercept)             -0.729   0.00268
 2 baseline_CLCR           -0.00555 0.00268
 3 patient_age              0.0160  0.00268
 4 baseline_PLT            -0.00787 0.00268
 5 LZD_duration_14_TRUE.    0.932   0.00268
 6 comed_heparin_TRUE.      0.823   0.00268
 7 infect_sepsis_TRUE.      0.576   0.00268
 8 dept_ICU_TRUE.           0.0307  0.00268
 9 comorb_cirr_TRUE.        0.762   0.00268
10 invasive_CRRT_TRUE.      0.399   0.00268
11 comed_enoxaparin_TRUE.   0.145   0.00268
12 LZD_route_IV_TRUE.       0       0.00268
13 infect_septicemia_TRUE.  0.200   0.00268
14 invasive_IHD_TRUE.      -0.0468  0.00268</preformat>
    </sec>
    </sec>
    <sec id="nb-code-cell-7-nb-4" specific-use="notebook-code">
    <code language="r script"># multi_glmnet &lt;- model_glmnet |&gt;
#   tidy() |&gt;
#   filter(estimate &gt; 0) |&gt;
#   pull(term) |&gt;
#   str_extract(paste(variables_to_screen, collapse = &quot;|&quot;))

# model_glmnet_fit &lt;-
#   logistic_reg(
#     penalty = model_accepted_flow$penalty,
#     mixture = model_accepted_flow$mixture
#   ) |&gt;
#   set_engine(&quot;glmnet&quot;) |&gt;
#   fit(
#     flag_ADR_TP_ID ~ .,
#     data = data_patient_screen
#   ) |&gt;
#   tidy()
    </code>
    </sec>
  </sec>
</sec>
<sec id="bayesian-methods-nb-4">
  <title>Bayesian Methods</title>
  <sec id="bayesian-model-selection-nb-4">
    <title>Bayesian Model Selection</title>
    <sec id="strategy-1-a-screen-consensus-variables-continuous-variables-only-13-parameters-nb-4">
      <title>Strategy 1-A: Screen “consensus” variables, continuous
      variables only (13 parameters)</title>
      <sec id="nb-code-cell-8-nb-4" specific-use="notebook-code">
      <code language="r script"># multi_model &lt;- data_patient_complete |&gt;
#   select(all_of(predictor_list), flag_ADR_TP_ID) |&gt;
#   run_bas_glm(
#     formula = flag_ADR_TP_ID ~ .,
#     include.always = ~1
#   )

# summary(multi_model)
# plot(multi_model)
# image(multi_model, rotate = FALSE)
# diagnostics(multi_model)

library(tictoc)

tic()
multi_model_transformed &lt;- data_patient_transformed |&gt;
  select(all_of(variables_to_screen_short), flag_ADR_TP_ID) |&gt;
  run_bas_glm(
    formula = flag_ADR_TP_ID ~ .,
    include.always = ~1,
    n.models = 2^15,
    thin = length(variables_to_screen_short),
    force.heredity = TRUE,
    update = 1
  )
toc()
      </code>
      <code language="r script">summary(multi_model_transformed)
      </code>
      <code language="r script">plot(multi_model_transformed)
      </code>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-8-1.png" />
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-8-2.png" />
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-8-3.png" />
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-8-4.png" />
      <code language="r script">image(multi_model_transformed, rotate = FALSE)
      </code>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-8-5.png" />
      <code language="r script"># diagnostics(multi_model_transformed)

multi_predict_HPM &lt;- variable.names(predict(multi_model_transformed, estimator = &quot;HPM&quot;))[-1] |&gt;
  str_extract(paste(variables_to_screen_short, collapse = &quot;|&quot;)) |&gt;
  unique() # highest probability model
multi_predict_BPM &lt;- variable.names(predict(multi_model_transformed, estimator = &quot;BPM&quot;))[-1] |&gt;
  str_extract(paste(variables_to_screen_short, collapse = &quot;|&quot;)) |&gt;
  unique() # best predictive model, this model is weird

model_black_box &lt;- multi_model_transformed

save(model_black_box, file = &quot;data/results/model-black-box.rda&quot;)
      </code>
      <sec id="nb-code-cell-8-output-0-nb-4" specific-use="notebook-output">
      <preformat>21.317 sec elapsed</preformat>
      </sec>
      <sec id="nb-code-cell-8-output-1-nb-4" specific-use="notebook-output">
      <preformat>                      P(B != 0 | Y)      model 1   model 2      model 3
Intercept                 1.0000000    1.0000000    1.0000    1.0000000
LZD_duration_14TRUE       0.9999099    1.0000000    1.0000    1.0000000
comed_heparinTRUE         0.9996198    1.0000000    1.0000    1.0000000
infect_sepsisTRUE         0.8346716    1.0000000    1.0000    1.0000000
dept_ICUTRUE              0.1173346    0.0000000    0.0000    0.0000000
baseline_CLCR             0.5008370    0.0000000    0.0000    1.0000000
patient_age               0.9362820    1.0000000    1.0000    1.0000000
baseline_PLT              1.0000000    1.0000000    1.0000    1.0000000
comorb_cirrTRUE           0.5782610    0.0000000    1.0000    1.0000000
invasive_CRRTTRUE         0.3437708    0.0000000    0.0000    0.0000000
comed_enoxaparinTRUE      0.1370004    0.0000000    0.0000    0.0000000
LZD_route_IVTRUE          0.1130954    0.0000000    0.0000    0.0000000
infect_septicemiaTRUE     0.1958495    0.0000000    0.0000    0.0000000
invasive_IHDTRUE          0.1227289    0.0000000    0.0000    0.0000000
BF                               NA    0.8636541    1.0000    0.7039779
PostProbs                        NA    0.1022000    0.0888    0.0625000
R2                               NA    0.1856000    0.1913    0.1957000
dim                              NA    6.0000000    7.0000    8.0000000
logmarg                          NA -413.0367119 -412.8901 -413.2411373
                           model 4      model 5
Intercept                1.0000000    1.0000000
LZD_duration_14TRUE      1.0000000    1.0000000
comed_heparinTRUE        1.0000000    1.0000000
infect_sepsisTRUE        1.0000000    1.0000000
dept_ICUTRUE             0.0000000    0.0000000
baseline_CLCR            1.0000000    0.0000000
patient_age              1.0000000    1.0000000
baseline_PLT             1.0000000    1.0000000
comorb_cirrTRUE          0.0000000    1.0000000
invasive_CRRTTRUE        0.0000000    1.0000000
comed_enoxaparinTRUE     0.0000000    0.0000000
LZD_route_IVTRUE         0.0000000    0.0000000
infect_septicemiaTRUE    0.0000000    0.0000000
invasive_IHDTRUE         0.0000000    0.0000000
BF                       0.5222631    0.3496116
PostProbs                0.0464000    0.0310000
R2                       0.1899000    0.1943000
dim                      7.0000000    8.0000000
logmarg               -413.5397127 -413.9410616</preformat>
      </sec>
      </sec>
      <sec id="nb-code-cell-9-nb-4" specific-use="notebook-code">
      <code language="r script">library(tidymodels)
library(probably)
      </code>
      <code language="r script">model_basic_flow &lt;- workflow() |&gt;
  add_variables(outcomes = &quot;flag_ADR_TP_ID&quot;, predictors = all_of(multi_predict_BPM)) |&gt;
  add_model(logistic_reg())

# model_full &lt;- model_basic_flow |&gt;
#   update_variables(outcomes = &quot;flag_ADR_TP_ID&quot;, predictors = all_of(multi_predict_HPM)) |&gt;
#   fit(data = data_patient_screen)

model_full_BPM &lt;- model_basic_flow |&gt;
  update_variables(outcomes = &quot;flag_ADR_TP_ID&quot;, predictors = all_of(multi_predict_BPM)) |&gt;
  fit(data = data_patient_screen)

# model_basic_performances &lt;- workflow() |&gt;
#   add_variables(outcomes = &quot;flag_ADR_TP_ID&quot;, predictors = all_of(multi_predict_BPM)) |&gt;
#   add_model(logistic_reg()) |&gt;
#   fit_resamples(
#     resamples = cross_samples,
#     metrics = metric_set(roc_auc, brier_class, cal_intercept, cal_slope, sens, spec, ppv, npv),
#     control = control_resamples(save_pred = TRUE)
#   )

# model_basic_performances |&gt;
#   collect_metrics()

# model_basic_performances |&gt;
#   collect_predictions() |&gt;
#   threshold_perf(flag_ADR_TP_ID, .pred_TRUE, thresholds = seq(0.1, 0.9, by = 0.1))

save(model_full_BPM, file = &quot;data/model-performance/model-full-BPM-1-A.rda&quot;)
      </code>
      <sec id="nb-code-cell-9-output-0-nb-4" specific-use="notebook-output">
      <preformat>
Attaching package: 'probably'</preformat>
      </sec>
      <sec id="nb-code-cell-9-output-1-nb-4" specific-use="notebook-output">
      <preformat>The following objects are masked from 'package:base':

    as.factor, as.ordered</preformat>
      </sec>
      </sec>
    </sec>
    <sec id="strategy-1-b-force-top-5-screen-consensus-continuous-only-nb-4">
      <title>Strategy 1-B: Force top 5, screen “consensus”, continuous
      only</title>
      <sec id="nb-code-cell-10-nb-4" specific-use="notebook-code">
      <code language="r script">library(tictoc)

tic()
multi_model_1_B &lt;- data_patient_transformed |&gt;
  select(all_of(variables_to_screen_short), flag_ADR_TP_ID) |&gt;
  run_bas_glm(
    formula = flag_ADR_TP_ID ~ .,
    include.always = reformulate(variables_to_force),
    n.models = 2^15,
    thin = length(variables_to_screen_short),
    force.heredity = TRUE,
    update = 1
  )
toc()
      </code>
      <code language="r script">summary(multi_model_1_B)
      </code>
      <code language="r script">plot(multi_model_1_B)
      </code>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-10-1.png" />
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-10-2.png" />
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-10-3.png" />
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-10-4.png" />
      <code language="r script">image(multi_model_1_B, rotate = FALSE)
      </code>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-10-5.png" />
      <code language="r script">multi_predict_HPM_1_B &lt;- variable.names(predict(multi_model_1_B, estimator = &quot;HPM&quot;))[-1] |&gt;
  str_extract(paste(variables_to_screen_short, collapse = &quot;|&quot;)) |&gt;
  unique() # highest probability model
multi_predict_BPM_1_B &lt;- variable.names(predict(multi_model_1_B, estimator = &quot;BPM&quot;))[-1] |&gt;
  str_extract(paste(variables_to_screen_short, collapse = &quot;|&quot;)) |&gt;
  unique() # best predictive model, this model is weird
      </code>
      <sec id="nb-code-cell-10-output-0-nb-4" specific-use="notebook-output">
      <preformat>1.865 sec elapsed</preformat>
      </sec>
      <sec id="nb-code-cell-10-output-1-nb-4" specific-use="notebook-output">
      <preformat>                      P(B != 0 | Y)      model 1      model 2   model 3
Intercept                1.00000000    1.0000000    1.0000000    1.0000
LZD_duration_14TRUE      1.00000000    1.0000000    1.0000000    1.0000
comed_heparinTRUE        1.00000000    1.0000000    1.0000000    1.0000
infect_sepsisTRUE        1.00000000    1.0000000    1.0000000    1.0000
dept_ICUTRUE             1.00000000    1.0000000    1.0000000    1.0000
baseline_CLCR            1.00000000    1.0000000    1.0000000    1.0000
patient_age              0.67588493    1.0000000    0.0000000    1.0000
baseline_PLT             1.00000000    1.0000000    1.0000000    1.0000
comorb_cirrTRUE          0.40132373    0.0000000    0.0000000    1.0000
invasive_CRRTTRUE        0.19497164    0.0000000    0.0000000    0.0000
comed_enoxaparinTRUE     0.09157389    0.0000000    0.0000000    0.0000
LZD_route_IVTRUE         0.06822507    0.0000000    0.0000000    0.0000
infect_septicemiaTRUE    0.12508348    0.0000000    0.0000000    0.0000
invasive_IHDTRUE         0.08538050    0.0000000    0.0000000    0.0000
BF                               NA    0.7185165    0.1849116    1.0000
PostProbs                        NA    0.2160000    0.1946000    0.1503
R2                               NA           NA           NA        NA
dim                              NA    8.0000000    7.0000000    9.0000
logmarg                          NA -415.9572522 -417.3145630 -415.6267
                          model 4      model 5
Intercept                1.000000    1.0000000
LZD_duration_14TRUE      1.000000    1.0000000
comed_heparinTRUE        1.000000    1.0000000
infect_sepsisTRUE        1.000000    1.0000000
dept_ICUTRUE             1.000000    1.0000000
baseline_CLCR            1.000000    1.0000000
patient_age              1.000000    0.0000000
baseline_PLT             1.000000    1.0000000
comorb_cirrTRUE          1.000000    1.0000000
invasive_CRRTTRUE        1.000000    0.0000000
comed_enoxaparinTRUE     0.000000    0.0000000
LZD_route_IVTRUE         0.000000    0.0000000
infect_septicemiaTRUE    0.000000    0.0000000
invasive_IHDTRUE         0.000000    0.0000000
BF                       0.378256    0.1448988
PostProbs                0.045500    0.0436000
R2                             NA           NA
dim                     10.000000    8.0000000
logmarg               -416.598870 -417.5584051</preformat>
      </sec>
      </sec>
      <sec id="nb-code-cell-11-nb-4" specific-use="notebook-code">
      <code language="r script">library(tidymodels)
library(probably)

model_basic_flow_1_B &lt;- workflow() |&gt;
  add_variables(outcomes = &quot;flag_ADR_TP_ID&quot;, predictors = all_of(multi_predict_BPM_1_B)) |&gt;
  add_model(logistic_reg())

model_full_BPM_1_B &lt;- model_basic_flow_1_B |&gt;
  update_variables(outcomes = &quot;flag_ADR_TP_ID&quot;, predictors = all_of(multi_predict_BPM_1_B)) |&gt;
  fit(data = data_patient_screen)

save(model_full_BPM_1_B, file = &quot;data/model-performance/model-full-BPM-1-B.rda&quot;)
      </code>
      </sec>
    </sec>
    <sec id="strategy-1-c-force-top-5-allow-categorical-screen-consensus-continuous-only-nb-4">
      <title>Strategy 1-C: Force top 5 (allow categorical), screen
      “consensus”, continuous only</title>
      <sec id="nb-code-cell-12-nb-4" specific-use="notebook-code">
      <code language="r script">library(tictoc)

tic()
multi_model_1_C &lt;- data_patient_transformed |&gt;
  select(all_of(variables_to_screen_short_binary), flag_ADR_TP_ID) |&gt;
  run_bas_glm(
    formula = flag_ADR_TP_ID ~ .,
    include.always = reformulate(variables_to_force_binary),
    n.models = 2^15,
    thin = length(variables_to_screen_short_binary),
    force.heredity = TRUE,
    update = 1
  )
toc()
      </code>
      <code language="r script">summary(multi_model_1_C)
      </code>
      <code language="r script">plot(multi_model_1_C)
      </code>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-12-1.png" />
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-12-2.png" />
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-12-3.png" />
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-12-4.png" />
      <code language="r script">image(multi_model_1_C, rotate = FALSE)
      </code>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-12-5.png" />
      <code language="r script">multi_predict_HPM_1_C &lt;- variable.names(predict(multi_model_1_C, estimator = &quot;HPM&quot;))[-1] |&gt;
  str_extract(paste(variables_to_screen_short_binary, collapse = &quot;|&quot;)) |&gt;
  unique() # highest probability model
multi_predict_BPM_1_C &lt;- variable.names(predict(multi_model_1_C, estimator = &quot;BPM&quot;))[-1] |&gt;
  str_extract(paste(variables_to_screen_short_binary, collapse = &quot;|&quot;)) |&gt;
  unique() # best predictive model, this model is weird
      </code>
      <sec id="nb-code-cell-12-output-0-nb-4" specific-use="notebook-output">
      <preformat>1.918 sec elapsed</preformat>
      </sec>
      <sec id="nb-code-cell-12-output-1-nb-4" specific-use="notebook-output">
      <preformat>                      P(B != 0 | Y)   model 1      model 2       model 3
Intercept                1.00000000    1.0000    1.0000000    1.00000000
LZD_duration_14TRUE      1.00000000    1.0000    1.0000000    1.00000000
comed_heparinTRUE        1.00000000    1.0000    1.0000000    1.00000000
infect_sepsisTRUE        1.00000000    1.0000    1.0000000    1.00000000
dept_ICUTRUE             1.00000000    1.0000    1.0000000    1.00000000
baseline_CLCR_30TRUE     1.00000000    1.0000    1.0000000    1.00000000
patient_age              0.89358660    1.0000    1.0000000    0.00000000
baseline_PLT             1.00000000    1.0000    1.0000000    1.00000000
comorb_cirrTRUE          0.55551716    1.0000    0.0000000    0.00000000
invasive_CRRTTRUE        0.17014946    0.0000    0.0000000    0.00000000
comed_enoxaparinTRUE     0.11162734    0.0000    0.0000000    0.00000000
LZD_route_IVTRUE         0.08423358    0.0000    0.0000000    0.00000000
infect_septicemiaTRUE    0.14024898    0.0000    0.0000000    0.00000000
invasive_IHDTRUE         0.13180911    0.0000    0.0000000    0.00000000
BF                               NA    1.0000    0.4668824    0.03306299
PostProbs                        NA    0.2524    0.2357000    0.05840000
R2                               NA        NA           NA            NA
dim                              NA    9.0000    8.0000000    7.00000000
logmarg                          NA -413.5514 -414.3130615 -416.96072449
                           model 4      model 5
Intercept                1.0000000    1.0000000
LZD_duration_14TRUE      1.0000000    1.0000000
comed_heparinTRUE        1.0000000    1.0000000
infect_sepsisTRUE        1.0000000    1.0000000
dept_ICUTRUE             1.0000000    1.0000000
baseline_CLCR_30TRUE     1.0000000    1.0000000
patient_age              1.0000000    1.0000000
baseline_PLT             1.0000000    1.0000000
comorb_cirrTRUE          1.0000000    1.0000000
invasive_CRRTTRUE        1.0000000    0.0000000
comed_enoxaparinTRUE     0.0000000    0.0000000
LZD_route_IVTRUE         0.0000000    0.0000000
infect_septicemiaTRUE    0.0000000    0.0000000
invasive_IHDTRUE         0.0000000    1.0000000
BF                       0.2478646    0.1624946
PostProbs                0.0500000    0.0328000
R2                              NA           NA
dim                     10.0000000   10.0000000
logmarg               -414.9462564 -415.3684940</preformat>
      </sec>
      </sec>
      <sec id="nb-code-cell-13-nb-4" specific-use="notebook-code">
      <code language="r script">library(tidymodels)
library(probably)

model_basic_flow_1_C &lt;- workflow() |&gt;
  add_variables(outcomes = &quot;flag_ADR_TP_ID&quot;, predictors = all_of(multi_predict_BPM_1_C)) |&gt;
  add_model(logistic_reg())

model_full_BPM_1_C &lt;- model_basic_flow_1_C |&gt;
  update_variables(outcomes = &quot;flag_ADR_TP_ID&quot;, predictors = all_of(multi_predict_BPM_1_C)) |&gt;
  fit(data = data_patient_screen_binary)

save(model_full_BPM_1_C, file = &quot;data/model-performance/model-full-BPM-1-C.rda&quot;)
      </code>
      </sec>
    </sec>
    <sec id="strategy-1-d-force-top-3-screen-consensus-continuous-only-nb-4">
      <title>Strategy 1-D: Force top 3, screen “consensus”, continuous
      only</title>
      <sec id="nb-code-cell-14-nb-4" specific-use="notebook-code">
      <code language="r script">library(tictoc)

tic()
multi_model_1_D &lt;- data_patient_transformed |&gt;
  select(all_of(variables_to_screen_short_binary), flag_ADR_TP_ID) |&gt;
  run_bas_glm(
    formula = flag_ADR_TP_ID ~ .,
    include.always = reformulate(variables_to_force_top_3),
    n.models = 2^15,
    thin = length(variables_to_screen_short_binary),
    force.heredity = TRUE,
    update = 1
  )
toc()
      </code>
      <code language="r script">summary(multi_model_1_D)
      </code>
      <code language="r script">plot(multi_model_1_D)
      </code>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-14-1.png" />
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-14-2.png" />
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-14-3.png" />
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-14-4.png" />
      <code language="r script">image(multi_model_1_D, rotate = FALSE)
      </code>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-14-5.png" />
      <code language="r script">multi_predict_HPM_1_D &lt;- variable.names(predict(multi_model_1_D, estimator = &quot;HPM&quot;))[-1] |&gt;
  str_extract(paste(variables_to_screen_short_binary, collapse = &quot;|&quot;)) |&gt;
  unique() # highest probability model
multi_predict_BPM_1_D &lt;- variable.names(predict(multi_model_1_D, estimator = &quot;BPM&quot;))[-1] |&gt;
  str_extract(paste(variables_to_screen_short_binary, collapse = &quot;|&quot;)) |&gt;
  unique() # best predictive model, this model is weird
      </code>
      <sec id="nb-code-cell-14-output-0-nb-4" specific-use="notebook-output">
      <preformat>2.407 sec elapsed</preformat>
      </sec>
      <sec id="nb-code-cell-14-output-1-nb-4" specific-use="notebook-output">
      <preformat>                      P(B != 0 | Y)   model 1      model 2      model 3
Intercept                1.00000000    1.0000    1.0000000    1.0000000
LZD_duration_14TRUE      1.00000000    1.0000    1.0000000    1.0000000
comed_heparinTRUE        1.00000000    1.0000    1.0000000    1.0000000
infect_sepsisTRUE        1.00000000    1.0000    1.0000000    1.0000000
dept_ICUTRUE             0.07352734    0.0000    0.0000000    0.0000000
baseline_CLCR_30TRUE     0.72120196    1.0000    1.0000000    0.0000000
patient_age              0.94083778    1.0000    1.0000000    1.0000000
baseline_PLT             1.00000000    1.0000    1.0000000    1.0000000
comorb_cirrTRUE          0.51914312    1.0000    0.0000000    0.0000000
invasive_CRRTTRUE        0.16957570    0.0000    0.0000000    0.0000000
comed_enoxaparinTRUE     0.09582222    0.0000    0.0000000    0.0000000
LZD_route_IVTRUE         0.07354823    0.0000    0.0000000    0.0000000
infect_septicemiaTRUE    0.12300798    0.0000    0.0000000    0.0000000
invasive_IHDTRUE         0.10522981    0.0000    0.0000000    0.0000000
BF                               NA    1.0000    0.4814614    0.1533019
PostProbs                        NA    0.1828    0.1540000    0.1308000
R2                               NA        NA           NA           NA
dim                              NA    8.0000    7.0000000    6.0000000
logmarg                          NA -411.1614 -411.8922951 -413.0367119
                           model 4     model 5
Intercept                1.0000000    1.000000
LZD_duration_14TRUE      1.0000000    1.000000
comed_heparinTRUE        1.0000000    1.000000
infect_sepsisTRUE        1.0000000    1.000000
dept_ICUTRUE             0.0000000    0.000000
baseline_CLCR_30TRUE     0.0000000    1.000000
patient_age              1.0000000    1.000000
baseline_PLT             1.0000000    1.000000
comorb_cirrTRUE          1.0000000    1.000000
invasive_CRRTTRUE        0.0000000    1.000000
comed_enoxaparinTRUE     0.0000000    0.000000
LZD_route_IVTRUE         0.0000000    0.000000
infect_septicemiaTRUE    0.0000000    0.000000
invasive_IHDTRUE         0.0000000    0.000000
BF                       0.1775038    0.238176
PostProbs                0.0568000    0.036300
R2                              NA          NA
dim                      7.0000000    9.000000
logmarg               -412.8901290 -412.596111</preformat>
      </sec>
      </sec>
      <sec id="nb-code-cell-15-nb-4" specific-use="notebook-code">
      <code language="r script">library(tidymodels)
library(probably)

model_basic_flow_1_D &lt;- workflow() |&gt;
  add_variables(outcomes = &quot;flag_ADR_TP_ID&quot;, predictors = all_of(multi_predict_BPM_1_D)) |&gt;
  add_model(logistic_reg())

model_full_BPM_1_D &lt;- model_basic_flow_1_D |&gt;
  update_variables(outcomes = &quot;flag_ADR_TP_ID&quot;, predictors = all_of(multi_predict_BPM_1_D)) |&gt;
  fit(data = data_patient_screen_binary)

save(model_full_BPM_1_D, file = &quot;data/model-performance/model-full-BPM-1-D.rda&quot;)
      </code>
      </sec>
    </sec>
    <sec id="strategy-2-a-screen-top-21-by-mean-continuous-only-nb-4">
      <title>Strategy 2-A: Screen top 21 (by mean), continuous
      only</title>
    </sec>
    <sec id="strategy-2-b-force-top-5-screen-top-21-by-mean-continuous-only-nb-4">
      <title>Strategy 2-B: Force top 5, screen top 21 (by mean),
      continuous only</title>
    </sec>
    <sec id="strategy-2-c-force-top-5-allow-categorical-screen-top-21-by-mean-continuous-only-nb-4">
      <title>Strategy 2-C: Force top 5 (allow categorical), screen top
      21 (by mean), continuous only</title>
    </sec>
    <sec id="strategy-2-d-force-top-3-screen-top-21-by-mean-continuous-only-nb-4">
      <title>Strategy 2-D: Force top 3, screen top 21 (by mean),
      continuous only</title>
    </sec>
    <sec id="strategy-3-a-screen-all-continuous-only-nb-4">
      <title>Strategy 3-A: Screen all, continuous only</title>
    </sec>
    <sec id="strategy-3-b-force-top-5-screen-all-continuous-only-nb-4">
      <title>Strategy 3-B: Force top 5, screen all, continuous
      only</title>
    </sec>
    <sec id="strategy-3-c-force-top-5-allow-categorical-screen-all-continuous-only-nb-4">
      <title>Strategy 3-C: Force top 5 (allow categorical), screen all,
      continuous only</title>
    </sec>
    <sec id="strategy-3-d-force-top-3-screen-all-continuous-only-nb-4">
      <title>Strategy 3-D: Force top 3, screen all, continuous
      only</title>
    </sec>
  </sec>
  <sec id="model-performance-completed-in-notebook-04-this-will-be-removed-nb-4">
    <title>Model Performance (completed in notebook 04, this will be
    removed)</title>
    <sec id="nb-code-cell-16-nb-4" specific-use="notebook-code">
    <code language="r script"># library(CalibrationCurves)
# pHat &lt;- predict(model_full_BPM$fit$fit$fit, data_patient_screen, type = &quot;response&quot;)
# yTest &lt;- data_patient_screen$flag_ADR_TP_ID |&gt; as.logical()
# calperf &lt;- valProbggplot(pHat, yTest)

# apparent_performance_metrics &lt;- tibble(
#   cross_C_index = calperf$Cindex[[1]],
#   cross_C_index_lower = calperf$Cindex[[2]],
#   cross_C_index_upper = calperf$Cindex[[3]],
#   cross_calibration_intercept = calperf$Calibration$Intercept[[1]],
#   cross_calibration_intercept_lower = calperf$Calibration$Intercept[[2]],
#   cross_calibration_intercept_upper = calperf$Calibration$Intercept[[3]],
#   cross_calibration_slope = calperf$Calibration$Slope[[1]],
#   cross_calibration_slope_lower = calperf$Calibration$Slope[[2]],
#   cross_calibration_slope_upper = calperf$Calibration$Slope[[3]]
# ) |&gt;
#   mutate(
#     cross_C_index_std_error = (cross_C_index_upper - cross_C_index_lower) / (2 * 1.96),
#     cross_calibration_intercept_std_error = (cross_calibration_intercept_upper - cross_calibration_intercept_lower) / (2 * 1.96),
#     cross_calibration_slope_std_error = (cross_calibration_slope_upper - cross_calibration_slope_lower) / (2 * 1.96)
#   ) |&gt;
#   select(
#     cross_calibration_intercept, cross_calibration_intercept_std_error, cross_calibration_slope, cross_calibration_slope_std_error
#   ) |&gt;
#   rename(
#     cal_in_the_large = cross_calibration_intercept, 
#     cal_in_the_large_std_error = cross_calibration_intercept_std_error, 
#     cal_slope = cross_calibration_slope, 
#     cal_slope_std_error = cross_calibration_slope_std_error) |&gt;
#   pivot_longer(
#     cols = everything(),
#     names_to = c(&quot;.metric&quot;),
#     values_to = c(&quot;mean&quot;)
#   ) |&gt;
#   mutate(std_err = if_else(str_detect(.metric, &quot;std_error&quot;), mean, lead(mean))) |&gt;
#   filter(!str_detect(.metric, &quot;std_error&quot;)) |&gt;
#   bind_rows(model_basic_performances |&gt; collect_metrics())

# save(apparent_performance_metrics, file = &quot;data/model-performance/apparent-performance-metrics.rda&quot;)
    </code>
    </sec>
    <sec id="nb-code-cell-17-nb-4" specific-use="notebook-code">
    <code language="r script"># pHat &lt;- predict(model_full_BPM$fit, data_patient_transformed, type = &quot;response&quot;)
# yTest &lt;- data_patient_transformed$flag_ADR_TP_ID
# calperf &lt;- valProbggplot(pHat, yTest)

# apparent_performance_metrics_BPM &lt;- tibble(
#   apparent_C_index = calperf$Cindex[[1]],
#   apparent_calibration_intercept = calperf$Calibration$Intercept[[1]],
#   apparent_calibration_slope = calperf$Calibration$Slope[[1]]
# )

# save(apparent_performance_metrics_BPM, file = &quot;data/model-performance/apparent-performance-metrics-BPM.rda&quot;)
    </code>
    </sec>
  </sec>
  <sec id="bayesian-generalized-additive-model-wip-nb-4">
    <title>Bayesian Generalized Additive Model (WIP)</title>
    <sec id="nb-code-cell-18-nb-4" specific-use="notebook-code">
    <code language="r script"># library(spikeSlabGAM)
# run_spike_slab_GAM &lt;- function(data, formula, ...) {
#   spikeSlabGAM(formula, data = data, family = &quot;binomial&quot;, ...)
# }

# data_model &lt;- data_patient_transformed |&gt;
#   select(all_of(variables_to_screen), flag_ADR_TP_ID) |&gt;
#   select(-c(&quot;baseline_CLCR_30&quot;, &quot;baseline_CLCR_60&quot;, &quot;LZD_duration_10&quot;, &quot;baseline_PLT_150&quot;, &quot;patient_age_65&quot;)) |&gt;
#   as.data.frame()

# options(mc.cores = max(min(parallel::detectCores() - 1, 12), 2))

# model_0 &lt;-
#   run_spike_slab_GAM(
#     data = data_model,
#     formula = reformulate(
#       termlabels = colnames(data_model) |&gt; setdiff(c(&quot;flag_ADR_TP_ID&quot;)),
#       response = &quot;flag_ADR_TP_ID&quot;
#     )
#   )

# summary(model_0)
# plot(model_0)
    </code>
    </sec>
  </sec>
  <sec id="nomogram-with-rms-wip-nb-4">
    <title>Nomogram with rms (WIP)</title>
    <sec id="nb-code-cell-19-nb-4" specific-use="notebook-code">
    <code language="r script"># library(splines2)

# library(rms)

# data_patient_transformed |&gt;
#   select(all_of(predictor_list), flag_ADR_TP_ID) |&gt;
#   select_if(is.numeric) |&gt;
#   map(quantile, probs = c(0, 0.01, 0.05, 0.25, 0.50, 0.75, 0.95, 0.99, 1))

# dd &lt;- data_patient_transformed |&gt;
#   select(all_of(predictor_list), flag_ADR_TP_ID) |&gt;
#   datadist()

# dd$limits$patient_age &lt;- c(50, 62, 73, 19, 91, 19, 92)
# dd$limits$baseline_PLT &lt;- c(143, 206, 288, 21, 433, 18, 434)
# dd$limits$baseline_CLCR &lt;- c(21, 48, 84, 5, 184, 5, 189)
# dd$limits$LZD_duration &lt;- c(6, 9, 14, 3, 26, 3, 28)

# options(datadist = &quot;dd&quot;)
# nomo_obj &lt;- lrm(flag_ADR_TP_ID ~ rcs(patient_age, 3) + rcs(baseline_PLT, 3) + rcs(baseline_CLCR, 3) + rcs(LZD_duration, 3) + invasive_CRRT + comed_heparin, data = data_patient_transformed) |&gt;
#   nomogram(fun = plogis, funlabel = &quot;Risk&quot;) |&gt;
#   plot()

# for(k in 3:5) {
#   f &lt;- lrm(flag_ADR_TP_ID ~ rcs(patient_age, k) + rcs(baseline_PLT, k) + rcs(baseline_CLCR, k) + rcs(LZD_duration, k) + invasive_CRRT * comed_heparin, data = data_patient_transformed)
#   cat('k=', k, '  AIC=', AIC(f), '\n')
# }

# print.nomogram &lt;- function(x, dec = 0, ...) {
#   obj &lt;- x
#   w &lt;- diff(range(obj$lp$x)) / diff(range(obj$lp$x.real))
#   cat(
#     &quot;Points per unit of linear predictor:&quot;, format(w),
#     &quot;\nLinear predictor units per point   :&quot;, format(1 / w), &quot;\n\n&quot;
#   )

#   fun &lt;- FALSE
#   for (x in names(obj)) {
#     k &lt;- x == &quot;total.points&quot; || x == &quot;lp&quot; || x == &quot;abbrev&quot;
#     if (k) {
#       fun &lt;- TRUE
#       next
#     }
#     y &lt;- obj[[x]]
#     if (fun) {
#       z &lt;- cbind(round(y[[1]], dec), y$x.real)
#       dimnames(z) &lt;- list(rep(&quot;&quot;, nrow(z)), c(&quot;Total Points&quot;, x))
#     } else {
#       z &lt;- cbind(format(y[[1]]), format(round(y$points, dec)))
#       dimnames(z) &lt;- list(rep(&quot;&quot;, length(y$points)), c(x, &quot;Points&quot;))
#       ## didn't use data.frame since wanted blank row names
#     }
#     cat(&quot;\n&quot;)
#     print(z, quote = FALSE)
#     cat(&quot;\n&quot;)
#   }
#   invisible()
# }
    </code>
    </sec>
  </sec>
</sec>
<sec id="check-model-assumptions-nb-4">
  <title>Check Model Assumptions</title>
  <sec id="linearity-nb-4">
    <title>Linearity</title>
    <p>Visual check of linearity assumption using partial-residual plots
    (component+residual plots).</p>
    <p>Blue dashed line: linear fit of the partial residuals.</p>
    <p>Red line: smoothed conditional mean</p>
    <p>The lines should be close together and the red line should be
    linear.</p>
    <sec id="nb-code-cell-20-nb-4" specific-use="notebook-code">
    <code language="r script"># car::crPlot(model_full$fit, variable = &quot;patient_age&quot;)
# car::crPlot(model_full$fit, variable = &quot;baseline_PLT&quot;)

car::crPlot(model_full_BPM |&gt; extract_fit_engine(), variable = &quot;patient_age&quot;)
    </code>
    <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-20-1.png" />
    <code language="r script">car::crPlot(model_full_BPM |&gt; extract_fit_engine(), variable = &quot;baseline_PLT&quot;)
    </code>
    <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-20-2.png" />
    <code language="r script">car::crPlot(model_full_BPM |&gt; extract_fit_engine(), variable = &quot;baseline_CLCR&quot;)
    </code>
    <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-20-3.png" />
    </sec>
    <p>Result: No obvious non-linearity in the partial-residual
    plots.</p>
    <p>Visual check of linearity assumption using logit of predicted
    probabilities vs. continuous predictors values.</p>
    <sec id="nb-code-cell-21-nb-4" specific-use="notebook-code">
    <code language="r script"># data_patient_linear_check &lt;- data_patient_transformed |&gt;
#   select(all_of(multi_predict_HPM)) |&gt;
#   mutate(
#     probabilities = predict(model_full$fit, data_patient_transformed, type = &quot;response&quot;),
#     log_odds = log(probabilities / (1 - probabilities))
#   ) |&gt;
#   select_if(is.numeric) |&gt;
#   gather(key = &quot;predictors&quot;, value = &quot;predictor_value&quot;, -log_odds, -probabilities)

# ggplot(data_patient_linear_check, aes(y = log_odds, x = predictor_value)) +
#   geom_point(size = 0.5, alpha = 0.5) +
#   geom_smooth(method = &quot;loess&quot;, color = &quot;red&quot;) +
#   geom_smooth(method = &quot;lm&quot;, linetype = &quot;dashed&quot;, color = &quot;blue&quot;, se = FALSE) +
#   theme_bw() +
#   facet_wrap(~predictors, scales = &quot;free_x&quot;) +
#   labs(title = &quot;Highest Probability Model&quot;, x = &quot;Predictor Value&quot;, y = &quot;Log Odds&quot;)

data_patient_linear_check_BPM &lt;- data_patient_transformed |&gt;
  select(all_of(multi_predict_BPM)) |&gt;
  mutate(
    probabilities = predict(model_full_BPM |&gt; extract_fit_engine(), data_patient_screen, type = &quot;response&quot;),
    log_odds = log(probabilities / (1 - probabilities))
  ) |&gt;
  select_if(is.numeric) |&gt;
  gather(key = &quot;predictors&quot;, value = &quot;predictor_value&quot;, -log_odds, -probabilities)

ggplot(data_patient_linear_check_BPM, aes(y = log_odds, x = predictor_value)) +
  geom_point(size = 0.5, alpha = 0.5) +
  geom_smooth(method = &quot;loess&quot;, color = &quot;red&quot;) +
  geom_smooth(method = &quot;lm&quot;, linetype = &quot;dashed&quot;, color = &quot;blue&quot;, se = FALSE) +
  theme_bw() +
  facet_wrap(~predictors, scales = &quot;free_x&quot;) +
  labs(title = &quot;Best Predictive Model&quot;, x = &quot;Predictor Value&quot;, y = &quot;Log Odds&quot;)
    </code>
    <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-21-1.png" />
    <sec id="nb-code-cell-21-output-0-nb-4" specific-use="notebook-output">
    <preformat>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</preformat>
    </sec>
    </sec>
  </sec>
  <sec id="no-multicollinearity-nb-4">
    <title>No Multicollinearity</title>
    <p>VIFs from the coefficient estimates should be less than 5 and as
    close to 1 as possible.</p>
    <sec id="nb-code-cell-22-nb-4" specific-use="notebook-code">
    <code language="r script">car::vif(model_full_BPM |&gt; extract_fit_engine())
    </code>
    <sec id="nb-code-cell-22-output-0-nb-4" specific-use="notebook-output">
    <preformat>LZD_duration_14   comed_heparin   infect_sepsis   baseline_CLCR     patient_age 
       1.080494        1.068738        1.048423        1.248118        1.278326 
   baseline_PLT     comorb_cirr 
       1.101339        1.047271 </preformat>
    </sec>
    </sec>
    <p>Result: VIFs are all less than 5 and close to 1.</p>
  </sec>
  <sec id="no-outlier-effects-nb-4">
    <title>No Outlier Effects</title>
    <p>Visual check from influence plot.</p>
    <p>Individual observations should not have too much influence on the
    model.</p>
    <p>Influence plot:</p>
    <list list-type="bullet">
      <list-item>
        <p>x-axis: Extreme values (Hat-values)</p>
      </list-item>
      <list-item>
        <p>y-axis: Leverage (Studentized residuals)</p>
      </list-item>
      <list-item>
        <p>Size of points: Cook’s distance</p>
      </list-item>
    </list>
    <sec id="nb-code-cell-23-nb-4" specific-use="notebook-code">
    <code language="r script"># car::influencePlot(model_full$fit)

car::influencePlot(model_full_BPM |&gt; extract_fit_engine())
    </code>
    <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-23-1.png" />
    <code language="r script">influence.measures(model_full_BPM |&gt; extract_fit_engine())$is.inf |&gt;
  apply(1, any) |&gt;
  which() |&gt;
  unname()
    </code>
    <sec id="nb-code-cell-23-output-0-nb-4" specific-use="notebook-output">
    <preformat>      StudRes         Hat       CookD
281  1.040040 0.051977028 0.004955398
423  2.486394 0.002580423 0.006622933
454  2.046298 0.021856232 0.018682386
687 -1.312956 0.052357529 0.009365878
735  2.665976 0.007352118 0.028204915</preformat>
    </sec>
    <sec id="nb-code-cell-23-output-1-nb-4" specific-use="notebook-output">
    <preformat> [1]   6  14  69  99 119 132 146 148 208 213 251 281 290 305 312 320 323 325 332
[20] 349 364 379 409 423 460 483 552 572 598 642 653 687 716 735</preformat>
    </sec>
    </sec>
    <sec id="nb-code-cell-24-nb-4" specific-use="notebook-code">
    <code language="r script"># data_patient_transformed |&gt;
#   slice(c(292, 301, 335, 364, 504, 634)) |&gt; summary()
    </code>
    </sec>
    <sec id="nb-code-cell-25-nb-4" specific-use="notebook-code">
    <code language="r script"># save(model_full, file = &quot;data/model-performance/model-full.rda&quot;)
save(model_full_BPM, file = &quot;data/model-performance/model-full-BPM.rda&quot;)
save(model_glmnet, file = &quot;data/model-performance/model-glmnet.rda&quot;)
    </code>
    </sec>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-20-nb-5">
<front-stub>
<title-group>
<article-title>Internal-External Development and
Cross-Validation</article-title>
</title-group>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-5" specific-use="notebook-code">
<code language="r script">source(&quot;notebooks/initialize-data-analysis.r&quot;)
</code>
<code language="r script">source(&quot;notebooks/BMA-model-no-initial-var.r&quot;) # run_bas_glm() function
source(&quot;notebooks/prob-cal_intercept.r&quot;) # valProbggplot() function
</code>
<code language="r script">source(&quot;notebooks/prob-cal_slope.r&quot;)

load(&quot;data/results/variables-to-screen.rda&quot;)
load(&quot;data/results/variables-to-screen-short.rda&quot;)
load(&quot;data/results/variables-to-screen-short-binary.rda&quot;)
load(&quot;data/results/variables-to-force.rda&quot;)
load(&quot;data/results/variables-to-force-binary.rda&quot;)
load(&quot;data/results/variables-to-force-top-3.rda&quot;)
</code>
<sec id="nb-code-cell-1-output-0-nb-5" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
<sec id="nb-code-cell-1-output-1-nb-5" specific-use="notebook-output">
<preformat>
Attaching package: 'yardstick'

The following object is masked from 'package:readr':

    spec

Loading required package: rms
Loading required package: Hmisc

Attaching package: 'Hmisc'

The following objects are masked from 'package:dplyr':

    src, summarize

The following objects are masked from 'package:base':

    format.pval, units</preformat>
</sec>
</sec>
<sec id="nb-code-cell-2-nb-5" specific-use="notebook-code">
<code language="r script">library(rsample) # for group_vfold_cv()
library(furrr) # for future_map()
</code>
<code language="r script">library(tidymodels)
</code>
<code language="r script">library(CalibrationCurves)

data_patient_cross_prep &lt;- data_patient_transformed |&gt;
  select(all_of(variables_to_screen_short), flag_ADR_TP_ID, site)

cross_samples &lt;- group_vfold_cv(data_patient_cross_prep, group = &quot;site&quot;)

extract_variable_names_cross &lt;- function(sample) {
  data &lt;- analysis(sample) |&gt; select(-site)
  model &lt;- data |&gt;
    run_bas_glm(
      formula = flag_ADR_TP_ID ~ .,
      include.always = ~1,
      n.models = 2^15,
      thin = ncol(data) - 1,
      update = 1
    )
  # model_HPM &lt;- variable.names(predict(model, estimator = &quot;HPM&quot;))[-1] |&gt;
  #   str_extract(paste(variables_to_screen, collapse = &quot;|&quot;))
  model_BPM &lt;- variable.names(predict(model, estimator = &quot;BPM&quot;))[-1] |&gt;
    str_extract(paste(variables_to_screen_short, collapse = &quot;|&quot;))
  site &lt;- assessment(sample)$site[1]
  return(list(model_BPM, site))
}

plan(multisession, workers = max(min(parallel::detectCores() - 1, 6), 2))

cross_predict &lt;- cross_samples$splits |&gt;
  future_map(extract_variable_names_cross, .options = furrr_options(seed = TRUE))

plan(sequential)

# cross_predict_HPM &lt;- map(cross_predict, 1)
cross_predict_BPM &lt;- map(cross_predict, 1)
cross_predict_site &lt;- map(cross_predict, 2)

run_workflow &lt;- function(sample, variables) {
  rec &lt;- recipe(
    formula &lt;- reformulate(termlabels = variables, response = &quot;flag_ADR_TP_ID&quot;),
    data = analysis(sample) |&gt; mutate(flag_ADR_TP_ID = as.factor(flag_ADR_TP_ID))
  )
  trained &lt;- workflow() |&gt;
    add_recipe(rec) |&gt;
    add_model(logistic_reg()) |&gt;
    fit(data = analysis(sample) |&gt; mutate(flag_ADR_TP_ID = as.factor(flag_ADR_TP_ID)))
  validation &lt;- predict(trained, assessment(sample), type = &quot;prob&quot;) |&gt;
    mutate(truth = assessment(sample)$flag_ADR_TP_ID |&gt; as.factor())

  auc &lt;- roc_auc(validation, truth, .pred_TRUE, event_level = &quot;second&quot;)
  intercept &lt;- cal_intercept(validation, truth, .pred_FALSE)
  slope &lt;- cal_slope(validation, truth, .pred_FALSE)
  bind_rows(auc, intercept, slope)
}

workflow_results &lt;- map2(cross_samples$splits, cross_predict_BPM, run_workflow) |&gt;
  set_names(cross_predict_site) |&gt;
  bind_rows(.id = &quot;site&quot;) |&gt;
  select(-.estimator) |&gt;
  pivot_wider(names_from = .metric, values_from = .estimate)

# Function to modify sample data and fit model
fit_model_to_sample &lt;- function(sample, variables) {
  data &lt;- analysis(sample) |&gt;
    mutate(flag_ADR_TP_ID = as.factor(flag_ADR_TP_ID))

  formula &lt;- reformulate(termlabels = variables, response = &quot;flag_ADR_TP_ID&quot;)

  logistic_reg() |&gt;
    set_engine(&quot;glm&quot;) |&gt;
    set_mode(&quot;classification&quot;) |&gt;
    fit(formula, data = data)
}

calc_cross_performance &lt;- function(sample, model) {
  data &lt;- assessment(sample)
  pHat &lt;- predict(model$fit, data, type = &quot;response&quot;)
  yTest &lt;- data$flag_ADR_TP_ID
  calperf &lt;- valProbggplot(pHat, yTest, smooth = &quot;none&quot;)

  tibble(
    site = data$site[1],
    n = nrow(data),
    cross_C_index = calperf$Cindex[[1]],
    cross_C_index_lower = calperf$Cindex[[2]],
    cross_C_index_upper = calperf$Cindex[[3]],
    cross_calibration_intercept = calperf$Calibration$Intercept[[1]],
    cross_calibration_intercept_lower = calperf$Calibration$Intercept[[2]],
    cross_calibration_intercept_upper = calperf$Calibration$Intercept[[3]],
    cross_calibration_slope = calperf$Calibration$Slope[[1]],
    cross_calibration_slope_lower = calperf$Calibration$Slope[[2]],
    cross_calibration_slope_upper = calperf$Calibration$Slope[[3]]
  )
}

plot_calibration_curve &lt;- function(sample, model) {
  data &lt;- assessment(sample)
  pHat &lt;- predict(model$fit, data, type = &quot;response&quot;)
  yTest &lt;- data$flag_ADR_TP_ID
  calperf &lt;- valProbggplot(pHat, yTest, logistic.cal = TRUE, lty.log = 2, col.log = &quot;blue&quot;, smooth = &quot;none&quot;)
  calperf$ggPlot + ggtitle(data$site[1])
}

# Fit model to each sample
# cross_full_HPM &lt;- map2(cross_samples$splits, cross_predict_HPM, fit_model_to_sample)
cross_full_BPM &lt;- map2(cross_samples$splits, cross_predict_BPM, fit_model_to_sample)

# cross_estimates_HPM &lt;- map2_dfr(cross_samples$splits, cross_full_HPM, calc_cross_performance)
cross_estimates_BPM &lt;- map2_dfr(cross_samples$splits, cross_full_BPM, calc_cross_performance)

# cross_plots_HPM &lt;- map2(cross_samples$splits, cross_full_HPM, plot_calibration_curve)
cross_plots_BPM &lt;- map2(cross_samples$splits, cross_full_BPM, plot_calibration_curve)
</code>
<sec id="nb-code-cell-2-output-0-nb-5" specific-use="notebook-output">
<preformat>Loading required package: future</preformat>
</sec>
<sec id="nb-code-cell-2-output-1-nb-5" specific-use="notebook-output">
<preformat>── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──</preformat>
</sec>
<sec id="nb-code-cell-2-output-2-nb-5" specific-use="notebook-output">
<preformat>✔ broom        1.0.5      ✔ recipes      1.0.10
✔ dials        1.2.1      ✔ tune         1.2.0 
✔ infer        1.0.6      ✔ workflows    1.1.4 
✔ modeldata    1.3.0      ✔ workflowsets 1.1.0 
✔ parsnip      1.2.0      </preformat>
</sec>
<sec id="nb-code-cell-2-output-3-nb-5" specific-use="notebook-output">
<preformat>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ scales::discard()    masks purrr::discard()
✖ dplyr::filter()      masks stats::filter()
✖ recipes::fixed()     masks stringr::fixed()
✖ dplyr::lag()         masks stats::lag()
✖ yardstick::spec()    masks readr::spec()
✖ Hmisc::src()         masks dplyr::src()
✖ recipes::step()      masks stats::step()
✖ Hmisc::summarize()   masks dplyr::summarize()
✖ parsnip::translate() masks Hmisc::translate()
• Search for functions across packages at https://www.tidymodels.org/find/</preformat>
</sec>
</sec>
<sec id="nb-code-cell-3-nb-5" specific-use="notebook-code">
<code language="r script"># cross_plots_HPM
</code>
</sec>
<sec id="nb-code-cell-4-nb-5" specific-use="notebook-code">
<code language="r script">cross_plots_BPM
</code>
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-4-1.png" />
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-4-2.png" />
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-4-3.png" />
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-4-4.png" />
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-4-5.png" />
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-4-6.png" />
<sec id="nb-code-cell-4-output-0-nb-5" specific-use="notebook-output">
<preformat>[[1]]</preformat>
</sec>
<sec id="nb-code-cell-4-output-1-nb-5" specific-use="notebook-output">
<preformat>
[[2]]</preformat>
</sec>
<sec id="nb-code-cell-4-output-2-nb-5" specific-use="notebook-output">
<preformat>
[[3]]</preformat>
</sec>
<sec id="nb-code-cell-4-output-3-nb-5" specific-use="notebook-output">
<preformat>
[[4]]</preformat>
</sec>
<sec id="nb-code-cell-4-output-4-nb-5" specific-use="notebook-output">
<preformat>
[[5]]</preformat>
</sec>
<sec id="nb-code-cell-4-output-5-nb-5" specific-use="notebook-output">
<preformat>
[[6]]</preformat>
</sec>
</sec>
<sec id="nb-code-cell-5-nb-5" specific-use="notebook-code">
<code language="r script">library(meta)
</code>
<code language="r script"># cross_C_index_meta_HPM &lt;- metagen(
#   data = cross_estimates_HPM,
#   studlab = site,
#   TE = cross_C_index,
#   lower = cross_C_index_lower,
#   upper = cross_C_index_upper,
#   sm = &quot;C_statistic&quot;,
#   common = FALSE,
#   random = TRUE,
#   method.tau = &quot;REML&quot;,
#   method.random.ci = &quot;HK&quot;,
#   adhoc.hakn.ci = &quot;IQWiG6&quot;,
# )

# forest_plot_C_index_HPM &lt;- forest(
#   cross_C_index_meta_HPM,
#   sortvar = studlab,
#   ref = NA,
#   xlim = c(0.6, 0.9),
#   layout = &quot;RevMan5&quot;
# )

# cross_calibration_intercept_meta_HPM &lt;- metagen(
#   data = cross_estimates_HPM,
#   studlab = site,
#   TE = cross_calibration_intercept,
#   lower = cross_calibration_intercept_lower,
#   upper = cross_calibration_intercept_upper,
#   sm = &quot;C_intercept&quot;,
#   common = FALSE,
#   random = TRUE,
#   method.tau = &quot;REML&quot;,
#   method.random.ci = &quot;HK&quot;,
#   adhoc.hakn.ci = &quot;IQWiG6&quot;,
#   null.effect = 0
# )

# forest_plot_calibration_intercept_HPM &lt;- forest(
#   cross_calibration_intercept_meta_HPM,
#   sortvar = studlab,
#   ref = 0,
#   xlim = c(-0.8, 0.8),
#   layout = &quot;RevMan5&quot;
# )

# cross_calibration_slope_meta_HPM &lt;- metagen(
#   data = cross_estimates_HPM,
#   studlab = site,
#   TE = cross_calibration_slope,
#   lower = cross_calibration_slope_lower,
#   upper = cross_calibration_slope_upper,
#   sm = &quot;C_slope&quot;,
#   common = FALSE,
#   random = TRUE,
#   method.tau = &quot;REML&quot;,
#   method.random.ci = &quot;HK&quot;,
#   adhoc.hakn.ci = &quot;IQWiG6&quot;,
#   null.effect = 1
# )

# forest_plot_calibration_slope_HPM &lt;- forest(
#   cross_calibration_slope_meta_HPM,
#   sortvar = studlab,
#   ref = 1,
#   xlim = c(0.2, 1.7),
#   layout = &quot;RevMan5&quot;
# )

# cross_meta_performance_HPM &lt;- tibble(
#   site = &quot;Total&quot;,
#   n = sum(cross_estimates_HPM$n),
#   cross_C_index = cross_C_index_meta_HPM$TE.random,
#   cross_C_index_lower = cross_C_index_meta_HPM$lower.random,
#   cross_C_index_upper = cross_C_index_meta_HPM$upper.random,
#   cross_calibration_intercept = cross_calibration_intercept_meta_HPM$TE.random,
#   cross_calibration_intercept_lower = cross_calibration_intercept_meta_HPM$lower.random,
#   cross_calibration_intercept_upper = cross_calibration_intercept_meta_HPM$upper.random,
#   cross_calibration_slope = cross_calibration_slope_meta_HPM$TE.random,
#   cross_calibration_slope_lower = cross_calibration_slope_meta_HPM$lower.random,
#   cross_calibration_slope_upper = cross_calibration_slope_meta_HPM$upper.random
# )

# cross_performance_metrics_HPM &lt;- bind_rows(cross_estimates_HPM, cross_meta_performance_HPM)
</code>
<sec id="nb-code-cell-5-output-0-nb-5" specific-use="notebook-output">
<preformat>Loading required package: metadat</preformat>
</sec>
<sec id="nb-code-cell-5-output-1-nb-5" specific-use="notebook-output">
<preformat>Loading 'meta' package (version 7.0-0).
Type 'help(meta)' for a brief overview.
Readers of 'Meta-Analysis with R (Use R!)' should install
older version of 'meta' package: https://tinyurl.com/dt4y5drs</preformat>
</sec>
</sec>
<sec id="nb-code-cell-6-nb-5" specific-use="notebook-code">
<code language="r script">library(meta)

cross_C_index_meta_BPM &lt;- metagen(
  data = cross_estimates_BPM,
  studlab = site,
  TE = cross_C_index,
  lower = cross_C_index_lower,
  upper = cross_C_index_upper,
  sm = &quot;C_statistic&quot;,
  common = FALSE,
  random = TRUE,
  method.tau = &quot;REML&quot;,
  method.random.ci = &quot;HK&quot;,
  adhoc.hakn.ci = &quot;IQWiG6&quot;,
)

forest_plot_C_index_BPM &lt;- forest(
  cross_C_index_meta_BPM,
  sortvar = studlab,
  ref = NA,
  xlim = c(0.6, 0.9),
  layout = &quot;RevMan5&quot;
)
</code>
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-6-1.png" />
<code language="r script">cross_calibration_intercept_meta_BPM &lt;- metagen(
  data = cross_estimates_BPM,
  studlab = site,
  TE = cross_calibration_intercept,
  lower = cross_calibration_intercept_lower,
  upper = cross_calibration_intercept_upper,
  sm = &quot;C_intercept&quot;,
  common = FALSE,
  random = TRUE,
  method.tau = &quot;REML&quot;,
  method.random.ci = &quot;HK&quot;,
  adhoc.hakn.ci = &quot;IQWiG6&quot;,
  null.effect = 0
)

forest_plot_calibration_intercept_BPM &lt;- forest(
  cross_calibration_intercept_meta_BPM,
  sortvar = studlab,
  ref = 0,
  xlim = c(-0.8, 0.8),
  layout = &quot;RevMan5&quot;
)
</code>
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-6-2.png" />
<code language="r script">cross_calibration_slope_meta_BPM &lt;- metagen(
  data = cross_estimates_BPM,
  studlab = site,
  TE = cross_calibration_slope,
  lower = cross_calibration_slope_lower,
  upper = cross_calibration_slope_upper,
  sm = &quot;C_slope&quot;,
  common = FALSE,
  random = TRUE,
  method.tau = &quot;REML&quot;,
  method.random.ci = &quot;HK&quot;,
  adhoc.hakn.ci = &quot;IQWiG6&quot;,
  null.effect = 1
)

forest_plot_calibration_slope_BPM &lt;- forest(
  cross_calibration_slope_meta_BPM,
  sortvar = studlab,
  ref = 1,
  xlim = c(0.2, 1.7),
  layout = &quot;RevMan5&quot;
)
</code>
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-6-3.png" />
<code language="r script">cross_meta_performance_BPM &lt;- tibble(
  site = &quot;Total&quot;,
  n = sum(cross_estimates_BPM$n),
  cross_C_index = cross_C_index_meta_BPM$TE.random,
  cross_C_index_lower = cross_C_index_meta_BPM$lower.random,
  cross_C_index_upper = cross_C_index_meta_BPM$upper.random,
  cross_calibration_intercept = cross_calibration_intercept_meta_BPM$TE.random,
  cross_calibration_intercept_lower = cross_calibration_intercept_meta_BPM$lower.random,
  cross_calibration_intercept_upper = cross_calibration_intercept_meta_BPM$upper.random,
  cross_calibration_slope = cross_calibration_slope_meta_BPM$TE.random,
  cross_calibration_slope_lower = cross_calibration_slope_meta_BPM$lower.random,
  cross_calibration_slope_upper = cross_calibration_slope_meta_BPM$upper.random
)

cross_performance_metrics_BPM &lt;- bind_rows(cross_estimates_BPM, cross_meta_performance_BPM)
</code>
</sec>
<sec id="nb-code-cell-7-nb-5" specific-use="notebook-code">
<code language="r script"># save(cross_performance_metrics_HPM, file = &quot;data/model-performance/cross-performance-metrics-HPM.rda&quot;)
save(cross_performance_metrics_BPM, file = &quot;data/model-performance/cross-performance-metrics-BPM.rda&quot;)
</code>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-24-nb-6">
<front-stub>
<title-group>
<article-title>Risk Score System and Algorithm</article-title>
</title-group>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-6" specific-use="notebook-code">
<code language="r script">source(&quot;notebooks/initialize-data-analysis.r&quot;)
</code>
<code language="r script">load(&quot;data/model-performance/model-full-BPM-1-A.rda&quot;)

load(&quot;data/results/variables-to-screen.rda&quot;)
load(&quot;data/results/variables-to-screen-short.rda&quot;)
load(&quot;data/results/variables-to-screen-short-binary.rda&quot;)
</code>
<sec id="nb-code-cell-1-output-0-nb-6" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
</sec>
<sec id="nb-code-cell-2-nb-6" specific-use="notebook-code">
<code language="r script">library(tidyverse)
library(tidymodels)
</code>
<code language="r script">model_beta_estimates &lt;- model_full_BPM |&gt;
  tidy() |&gt;
  select(term, estimate, p.value)

model_odds_ratios &lt;- model_full_BPM |&gt;
  tidy(conf.int = TRUE, exponentiate = TRUE) |&gt;
  select(term, estimate, conf.low, conf.high) |&gt;
  filter(term != &quot;(Intercept)&quot;) |&gt;
  rename(odds_ratio = estimate, OR_lower = conf.low, OR_upper = conf.high)

predictor_list_with_intercept &lt;- c(variables_to_screen, &quot;(Intercept)&quot;)

parameter_estimates &lt;- left_join(model_beta_estimates, model_odds_ratios, by = &quot;term&quot;) |&gt;
  rename(risk_factor = term, beta = estimate, p_value = p.value) |&gt;
  mutate(risk_factor = str_extract(risk_factor, paste(predictor_list_with_intercept, collapse = &quot;|&quot;)))

# parameter_estimates |&gt; 
#   mutate(raw_score = beta / min(abs(beta)))
</code>
<sec id="nb-code-cell-2-output-0-nb-6" specific-use="notebook-output">
<preformat>── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──</preformat>
</sec>
<sec id="nb-code-cell-2-output-1-nb-6" specific-use="notebook-output">
<preformat>✔ broom        1.0.5      ✔ rsample      1.2.0 
✔ dials        1.2.1      ✔ tune         1.2.0 
✔ infer        1.0.6      ✔ workflows    1.1.4 
✔ modeldata    1.3.0      ✔ workflowsets 1.1.0 
✔ parsnip      1.2.0      ✔ yardstick    1.3.0 
✔ recipes      1.0.10     </preformat>
</sec>
<sec id="nb-code-cell-2-output-2-nb-6" specific-use="notebook-output">
<preformat>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ scales::discard() masks purrr::discard()
✖ dplyr::filter()   masks stats::filter()
✖ recipes::fixed()  masks stringr::fixed()
✖ dplyr::lag()      masks stats::lag()
✖ yardstick::spec() masks readr::spec()
✖ recipes::step()   masks stats::step()
• Dig deeper into tidy modeling with R at https://www.tmwr.org</preformat>
</sec>
</sec>
<sec id="nb-code-cell-3-nb-6" specific-use="notebook-code">
<code language="r script">data_refit &lt;- model_full_BPM |&gt;
  extract_mold() |&gt;
  _$predictors |&gt;
  mutate(across(where(is.numeric), ~ . / 10)) |&gt;
  rename_with(~ paste0(., &quot;_per_10&quot;), .cols = where(is.numeric)) |&gt;
  bind_cols(model_full_BPM |&gt; extract_mold() |&gt; _$outcomes)

model_refit &lt;- workflow() |&gt;
  add_variables(outcomes = &quot;flag_ADR_TP_ID&quot;, predictors = everything()) |&gt;
  add_model(logistic_reg()) |&gt;
  fit(data = data_refit)

model_refit_odds_ratios &lt;- model_refit |&gt;
  tidy(conf.int = TRUE, exponentiate = TRUE) |&gt;
  select(term, estimate, conf.low, conf.high) |&gt;
  filter(term != &quot;(Intercept)&quot;) |&gt;
  rename(odds_ratio = estimate, OR_lower = conf.low, OR_upper = conf.high) |&gt;
  mutate(term = str_replace_all(term, &quot;TRUE&quot;, &quot;&quot;))

model_full_BPM |&gt;
  extract_mold() |&gt;
  _$predictors |&gt; pull(baseline_PLT) |&gt; quantile(c(0, 0.01, 0.99, 1), na.rm = TRUE)
</code>
<sec id="nb-code-cell-3-output-0-nb-6" specific-use="notebook-output">
<preformat>  0%   1%  99% 100% 
   3   18  434  450 </preformat>
</sec>
</sec>
<sec id="risk-score-system-nb-6">
  <title>Risk Score System</title>
  <p>All code below is not automatic. Variables and ranges are manually
  defined.</p>
  <p>Current model predictors: <monospace>patient_age</monospace>,
  <monospace>baseline_CLCR</monospace>,
  <monospace>baseline_PLT</monospace>,
  <monospace>LZD_duration</monospace>,
  <monospace>comed_heparin</monospace>,
  <monospace>infect_sepsis</monospace>,
  <monospace>comorb_cirr</monospace></p>
  <sec id="nb-code-cell-4-nb-6" specific-use="notebook-code">
  <code language="r script">risk_profile_1 &lt;- tibble(
  risk_factor = &quot;patient_age&quot;,
  min_range = c(18, 30, 40, 50, 60, 70, 80, 90), # minimum age is 18
  max_range = lead(min_range, default = 101), # maximum age is 101, interval is 10
  reference = (min_range + max_range) / 2,
  flag_base_risk = FALSE
) |&gt;
  mutate(
    flag_base_risk = replace(flag_base_risk, 1, TRUE)
  )

risk_profile_2 &lt;- tibble(
  risk_factor = &quot;baseline_CLCR&quot;,
  min_range = c(130, 90, 60, 30, 5), # 1% percentile is 5
  max_range = lag(min_range, default = 191), # 99% percentile is 191
  reference = (min_range + max_range) / 2,
  flag_base_risk = FALSE
) |&gt;
  mutate(
    min_range = replace(min_range, n(), -Inf),
    max_range = replace(max_range, 1, Inf),
    flag_base_risk = ifelse(min_range == 90, TRUE, flag_base_risk)
  )

risk_profile_3 &lt;- tibble(
  risk_factor = &quot;baseline_PLT&quot;,
  min_range = c(150, 75, 50, 25, 18), # 1% percentile is 18
  max_range = lag(min_range, default = 434), # 99% percentile is 434
  reference = (min_range + max_range) / 2,
  flag_base_risk = FALSE
) |&gt;
  mutate(
    min_range = replace(min_range, n(), -Inf),
    max_range = replace(max_range, 1, Inf),
    flag_base_risk = replace(flag_base_risk, 1, TRUE)
  )

risk_profile_4 &lt;- tibble(
  risk_factor = &quot;LZD_duration_14&quot;,
  min_range = c(0, 1), # 0 or 1
  max_range = c(0, 1), # 0 or 1
  reference = c(0, 1),
  flag_base_risk = FALSE
) |&gt;
  mutate(
    flag_base_risk = replace(flag_base_risk, 1, TRUE)
  )

risk_profile_5 &lt;- tibble(
  risk_factor = &quot;comed_heparin&quot;,
  min_range = c(0, 1), # 0 or 1
  max_range = c(0, 1), # 0 or 1
  reference = c(0, 1),
  flag_base_risk = FALSE
) |&gt;
  mutate(
    flag_base_risk = replace(flag_base_risk, 1, TRUE)
  )

risk_profile_6 &lt;- tibble(
  risk_factor = &quot;infect_sepsis&quot;,
  min_range = c(0, 1), # 0 or 1
  max_range = c(0, 1), # 0 or 1
  reference = c(0, 1),
  flag_base_risk = FALSE
) |&gt;
  mutate(
    flag_base_risk = replace(flag_base_risk, 1, TRUE)
  )

risk_profile_7 &lt;- tibble(
  risk_factor = &quot;comorb_cirr&quot;,
  min_range = c(0, 1), # 0 or 1
  max_range = c(0, 1), # 0 or 1
  reference = c(0, 1),
  flag_base_risk = FALSE
) |&gt;
  mutate(
    flag_base_risk = replace(flag_base_risk, 1, TRUE)
  )

risk_profile &lt;- bind_rows(risk_profile_1, risk_profile_2, risk_profile_3, risk_profile_4, risk_profile_5, risk_profile_6, risk_profile_7)
  </code>
  </sec>
  <sec id="nb-code-cell-5-nb-6" specific-use="notebook-code">
  <code language="r script">B_constant &lt;- parameter_estimates |&gt;
  filter(risk_factor == &quot;patient_age&quot;) |&gt;
  pull(beta) * 10 # constant equivalent to 10-year increase in age

points_system_full &lt;- parameter_estimates |&gt;
  select(risk_factor, beta) |&gt;
  right_join(risk_profile, by = &quot;risk_factor&quot;) |&gt;
  group_by(risk_factor) |&gt;
  mutate(
    beta_sum = beta * (reference - reference[which.max(flag_base_risk)]),
    points = round(beta_sum / B_constant, 0)
  )

points_system_factors &lt;- points_system_full |&gt;
  select(risk_factor, min_range, max_range, points)

min_points &lt;- points_system_full |&gt;
  group_by(risk_factor) |&gt;
  summarise(min_points = min(points)) |&gt;
  summarise(total_min_points = sum(min_points)) |&gt;
  pull(total_min_points)

max_points &lt;- points_system_full |&gt;
  group_by(risk_factor) |&gt;
  summarise(max_points = max(points)) |&gt;
  summarise(total_max_points = sum(max_points)) |&gt;
  pull(total_max_points)

risk_function &lt;- function(points) {
  intercept &lt;- parameter_estimates |&gt;
    filter(risk_factor == &quot;Intercept&quot;) |&gt;
    pull(beta)

  beta_base &lt;- points_system_full |&gt;
    filter(flag_base_risk == TRUE) |&gt;
    ungroup() |&gt;
    summarise(
      beta_base = sum(beta * reference)
    ) |&gt;
    pull(beta_base)

  1 / (1 + exp(-(intercept + beta_base + B_constant * points)))
}

points_system_risks &lt;- tibble(
  points_total = seq(min_points, max_points),
  risk_estimate = risk_function(points_total)
)
  </code>
  </sec>
  <sec id="nb-code-cell-6-nb-6" specific-use="notebook-code">
  <code language="r script">library(probably)
  </code>
  <code language="r script">predictive_values &lt;- model_refit |&gt;
  predict(data_refit, type = &quot;prob&quot;) |&gt;
  mutate(flag_ADR_TP_ID = data_refit$flag_ADR_TP_ID) |&gt;
  threshold_perf(
    truth = flag_ADR_TP_ID,
    estimate = .pred_FALSE,
    thresholds = points_system_risks |&gt; pull(risk_estimate),
    metrics = metric_set(sensitivity, specificity, ppv, npv, j_index)
  ) |&gt;
  select(-.estimator) |&gt;
  pivot_wider(names_from = .metric, values_from = .estimate) |&gt;
  mutate(score = points_system_risks |&gt; pull(points_total))

predictive_values |&gt;
  select(.threshold, sensitivity, specificity) |&gt;
  ggplot(aes(x = 1 - specificity, y = sensitivity)) +
  geom_point() +
  geom_path() +
  geom_segment(
    x = 1 - (predictive_values |&gt; filter(j_index == max(j_index)) |&gt; pull(specificity)),
    xend = 1 - (predictive_values |&gt; filter(j_index == max(j_index)) |&gt; pull(specificity)),
    y = 1 - (predictive_values |&gt; filter(j_index == max(j_index)) |&gt; pull(specificity)),
    yend = predictive_values |&gt; filter(j_index == max(j_index)) |&gt; pull(sensitivity),
    linetype = 2
  ) +
  geom_abline(lty = 3) +
  coord_equal() +
  theme_bw()
  </code>
  <graphic mimetype="image" mime-subtype="png" xlink:href="05-risk-score_files/figure-jats/unnamed-chunk-6-1.png" />
  <sec id="nb-code-cell-6-output-0-nb-6" specific-use="notebook-output">
  <preformat>
Attaching package: 'probably'</preformat>
  </sec>
  <sec id="nb-code-cell-6-output-1-nb-6" specific-use="notebook-output">
  <preformat>The following objects are masked from 'package:base':

    as.factor, as.ordered</preformat>
  </sec>
  </sec>
  <sec id="nb-code-cell-7-nb-6" specific-use="notebook-code">
  <code language="r script">predictive_values |&gt; knitr::kable()
  </code>
  <table-wrap>
    <table>
      <colgroup>
        <col width="15%" />
        <col width="17%" />
        <col width="17%" />
        <col width="14%" />
        <col width="14%" />
        <col width="14%" />
        <col width="8%" />
      </colgroup>
      <thead>
        <tr>
          <th align="right">.threshold</th>
          <th align="right">sensitivity</th>
          <th align="right">specificity</th>
          <th align="right">ppv</th>
          <th align="right">npv</th>
          <th align="right">j_index</th>
          <th align="right">score</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="right">0.0271019</td>
          <td align="right">1.0000000</td>
          <td align="right">0.0000000</td>
          <td align="right">0.6817010</td>
          <td align="right">NaN</td>
          <td align="right">0.0000000</td>
          <td align="right">-2</td>
        </tr>
        <tr>
          <td align="right">0.0322229</td>
          <td align="right">1.0000000</td>
          <td align="right">0.0000000</td>
          <td align="right">0.6817010</td>
          <td align="right">NaN</td>
          <td align="right">0.0000000</td>
          <td align="right">-1</td>
        </tr>
        <tr>
          <td align="right">0.0382735</td>
          <td align="right">1.0000000</td>
          <td align="right">0.0000000</td>
          <td align="right">0.6817010</td>
          <td align="right">NaN</td>
          <td align="right">0.0000000</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="right">0.0454069</td>
          <td align="right">1.0000000</td>
          <td align="right">0.0000000</td>
          <td align="right">0.6817010</td>
          <td align="right">NaN</td>
          <td align="right">0.0000000</td>
          <td align="right">1</td>
        </tr>
        <tr>
          <td align="right">0.0537955</td>
          <td align="right">1.0000000</td>
          <td align="right">0.0000000</td>
          <td align="right">0.6817010</td>
          <td align="right">NaN</td>
          <td align="right">0.0000000</td>
          <td align="right">2</td>
        </tr>
        <tr>
          <td align="right">0.0636306</td>
          <td align="right">1.0000000</td>
          <td align="right">0.0000000</td>
          <td align="right">0.6817010</td>
          <td align="right">NaN</td>
          <td align="right">0.0000000</td>
          <td align="right">3</td>
        </tr>
        <tr>
          <td align="right">0.0751209</td>
          <td align="right">1.0000000</td>
          <td align="right">0.0040486</td>
          <td align="right">0.6825806</td>
          <td align="right">1.0000000</td>
          <td align="right">0.0040486</td>
          <td align="right">4</td>
        </tr>
        <tr>
          <td align="right">0.0884901</td>
          <td align="right">1.0000000</td>
          <td align="right">0.0080972</td>
          <td align="right">0.6834625</td>
          <td align="right">1.0000000</td>
          <td align="right">0.0080972</td>
          <td align="right">5</td>
        </tr>
        <tr>
          <td align="right">0.1039711</td>
          <td align="right">1.0000000</td>
          <td align="right">0.0161943</td>
          <td align="right">0.6852332</td>
          <td align="right">1.0000000</td>
          <td align="right">0.0161943</td>
          <td align="right">6</td>
        </tr>
        <tr>
          <td align="right">0.1217985</td>
          <td align="right">0.9981096</td>
          <td align="right">0.0283401</td>
          <td align="right">0.6875000</td>
          <td align="right">0.8750000</td>
          <td align="right">0.0264497</td>
          <td align="right">7</td>
        </tr>
        <tr>
          <td align="right">0.1421976</td>
          <td align="right">0.9981096</td>
          <td align="right">0.0323887</td>
          <td align="right">0.6883963</td>
          <td align="right">0.8888889</td>
          <td align="right">0.0304983</td>
          <td align="right">8</td>
        </tr>
        <tr>
          <td align="right">0.1653698</td>
          <td align="right">0.9962193</td>
          <td align="right">0.0445344</td>
          <td align="right">0.6906946</td>
          <td align="right">0.8461538</td>
          <td align="right">0.0407537</td>
          <td align="right">9</td>
        </tr>
        <tr>
          <td align="right">0.1914753</td>
          <td align="right">0.9943289</td>
          <td align="right">0.0809717</td>
          <td align="right">0.6985392</td>
          <td align="right">0.8695652</td>
          <td align="right">0.0753006</td>
          <td align="right">10</td>
        </tr>
        <tr>
          <td align="right">0.2206125</td>
          <td align="right">0.9886578</td>
          <td align="right">0.1093117</td>
          <td align="right">0.7039031</td>
          <td align="right">0.8181818</td>
          <td align="right">0.0979696</td>
          <td align="right">11</td>
        </tr>
        <tr>
          <td align="right">0.2527973</td>
          <td align="right">0.9792060</td>
          <td align="right">0.1497976</td>
          <td align="right">0.7115385</td>
          <td align="right">0.7708333</td>
          <td align="right">0.1290036</td>
          <td align="right">12</td>
        </tr>
        <tr>
          <td align="right">0.2879428</td>
          <td align="right">0.9678639</td>
          <td align="right">0.1862348</td>
          <td align="right">0.7180926</td>
          <td align="right">0.7301587</td>
          <td align="right">0.1540987</td>
          <td align="right">13</td>
        </tr>
        <tr>
          <td align="right">0.3258436</td>
          <td align="right">0.9603025</td>
          <td align="right">0.2307692</td>
          <td align="right">0.7277937</td>
          <td align="right">0.7307692</td>
          <td align="right">0.1910717</td>
          <td align="right">14</td>
        </tr>
        <tr>
          <td align="right">0.3661678</td>
          <td align="right">0.9546314</td>
          <td align="right">0.2550607</td>
          <td align="right">0.7329463</td>
          <td align="right">0.7241379</td>
          <td align="right">0.2096921</td>
          <td align="right">15</td>
        </tr>
        <tr>
          <td align="right">0.4084588</td>
          <td align="right">0.9357278</td>
          <td align="right">0.3157895</td>
          <td align="right">0.7454819</td>
          <td align="right">0.6964286</td>
          <td align="right">0.2515173</td>
          <td align="right">16</td>
        </tr>
        <tr>
          <td align="right">0.4521498</td>
          <td align="right">0.9130435</td>
          <td align="right">0.3765182</td>
          <td align="right">0.7582418</td>
          <td align="right">0.6690647</td>
          <td align="right">0.2895617</td>
          <td align="right">17</td>
        </tr>
        <tr>
          <td align="right">0.4965909</td>
          <td align="right">0.8884688</td>
          <td align="right">0.4251012</td>
          <td align="right">0.7679739</td>
          <td align="right">0.6402439</td>
          <td align="right">0.3135700</td>
          <td align="right">18</td>
        </tr>
        <tr>
          <td align="right">0.5410860</td>
          <td align="right">0.8657845</td>
          <td align="right">0.4979757</td>
          <td align="right">0.7869416</td>
          <td align="right">0.6340206</td>
          <td align="right">0.3637602</td>
          <td align="right">19</td>
        </tr>
        <tr>
          <td align="right">0.5849354</td>
          <td align="right">0.8317580</td>
          <td align="right">0.5829960</td>
          <td align="right">0.8103131</td>
          <td align="right">0.6180258</td>
          <td align="right">0.4147540</td>
          <td align="right">20</td>
        </tr>
        <tr>
          <td align="right">0.6274796</td>
          <td align="right">0.7863894</td>
          <td align="right">0.6477733</td>
          <td align="right">0.8270378</td>
          <td align="right">0.5860806</td>
          <td align="right">0.4341627</td>
          <td align="right">21</td>
        </tr>
        <tr>
          <td align="right">0.6681371</td>
          <td align="right">0.7258979</td>
          <td align="right">0.7085020</td>
          <td align="right">0.8421053</td>
          <td align="right">0.5468750</td>
          <td align="right">0.4343999</td>
          <td align="right">22</td>
        </tr>
        <tr>
          <td align="right">0.7064332</td>
          <td align="right">0.6880907</td>
          <td align="right">0.7570850</td>
          <td align="right">0.8584906</td>
          <td align="right">0.5312500</td>
          <td align="right">0.4451758</td>
          <td align="right">23</td>
        </tr>
        <tr>
          <td align="right">0.7420164</td>
          <td align="right">0.6275992</td>
          <td align="right">0.8056680</td>
          <td align="right">0.8736842</td>
          <td align="right">0.5025253</td>
          <td align="right">0.4332673</td>
          <td align="right">24</td>
        </tr>
        <tr>
          <td align="right">0.7746623</td>
          <td align="right">0.5576560</td>
          <td align="right">0.8582996</td>
          <td align="right">0.8939394</td>
          <td align="right">0.4753363</td>
          <td align="right">0.4159555</td>
          <td align="right">25</td>
        </tr>
        <tr>
          <td align="right">0.8042669</td>
          <td align="right">0.4896030</td>
          <td align="right">0.8947368</td>
          <td align="right">0.9087719</td>
          <td align="right">0.4501018</td>
          <td align="right">0.3843399</td>
          <td align="right">26</td>
        </tr>
        <tr>
          <td align="right">0.8308314</td>
          <td align="right">0.4423440</td>
          <td align="right">0.9230769</td>
          <td align="right">0.9249012</td>
          <td align="right">0.4359465</td>
          <td align="right">0.3654210</td>
          <td align="right">27</td>
        </tr>
        <tr>
          <td align="right">0.8544431</td>
          <td align="right">0.3818526</td>
          <td align="right">0.9433198</td>
          <td align="right">0.9351852</td>
          <td align="right">0.4160714</td>
          <td align="right">0.3251724</td>
          <td align="right">28</td>
        </tr>
        <tr>
          <td align="right">0.8752541</td>
          <td align="right">0.3213611</td>
          <td align="right">0.9595142</td>
          <td align="right">0.9444444</td>
          <td align="right">0.3976510</td>
          <td align="right">0.2808752</td>
          <td align="right">29</td>
        </tr>
        <tr>
          <td align="right">0.8934606</td>
          <td align="right">0.2627599</td>
          <td align="right">0.9716599</td>
          <td align="right">0.9520548</td>
          <td align="right">0.3809524</td>
          <td align="right">0.2344198</td>
          <td align="right">30</td>
        </tr>
        <tr>
          <td align="right">0.9092853</td>
          <td align="right">0.2192817</td>
          <td align="right">0.9797571</td>
          <td align="right">0.9586777</td>
          <td align="right">0.3694656</td>
          <td align="right">0.1990387</td>
          <td align="right">31</td>
        </tr>
        <tr>
          <td align="right">0.9229621</td>
          <td align="right">0.1720227</td>
          <td align="right">0.9878543</td>
          <td align="right">0.9680851</td>
          <td align="right">0.3577713</td>
          <td align="right">0.1598769</td>
          <td align="right">32</td>
        </tr>
        <tr>
          <td align="right">0.9347250</td>
          <td align="right">0.1436673</td>
          <td align="right">0.9919028</td>
          <td align="right">0.9743590</td>
          <td align="right">0.3510029</td>
          <td align="right">0.1355701</td>
          <td align="right">33</td>
        </tr>
        <tr>
          <td align="right">0.9447992</td>
          <td align="right">0.1096408</td>
          <td align="right">0.9919028</td>
          <td align="right">0.9666667</td>
          <td align="right">0.3421788</td>
          <td align="right">0.1015437</td>
          <td align="right">34</td>
        </tr>
        <tr>
          <td align="right">0.9533961</td>
          <td align="right">0.0850662</td>
          <td align="right">0.9959514</td>
          <td align="right">0.9782609</td>
          <td align="right">0.3369863</td>
          <td align="right">0.0810176</td>
          <td align="right">35</td>
        </tr>
        <tr>
          <td align="right">0.9607099</td>
          <td align="right">0.0661626</td>
          <td align="right">0.9959514</td>
          <td align="right">0.9722222</td>
          <td align="right">0.3324324</td>
          <td align="right">0.0621140</td>
          <td align="right">36</td>
        </tr>
        <tr>
          <td align="right">0.9669157</td>
          <td align="right">0.0453686</td>
          <td align="right">0.9959514</td>
          <td align="right">0.9600000</td>
          <td align="right">0.3275632</td>
          <td align="right">0.0413200</td>
          <td align="right">37</td>
        </tr>
        <tr>
          <td align="right">0.9721696</td>
          <td align="right">0.0359168</td>
          <td align="right">1.0000000</td>
          <td align="right">1.0000000</td>
          <td align="right">0.3262880</td>
          <td align="right">0.0359168</td>
          <td align="right">38</td>
        </tr>
        <tr>
          <td align="right">0.9766095</td>
          <td align="right">0.0264650</td>
          <td align="right">1.0000000</td>
          <td align="right">1.0000000</td>
          <td align="right">0.3241470</td>
          <td align="right">0.0264650</td>
          <td align="right">39</td>
        </tr>
        <tr>
          <td align="right">0.9803553</td>
          <td align="right">0.0189036</td>
          <td align="right">1.0000000</td>
          <td align="right">1.0000000</td>
          <td align="right">0.3224543</td>
          <td align="right">0.0189036</td>
          <td align="right">40</td>
        </tr>
        <tr>
          <td align="right">0.9835114</td>
          <td align="right">0.0132325</td>
          <td align="right">1.0000000</td>
          <td align="right">1.0000000</td>
          <td align="right">0.3211964</td>
          <td align="right">0.0132325</td>
          <td align="right">41</td>
        </tr>
        <tr>
          <td align="right">0.9861676</td>
          <td align="right">0.0075614</td>
          <td align="right">1.0000000</td>
          <td align="right">1.0000000</td>
          <td align="right">0.3199482</td>
          <td align="right">0.0075614</td>
          <td align="right">42</td>
        </tr>
        <tr>
          <td align="right">0.9884009</td>
          <td align="right">0.0037807</td>
          <td align="right">1.0000000</td>
          <td align="right">1.0000000</td>
          <td align="right">0.3191214</td>
          <td align="right">0.0037807</td>
          <td align="right">43</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <code language="r script">points_system_factors |&gt; knitr::kable()
  </code>
  <table-wrap>
    <table>
      <thead>
        <tr>
          <th align="left">risk_factor</th>
          <th align="right">min_range</th>
          <th align="right">max_range</th>
          <th align="right">points</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left">LZD_duration_14</td>
          <td align="right">0</td>
          <td align="right">0</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="left">LZD_duration_14</td>
          <td align="right">1</td>
          <td align="right">1</td>
          <td align="right">6</td>
        </tr>
        <tr>
          <td align="left">comed_heparin</td>
          <td align="right">0</td>
          <td align="right">0</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="left">comed_heparin</td>
          <td align="right">1</td>
          <td align="right">1</td>
          <td align="right">6</td>
        </tr>
        <tr>
          <td align="left">infect_sepsis</td>
          <td align="right">0</td>
          <td align="right">0</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="left">infect_sepsis</td>
          <td align="right">1</td>
          <td align="right">1</td>
          <td align="right">4</td>
        </tr>
        <tr>
          <td align="left">baseline_CLCR</td>
          <td align="right">130</td>
          <td align="right">Inf</td>
          <td align="right">-2</td>
        </tr>
        <tr>
          <td align="left">baseline_CLCR</td>
          <td align="right">90</td>
          <td align="right">130</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="left">baseline_CLCR</td>
          <td align="right">60</td>
          <td align="right">90</td>
          <td align="right">1</td>
        </tr>
        <tr>
          <td align="left">baseline_CLCR</td>
          <td align="right">30</td>
          <td align="right">60</td>
          <td align="right">2</td>
        </tr>
        <tr>
          <td align="left">baseline_CLCR</td>
          <td align="right">-Inf</td>
          <td align="right">30</td>
          <td align="right">3</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">18</td>
          <td align="right">30</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">30</td>
          <td align="right">40</td>
          <td align="right">1</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">40</td>
          <td align="right">50</td>
          <td align="right">2</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">50</td>
          <td align="right">60</td>
          <td align="right">3</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">60</td>
          <td align="right">70</td>
          <td align="right">4</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">70</td>
          <td align="right">80</td>
          <td align="right">5</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">80</td>
          <td align="right">90</td>
          <td align="right">6</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">90</td>
          <td align="right">101</td>
          <td align="right">7</td>
        </tr>
        <tr>
          <td align="left">baseline_PLT</td>
          <td align="right">150</td>
          <td align="right">Inf</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="left">baseline_PLT</td>
          <td align="right">75</td>
          <td align="right">150</td>
          <td align="right">8</td>
        </tr>
        <tr>
          <td align="left">baseline_PLT</td>
          <td align="right">50</td>
          <td align="right">75</td>
          <td align="right">11</td>
        </tr>
        <tr>
          <td align="left">baseline_PLT</td>
          <td align="right">25</td>
          <td align="right">50</td>
          <td align="right">12</td>
        </tr>
        <tr>
          <td align="left">baseline_PLT</td>
          <td align="right">-Inf</td>
          <td align="right">25</td>
          <td align="right">12</td>
        </tr>
        <tr>
          <td align="left">comorb_cirr</td>
          <td align="right">0</td>
          <td align="right">0</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="left">comorb_cirr</td>
          <td align="right">1</td>
          <td align="right">1</td>
          <td align="right">5</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <code language="r script">points_system_risks |&gt; knitr::kable()
  </code>
  <table-wrap>
    <table>
      <thead>
        <tr>
          <th align="right">points_total</th>
          <th align="right">risk_estimate</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="right">-2</td>
          <td align="right">0.0271019</td>
        </tr>
        <tr>
          <td align="right">-1</td>
          <td align="right">0.0322229</td>
        </tr>
        <tr>
          <td align="right">0</td>
          <td align="right">0.0382735</td>
        </tr>
        <tr>
          <td align="right">1</td>
          <td align="right">0.0454069</td>
        </tr>
        <tr>
          <td align="right">2</td>
          <td align="right">0.0537955</td>
        </tr>
        <tr>
          <td align="right">3</td>
          <td align="right">0.0636306</td>
        </tr>
        <tr>
          <td align="right">4</td>
          <td align="right">0.0751209</td>
        </tr>
        <tr>
          <td align="right">5</td>
          <td align="right">0.0884901</td>
        </tr>
        <tr>
          <td align="right">6</td>
          <td align="right">0.1039711</td>
        </tr>
        <tr>
          <td align="right">7</td>
          <td align="right">0.1217985</td>
        </tr>
        <tr>
          <td align="right">8</td>
          <td align="right">0.1421976</td>
        </tr>
        <tr>
          <td align="right">9</td>
          <td align="right">0.1653698</td>
        </tr>
        <tr>
          <td align="right">10</td>
          <td align="right">0.1914753</td>
        </tr>
        <tr>
          <td align="right">11</td>
          <td align="right">0.2206125</td>
        </tr>
        <tr>
          <td align="right">12</td>
          <td align="right">0.2527973</td>
        </tr>
        <tr>
          <td align="right">13</td>
          <td align="right">0.2879428</td>
        </tr>
        <tr>
          <td align="right">14</td>
          <td align="right">0.3258436</td>
        </tr>
        <tr>
          <td align="right">15</td>
          <td align="right">0.3661678</td>
        </tr>
        <tr>
          <td align="right">16</td>
          <td align="right">0.4084588</td>
        </tr>
        <tr>
          <td align="right">17</td>
          <td align="right">0.4521498</td>
        </tr>
        <tr>
          <td align="right">18</td>
          <td align="right">0.4965909</td>
        </tr>
        <tr>
          <td align="right">19</td>
          <td align="right">0.5410860</td>
        </tr>
        <tr>
          <td align="right">20</td>
          <td align="right">0.5849354</td>
        </tr>
        <tr>
          <td align="right">21</td>
          <td align="right">0.6274796</td>
        </tr>
        <tr>
          <td align="right">22</td>
          <td align="right">0.6681371</td>
        </tr>
        <tr>
          <td align="right">23</td>
          <td align="right">0.7064332</td>
        </tr>
        <tr>
          <td align="right">24</td>
          <td align="right">0.7420164</td>
        </tr>
        <tr>
          <td align="right">25</td>
          <td align="right">0.7746623</td>
        </tr>
        <tr>
          <td align="right">26</td>
          <td align="right">0.8042669</td>
        </tr>
        <tr>
          <td align="right">27</td>
          <td align="right">0.8308314</td>
        </tr>
        <tr>
          <td align="right">28</td>
          <td align="right">0.8544431</td>
        </tr>
        <tr>
          <td align="right">29</td>
          <td align="right">0.8752541</td>
        </tr>
        <tr>
          <td align="right">30</td>
          <td align="right">0.8934606</td>
        </tr>
        <tr>
          <td align="right">31</td>
          <td align="right">0.9092853</td>
        </tr>
        <tr>
          <td align="right">32</td>
          <td align="right">0.9229621</td>
        </tr>
        <tr>
          <td align="right">33</td>
          <td align="right">0.9347250</td>
        </tr>
        <tr>
          <td align="right">34</td>
          <td align="right">0.9447992</td>
        </tr>
        <tr>
          <td align="right">35</td>
          <td align="right">0.9533961</td>
        </tr>
        <tr>
          <td align="right">36</td>
          <td align="right">0.9607099</td>
        </tr>
        <tr>
          <td align="right">37</td>
          <td align="right">0.9669157</td>
        </tr>
        <tr>
          <td align="right">38</td>
          <td align="right">0.9721696</td>
        </tr>
        <tr>
          <td align="right">39</td>
          <td align="right">0.9766095</td>
        </tr>
        <tr>
          <td align="right">40</td>
          <td align="right">0.9803553</td>
        </tr>
        <tr>
          <td align="right">41</td>
          <td align="right">0.9835114</td>
        </tr>
        <tr>
          <td align="right">42</td>
          <td align="right">0.9861676</td>
        </tr>
        <tr>
          <td align="right">43</td>
          <td align="right">0.9884009</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>

</article>