<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>


<article-meta>


<title-group>
<article-title>Development and Validation of a Risk Prediction Model of
linezolid-induced thrombocytopenia in Vietnamese
patients</article-title>
</title-group>










<history></history>


<abstract>
<p>Write abstract here, note the indentation</p>
</abstract>




</article-meta>

</front>

<body>
<sec id="checklist">
  <title>1. Checklist</title>
  <table-wrap>
    <caption>
      <p>TRIPOD-Cluster checklist of items to include when reporting a
      study developing or validating a multivariable prediction model
      using clustered data</p>
    </caption>
    <table>
      <colgroup>
        <col width="24%" />
        <col width="24%" />
        <col width="27%" />
        <col width="24%" />
      </colgroup>
      <thead>
        <tr>
          <th><bold>Section/topic</bold></th>
          <th align="center"><bold>Item No</bold></th>
          <th><bold>Description</bold></th>
          <th align="center"><bold>Draft date</bold></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><bold>Title and abstract</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Title</td>
          <td align="center">1</td>
          <td>Identify the study as developing and/or validating a
          multivariable prediction model, the target population, and the
          outcome to be predicted</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Abstract</td>
          <td align="center">2</td>
          <td>Provide a summary of research objectives, setting,
          participants, data source, sample size, predictors, outcome,
          statistical analysis, results, and conclusions*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Introduction</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Background and objectives</td>
          <td align="center">3a</td>
          <td>Explain the medical context (including whether diagnostic
          or prognostic) and rationale for developing or validating the
          prediction model, including references to existing models, and
          the advantages of the study design*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">3b</td>
          <td>Specify the objectives, including whether the study
          describes the development or validation of the model*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Methods</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Participants and data</td>
          <td align="center">4a</td>
          <td>Describe eligibility criteria for participants and
          datasets*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">4b</td>
          <td>Describe the origin of the data, and how the data were
          identified, requested, and collected</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Sample size</td>
          <td align="center">5</td>
          <td>Explain how the sample size was arrived at*</td>
          <td align="center">Mar 21</td>
        </tr>
        <tr>
          <td>Outcomes and predictors</td>
          <td align="center">6a</td>
          <td>Define the outcome that is predicted by the model,
          including how and when assessed*</td>
          <td align="center">Mar 21</td>
        </tr>
        <tr>
          <td></td>
          <td align="center">6b</td>
          <td>Define all predictors used in developing or validating the
          model, including how and when measured*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Data preparation</td>
          <td align="center">7a</td>
          <td>Describe how the data were prepared for analysis,
          including any cleaning, harmonisation, linkage, and quality
          checks</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">7b</td>
          <td>Describe the method for assessing risk of bias and
          applicability in the individual clusters (eg, using
          PROBAST)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">7c</td>
          <td>For validation, identify any differences in definition and
          measurement from the development data (eg, setting,
          eligibility criteria, outcome, predictors)*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">7d</td>
          <td>Describe how missing data were handled*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Data analysis</td>
          <td align="center">8a</td>
          <td>Describe how predictors were handled in the analyses</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8b</td>
          <td>Specify the type of model, all model building procedures
          (eg, any predictor selection and penalisation), and method for
          validation*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8c</td>
          <td>Describe how any heterogeneity across clusters (eg,
          studies or settings) in model parameter values was
          handled</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8d</td>
          <td>For validation, describe how the predictions were
          calculated</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8e</td>
          <td>Specify all measures used to assess model performance (eg,
          calibration, discrimination, and decision curve analysis) and,
          if relevant, to compare multiple models</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8f</td>
          <td>Describe how any heterogeneity across clusters (eg,
          studies or settings) in model performance was handled and
          quantified</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8g</td>
          <td>Describe any model updating (eg, recalibration) arising
          from the validation, either overall or for particular
          populations or settings*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Sensitivity analysis</td>
          <td align="center">9</td>
          <td>Describe any planned subgroup or sensitivity analysis—eg,
          assessing performance according to sources of bias,
          participant characteristics, setting</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Results</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Participants and datasets</td>
          <td align="center">10a</td>
          <td>Describe the number of clusters and participants from data
          identified through to data analysed; a flowchart might be
          helpful*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">10b</td>
          <td>Report the characteristics overall and where applicable
          for each data source or setting, including the key dates,
          predictors, treatments received, sample size, number of
          outcome events, follow-up time, and amount of missing
          data*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">10c</td>
          <td>For validation, show a comparison with the development
          data of the distribution of important variables (demographics,
          predictors, and outcome)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Risk of bias</td>
          <td align="center">11</td>
          <td>Report the results of the risk-of-bias assessment in the
          individual clusters</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Model development and specification</td>
          <td align="center">12a</td>
          <td>Report the results of any assessments of heterogeneity
          across clusters that led to subsequent actions during the
          model’s development (eg, inclusion or exclusion of particular
          predictors or clusters)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">12b</td>
          <td>Present the final prediction model (ie, all regression
          coefficients, and model intercept or baseline estimate of the
          outcome at a given time point) and explain how to use it for
          predictions in new individuals*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Model performance</td>
          <td align="center">13a</td>
          <td>Report performance measures (with uncertainty intervals)
          for the prediction model, overall and for each cluster</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">13b</td>
          <td>Report results of any heterogeneity across clusters in
          model performance</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Model updating</td>
          <td align="center">14</td>
          <td>Report the results from any model updating (including the
          updated model equation and subsequent performance), overall
          and for each cluster*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Sensitivity analysis</td>
          <td align="center">15</td>
          <td>Report results from any subgroup or sensitivity
          analysis</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Discussion</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Interpretation</td>
          <td align="center">16a</td>
          <td>Give an overall interpretation of the main results,
          including heterogeneity across clusters in model performance,
          in the context of the objectives and previous studies*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">16b</td>
          <td>For validation, discuss the results with reference to the
          model performance in the development data, and in any previous
          validations</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">16c</td>
          <td>Discuss the strengths of the study and any limitations
          (eg, missing or incomplete data, non-representativeness, data
          harmonisation problems)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Implications</td>
          <td align="center">17</td>
          <td>Discuss the potential use of the model and implications
          for future research, with specific view to generalisability
          and applicability of the model across different settings or
          (sub)populations</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Other information</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Supplementary information</td>
          <td align="center">18</td>
          <td>Provide information about the availability of
          supplementary resources (eg, study protocol, analysis code,
          datasets)*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Funding</td>
          <td align="center">19</td>
          <td>Give the source of funding and the role of the funders for
          the present study</td>
          <td align="center"></td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</sec>
<sec id="introduction">
  <title>2. Introduction</title>
  <sec id="background-and-objectives">
    <title>2.1 Background and objectives</title>
    <p>Linezolid is an oxazolidinones antibiotics
    [<xref alt="1" rid="ref-cazavet_risk_2020" ref-type="bibr">1</xref>].</p>
  </sec>
</sec>
<sec id="methods">
  <title>3. Methods</title>
  <sec id="participants-and-data">
    <title>3.1 Participants and data</title>
  </sec>
  <sec id="sample-size">
    <title>3.2 Sample size</title>
    <p>Previous studies developing logistic regression models for LI-TP
    risk predictions have included 4-6 predictors in their final models
    [<xref alt="2" rid="ref-liu_analysis_2021" ref-type="bibr">2</xref>];
    [<xref alt="3" rid="ref-duan_regression_2022" ref-type="bibr">3</xref>];
    [<xref alt="4" rid="ref-qin_development_2021" ref-type="bibr">4</xref>];
    [<xref alt="5" rid="ref-xu_establishment_2023" ref-type="bibr">5</xref>].
    We expect to include about as many candidate predictors, based on
    results from the expert opinion survey and the Bayesian Model
    Selection algorithm
    <xref alt="see 3.3" rid="sec-outcomes-and-predictors">see 3.3</xref>.
    Some of the candidate predictors might be continuous, which may
    potentially require non-linear modelling and therefore slightly
    increase the number of variables.</p>
    <p>A general rule of thumb is for at least 10 events be available
    for each candidate predictor considered in a prediction model
    [<xref alt="6" rid="ref-peduzzi1995" ref-type="bibr">6</xref>]. We
    have a total of 816 eligible patients and 264 of those have
    experienced the outcome. If the number of candidate predictors is 7,
    we would have 37 events per candidate predictor, which is
    considerably greater than the minimum number required. Even if the
    number of parameters screened is 20, we would still have 13 events
    per candidate predictor.</p>
    <p>However, the aforementioned rule of thumb have generated some
    debate in the literature, with recent results suggesting that event
    per variable criterion is too simplistic and has no strong relation
    to the predictive performance of a model. Riley et al
    [<xref alt="7" rid="ref-riley2019" ref-type="bibr">7</xref>]
    proposed a different set of criteria to estimate minimum sample size
    for models developed using logistic regression, which are the
    following:</p>
    <list list-type="order">
      <list-item>
        <p>Small optimism in predictor effect estimates, defined as a
        global shrinkage factor of &gt;= 0.9.</p>
      </list-item>
      <list-item>
        <p>Small absolute difference of &lt;= 0.05 in the model’s
        apparent and adjusted Nagelkerke’s R-squared.</p>
      </list-item>
      <list-item>
        <p>Precise estimation of the overall risk in the population.</p>
      </list-item>
    </list>
    <p>Criteria 1 and 2 aims to reduce the potential of overfitting.
    Criteria 3 aims to ensure the overall risk is estimated
    precisely.</p>
    <sec id="step-1-choose-the-number-of-candidate-predictors-of-interest-for-inclusion-in-the-model-and-calculate-the-corresponding-number-of-predictor-parameters-p">
      <title>3.2.1 Step 1: Choose the number of candidate predictors of
      interest for inclusion in the model, and calculate the
      corresponding number of predictor parameters (p)</title>
      <p>Note that one predictor may require two or more parameters. For
      example, a k-category predictor requires k-1 parameters and a
      continuous predictor model with a non-linear trend requires more
      than one parameter to be estimated. Also include any potential
      interaction terms towards the total p.</p>
      <p>When using a predictor selection method, p should be defined as
      the total number of parameters screened, and not just the subset
      that are included in the final model.</p>
      <p>Assuming maximum total p to be 20.</p>
      <boxed-text>
      <p><bold>Note</bold></p>
      <p>The value of p is assumed to be no larger than 20 because
      univariate regression shows there are 20 variables that are
      significantly correlated with the outcome.</p>
      </boxed-text>
    </sec>
    <sec id="step-2-choose-sensible-values-for-r2cs_adj-and-maxr2cs_app-based-on-previous-studies-where-r2cs-is-the-cox-snell-r2-statistic.">
      <title>3.2.2 Step 2: Choose sensible values for
      R<sup>2</sup><sub>CS_adj</sub> and
      max(R<sup>2</sup><sub>CS_app</sub>) based on previous studies
      where R<sup>2</sup><sub>CS</sub> is the Cox-Snell R<sup>2</sup>
      statistic.</title>
      <p>The value of max(R<sup>2</sup><sub>CS_app</sub>) is based on
      the overall prevalence or overall rate of the outcome in the
      population of interest. The incidence of LI-TP in patients treated
      with linezolid was estimated to be 37% in a meta-analysis by Zhao
      et al
      [<xref alt="8" rid="ref-zhao_prediction_2024" ref-type="bibr">8</xref>].</p>
      <p>The value of R<sup>2</sup><sub>CS_adj</sub> could be based on
      that for a previously published model in the same setting and
      population (with similar outcome definition). However, as previous
      studies does not provide any information to identify a sensible
      value of the minimum expected Cox-Snell R<sup>2</sup>, the value
      R<sup>2</sup><sub>CS_adj</sub> will be assumed to correspond to a
      R<sup>2</sup><sub>Nagelkerke</sub> of 0.15.</p>
      <preformat>[1] 0.2048324</preformat>
    </sec>
    <sec id="step-3-criterion-1">
      <title>3.2.3 Step 3: Criterion 1</title>
      <p>Calculate the sample size required to ensure Van Houwelingen’s
      global shrinkage factor (S<sub>VH</sub>) is close to 1. A value of
      S<sub>VH</sub> &gt;= 0.90 is generally recommended, which reflects
      a small amount of overfitting during model development.</p>
      <preformat>[1] 775</preformat>
      <p>We see that 775 participants are required to meet criterion
      1.</p>
    </sec>
    <sec id="step-4-criterion-2">
      <title>3.2.4 Step 4: Criterion 2</title>
      <p>Calculate the shrinkage factor (S<sub>VH</sub>) required to
      ensure a small absolute difference of &lt;= 0.05 in the developed
      model’s apparent and adjusted Nagelkerke’s R<sup>2</sup>. Then
      derive the required sample size conditional on this value of
      S<sub>VH</sub>.</p>
      <preformat>[1] 478</preformat>
      <p>We see that 478 participants are required to meet criterion
      2.</p>
    </sec>
    <sec id="step-5-criterion-3">
      <title>3.2.5 Step 5: Criterion 3</title>
      <p>Calculate the sample size required to ensure a precise estimate
      of the overall risk in the population. The suggested absolute
      margin of error is &lt;= 0.05.</p>
      <preformat>[1] 359</preformat>
      <p>We see that 359 participants are required to meet criterion
      3.</p>
    </sec>
    <sec id="step-6-final-sample-size">
      <title>3.2.6 Step 6: Final sample size</title>
      <p>The required minimum sample size is the maximum value from
      steps 3 to 5, to ensure that each of criteria 1 to 3 are met.</p>
      <preformat>[1] 775</preformat>
      <p>The final estimate of minimum sample size is 775, therefore our
      data is sufficient for model development with at most 20
      parameters.</p>
    </sec>
  </sec>
  <sec id="sec-outcomes-and-predictors">
    <title>3.3 Outcomes and predictors</title>
    <sec id="a.-define-the-outcome-that-is-predicted-by-the-model-including-how-and-when-assessed">
      <title>3.3.1 6a. Define the outcome that is predicted by the
      model, including how and when assessed</title>
      <p>The outcome of interest is linezolid-induced thrombocytopenia,
      defined as (i) a platelet count of &lt; 112.5 x 10<sup>9</sup>
      cells/L (75% of the lower limit of normal) for patients with a
      baseline platelet count in the normal range; (ii) A reduction in
      platelet count of ≥ 25% from the baseline value for patients with
      a baseline platelet count of &lt; 150 x 10<sup>9</sup> cells/L
      [<xref alt="9" rid="ref-zyvoxpr" ref-type="bibr">9</xref>];
      [<xref alt="5" rid="ref-xu_establishment_2023" ref-type="bibr">5</xref>];
      [<xref alt="10" rid="ref-kawasuji_proposal_2021" ref-type="bibr">10</xref>].</p>
      <p>Normal platelet count is defined as 150-450 x 10<sup>9</sup>
      cells/L. Baseline platelet count is defined as the last recorded
      PLT value before the start of linezolid therapy. Participants are
      considered to have met the outcome if they have a platelet count
      that meets the above criteria at any time during linezolid therapy
      or within 5 days after the end of therapy.</p>
      <boxed-text>
      <p><bold>Warning</bold></p>
      <p>Thrombocytopenia may occur within a few days after stopping
      LZD, when the drug hasn’t been completely eliminated. However, it
      is unknown exactly how long after stopping LZD can a TP event
      still be attributed to LZD use. The value of 5 days has been
      chosen <italic>almost</italic> arbitrarily.</p>
      <p>Our rationale is that after 5 days (120 hrs), LZD is guaranteed
      to be completely eliminated in all patients, as the longest
      t<sub>1/2</sub> is 8.3 ± 2.4 hrs in end-stage renal disease
      patients, +3 SD would be ~16 hrs, so 120 hrs is &gt;7 half-lives,
      therefore in patients with the worst clearance, 99% of them would
      have 99% of the drug eliminated from their systems. Furthermore,
      trough LZD concentration (C<sub>min</sub>) has previously been
      identified as a predictor of LI-TP development, and LI-TP itself
      is mostly reversible after discontinuation, so we would argue that
      any TP events that occur after LZD has been eliminated from the
      system would not be related to LZD use.</p>
      </boxed-text>
    </sec>
    <sec id="b.-define-all-predictors-used-in-developing-or-validating-the-model-including-how-and-when-measured">
      <title>3.3.2 6b. Define all predictors used in developing or
      validating the model, including how and when measured</title>
    </sec>
  </sec>
  <sec id="data-preparation">
    <title>3.4 Data preparation</title>
    <sec id="a.-describe-how-the-data-were-prepared-for-analysis-including-any-cleaning-harmonisation-linkage-and-quality-checks">
      <title>3.4.1 7a. Describe how the data were prepared for analysis,
      including any cleaning, harmonisation, linkage, and quality
      checks</title>
    </sec>
  </sec>
  <sec id="data-analysis">
    <title>3.5 Data analysis</title>
  </sec>
  <sec id="sensitivity-analysis">
    <title>3.6 Sensitivity analysis</title>
  </sec>
</sec>
<sec id="results">
  <title>4. Results</title>
  <sec id="participants-and-datasets">
    <title>4.1 Participants and datasets</title>
  </sec>
  <sec id="risk-of-bias">
    <title>4.2 Risk of bias</title>
  </sec>
  <sec id="model-development-and-specification">
    <title>4.3 Model development and specification</title>
  </sec>
  <sec id="model-performance">
    <title>4.4 Model performance</title>
  </sec>
  <sec id="model-updating">
    <title>4.5 Model updating</title>
  </sec>
  <sec id="sensitivity-analysis-1">
    <title>4.6 Sensitivity analysis</title>
  </sec>
</sec>
<sec id="discussion">
  <title>5. Discussion</title>
  <sec id="interpretation">
    <title>5.1 Interpretation</title>
  </sec>
  <sec id="implications">
    <title>5.2 Implications</title>
  </sec>
</sec>
<sec id="other-information">
  <title>6. Other information</title>
  <sec id="supplementary-information">
    <title>6.1 Supplementary information</title>
  </sec>
  <sec id="funding">
    <title>6.2 Funding</title>
  </sec>
  <sec id="references">
    <title>6.3 References</title>
    <ref-list>
      <ref id="ref-cazavet_risk_2020">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Cazavet</surname><given-names>J.</given-names></name>
            <name><surname>Bounes</surname><given-names>F. V.</given-names></name>
            <name><surname>Ruiz</surname><given-names>S.</given-names></name>
            <name><surname>Seguin</surname><given-names>T.</given-names></name>
            <name><surname>Crognier</surname><given-names>L.</given-names></name>
            <name><surname>Rouget</surname><given-names>A.</given-names></name>
            <name><surname>Fourcade</surname><given-names>O.</given-names></name>
            <name><surname>Minville</surname><given-names>V.</given-names></name>
            <name><surname>Conil</surname><given-names>J. M.</given-names></name>
            <name><surname>Georges</surname><given-names>B.</given-names></name>
          </person-group>
          <article-title>Risk factor analysis for linezolid-associated thrombocytopenia in critically ill patients</article-title>
          <source>Eur J Clin Microbiol Infect Dis</source>
          <year iso-8601-date="2020-03">2020</year><month>03</month>
          <volume>39</volume>
          <issue>3</issue>
          <issn>1435-4373 (Electronic) 0934-9723 (Linking)</issn>
          <uri>https://www.ncbi.nlm.nih.gov/pubmed/31853741</uri>
          <pub-id pub-id-type="doi">10.1007/s10096-019-03754-1</pub-id>
          <fpage>527</fpage>
          <lpage>538</lpage>
        </element-citation>
      </ref>
      <ref id="ref-duan_regression_2022">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Duan</surname><given-names>L.</given-names></name>
            <name><surname>Zhou</surname><given-names>Q.</given-names></name>
            <name><surname>Feng</surname><given-names>Z.</given-names></name>
            <name><surname>Zhu</surname><given-names>C.</given-names></name>
            <name><surname>Cai</surname><given-names>Y.</given-names></name>
            <name><surname>Wang</surname><given-names>S.</given-names></name>
            <name><surname>Zhu</surname><given-names>M.</given-names></name>
            <name><surname>Li</surname><given-names>J.</given-names></name>
            <name><surname>Yuan</surname><given-names>Y.</given-names></name>
            <name><surname>Liu</surname><given-names>X.</given-names></name>
            <name><surname>Sun</surname><given-names>J.</given-names></name>
            <name><surname>Yang</surname><given-names>Z.</given-names></name>
            <name><surname>Tang</surname><given-names>L.</given-names></name>
          </person-group>
          <article-title>A Regression Model to Predict Linezolid Induced Thrombocytopenia in Neonatal Sepsis Patients: A Ten-Year Retrospective Cohort Study</article-title>
          <source>Front Pharmacol</source>
          <year iso-8601-date="2022">2022</year>
          <volume>13</volume>
          <issn>1663-9812 (Print) 1663-9812 (Electronic) 1663-9812 (Linking)</issn>
          <uri>https://www.ncbi.nlm.nih.gov/pubmed/35185555</uri>
          <pub-id pub-id-type="doi">10.3389/fphar.2022.710099</pub-id>
          <fpage>710099</fpage>
          <lpage></lpage>
        </element-citation>
      </ref>
      <ref id="ref-qin_development_2021">
        <element-citation publication-type="report">
          <person-group person-group-type="author">
            <name><surname>Qin</surname><given-names>Yan</given-names></name>
            <name><surname>Chen</surname><given-names>Zhe</given-names></name>
            <name><surname>Gao</surname><given-names>Shuai</given-names></name>
            <name><surname>Pan</surname><given-names>Ming Kun</given-names></name>
            <name><surname>Li</surname><given-names>Yu Xiao</given-names></name>
            <name><surname>Lv</surname><given-names>Zhou Qian</given-names></name>
            <name><surname>Shen</surname><given-names>Yun</given-names></name>
            <name><surname>Ye</surname><given-names>Yanrong</given-names></name>
          </person-group>
          <article-title>Development and Validation of a Risk Prediction Model of Linezolid-induced Thrombocytopenia in Elderly Patients</article-title>
          <publisher-name>In Review</publisher-name>
          <year iso-8601-date="2021-06">2021</year><month>06</month>
          <date-in-citation content-type="access-date"><year iso-8601-date="2023-08-17">2023</year><month>08</month><day>17</day></date-in-citation>
          <uri>https://www.researchsquare.com/article/rs-582799/v1</uri>
          <pub-id pub-id-type="doi">10.21203/rs.3.rs-582799/v1</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-kawasuji_proposal_2021">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Kawasuji</surname><given-names>Hitoshi</given-names></name>
            <name><surname>Tsuji</surname><given-names>Yasuhiro</given-names></name>
            <name><surname>Ogami</surname><given-names>Chika</given-names></name>
            <name><surname>Kimoto</surname><given-names>Kou</given-names></name>
            <name><surname>Ueno</surname><given-names>Akitoshi</given-names></name>
            <name><surname>Miyajima</surname><given-names>Yuki</given-names></name>
            <name><surname>Kawago</surname><given-names>Koyomi</given-names></name>
            <name><surname>Sakamaki</surname><given-names>Ippei</given-names></name>
            <name><surname>Yamamoto</surname><given-names>Yoshihiro</given-names></name>
          </person-group>
          <article-title>Proposal of initial and maintenance dosing regimens with linezolid for renal impairment patients</article-title>
          <source>BMC Pharmacology and Toxicology</source>
          <year iso-8601-date="2021-03">2021</year><month>03</month>
          <date-in-citation content-type="access-date"><year iso-8601-date="2024-02-26">2024</year><month>02</month><day>26</day></date-in-citation>
          <volume>22</volume>
          <issue>1</issue>
          <issn>2050-6511</issn>
          <uri>https://doi.org/10.1186/s40360-021-00479-w</uri>
          <pub-id pub-id-type="doi">10.1186/s40360-021-00479-w</pub-id>
          <fpage>13</fpage>
          <lpage></lpage>
        </element-citation>
      </ref>
      <ref id="ref-xu_establishment_2023">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Xu</surname><given-names>Jinhui</given-names></name>
            <name><surname>Lu</surname><given-names>Jian</given-names></name>
            <name><surname>Yuan</surname><given-names>Yunlong</given-names></name>
            <name><surname>Duan</surname><given-names>Lufen</given-names></name>
            <name><surname>Shi</surname><given-names>Lu</given-names></name>
            <name><surname>Chen</surname><given-names>Fang</given-names></name>
            <name><surname>Cao</surname><given-names>Yifei</given-names></name>
            <name><surname>Xu</surname><given-names>Guangjuan</given-names></name>
            <name><surname>Feng</surname><given-names>Zongtai</given-names></name>
            <name><surname>Li</surname><given-names>Lan</given-names></name>
            <name><surname>Xue</surname><given-names>Hongzhi</given-names></name>
            <name><surname>Sun</surname><given-names>Jiantong</given-names></name>
            <name><surname>Zhou</surname><given-names>Qin</given-names></name>
            <name><surname>Zhuang</surname><given-names>Zhiwei</given-names></name>
            <name><surname>Tang</surname><given-names>Lian</given-names></name>
          </person-group>
          <article-title>Establishment and validation of a risk prediction model incorporating concentrations of linezolid and its metabolite PNU142300 for linezolid-induced thrombocytopenia</article-title>
          <source>The Journal of Antimicrobial Chemotherapy</source>
          <year iso-8601-date="2023-08">2023</year><month>08</month>
          <volume>78</volume>
          <issue>8</issue>
          <issn>1460-2091</issn>
          <pub-id pub-id-type="doi">10.1093/jac/dkad191</pub-id>
          <pub-id pub-id-type="pmid">37341139</pub-id>
          <fpage>1974</fpage>
          <lpage>1981</lpage>
        </element-citation>
      </ref>
      <ref id="ref-liu_analysis_2021">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Liu</surname><given-names>YX</given-names></name>
            <name><surname>Liu</surname><given-names>TT</given-names></name>
            <name><surname>Wei</surname><given-names>G</given-names></name>
            <name><surname>Yan</surname><given-names>P</given-names></name>
            <name><surname>Fang</surname><given-names>XQ</given-names></name>
            <name><surname>Xie</surname><given-names>LX</given-names></name>
          </person-group>
          <article-title>Analysis of risk factors and establishment of risk prediction model for linezolid-associated thrombocytopenia.</article-title>
          <source>Medical Journal of Chinese People’s Liberation Army</source>
          <year iso-8601-date="2021">2021</year>
          <volume>46</volume>
          <issue>8</issue>
          <uri>https://d.wanfangdata.com.cn/periodical/jfjyxzz202108006</uri>
          <pub-id pub-id-type="doi">10.11855/j.issn.0577-7402.2021.08.06</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-zhao_prediction_2024">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Zhao</surname><given-names>Xian</given-names></name>
            <name><surname>Peng</surname><given-names>Qin</given-names></name>
            <name><surname>Hu</surname><given-names>Dongmei</given-names></name>
            <name><surname>Li</surname><given-names>Weiwei</given-names></name>
            <name><surname>Ji</surname><given-names>Qing</given-names></name>
            <name><surname>Dong</surname><given-names>Qianqian</given-names></name>
            <name><surname>Huang</surname><given-names>Luguang</given-names></name>
            <name><surname>Piao</surname><given-names>Miyang</given-names></name>
            <name><surname>Ding</surname><given-names>Yi</given-names></name>
            <name><surname>Wang</surname><given-names>Jingwen</given-names></name>
          </person-group>
          <article-title>Prediction of risk factors for linezolid-induced thrombocytopenia based on neural network model</article-title>
          <source>Frontiers in Pharmacology</source>
          <year iso-8601-date="2024">2024</year>
          <date-in-citation content-type="access-date"><year iso-8601-date="2024-02-27">2024</year><month>02</month><day>27</day></date-in-citation>
          <volume>15</volume>
          <issn>1663-9812</issn>
          <uri>https://www.frontiersin.org/journals/pharmacology/articles/10.3389/fphar.2024.1292828</uri>
        </element-citation>
      </ref>
      <ref id="ref-peduzzi1995">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Peduzzi</surname><given-names>Peter</given-names></name>
            <name><surname>Concato</surname><given-names>John</given-names></name>
            <name><surname>Feinstein</surname><given-names>Alvan R.</given-names></name>
            <name><surname>Holford</surname><given-names>Theodore R.</given-names></name>
          </person-group>
          <article-title>Importance of events per independent variable in proportional hazards regression analysis II. Accuracy and precision of regression estimates</article-title>
          <source>Journal of Clinical Epidemiology</source>
          <year iso-8601-date="1995-12-01">1995</year><month>12</month><day>01</day>
          <volume>48</volume>
          <issue>12</issue>
          <uri>https://www.jclinepi.com/article/0895-4356(95)00048-8/abstract</uri>
          <pub-id pub-id-type="doi">10.1016/0895-4356(95)00048-8</pub-id>
          <fpage>1503</fpage>
          <lpage>1510</lpage>
        </element-citation>
      </ref>
      <ref id="ref-riley2019">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Riley</surname><given-names>Richard D</given-names></name>
            <name><surname>Snell</surname><given-names>Kym IE</given-names></name>
            <name><surname>Ensor</surname><given-names>Joie</given-names></name>
            <name><surname>Burke</surname><given-names>Danielle L</given-names></name>
            <name><surname>Harrell Jr</surname><given-names>Frank E</given-names></name>
            <name><surname>Moons</surname><given-names>Karel GM</given-names></name>
            <name><surname>Collins</surname><given-names>Gary S</given-names></name>
          </person-group>
          <article-title>Minimum sample size for developing a multivariable prediction model: PART II - binary and time-to-event outcomes</article-title>
          <source>Statistics in Medicine</source>
          <year iso-8601-date="2019">2019</year>
          <volume>38</volume>
          <issue>7</issue>
          <uri>https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.7992</uri>
          <pub-id pub-id-type="doi">10.1002/sim.7992</pub-id>
          <fpage>1276</fpage>
          <lpage>1296</lpage>
        </element-citation>
      </ref>
      <ref id="ref-zyvoxpr">
        <element-citation>
          <article-title>Zyvox prescribing information</article-title>
          <uri>https://labeling.pfizer.com/showlabeling.aspx?id=649</uri>
        </element-citation>
      </ref>
    </ref-list>
  </sec>
</sec>
</body>

<back>
</back>

<sub-article article-type="notebook" id="nb-32-nb-article">
<front-stub>
<title-group>
<article-title>Development and Validation of a Risk Prediction Model of
linezolid-induced thrombocytopenia in Vietnamese
patients</article-title>
</title-group>
<abstract>
<p>Write abstract here, note the indentation</p>
</abstract>
</front-stub>

<body>
<sec id="checklist-nb-article">
  <title>1. Checklist</title>
  <table-wrap>
    <caption>
      <p>TRIPOD-Cluster checklist of items to include when reporting a
      study developing or validating a multivariable prediction model
      using clustered data</p>
    </caption>
    <table>
      <colgroup>
        <col width="24%" />
        <col width="24%" />
        <col width="27%" />
        <col width="24%" />
      </colgroup>
      <thead>
        <tr>
          <th><bold>Section/topic</bold></th>
          <th align="center"><bold>Item No</bold></th>
          <th><bold>Description</bold></th>
          <th align="center"><bold>Draft date</bold></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><bold>Title and abstract</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Title</td>
          <td align="center">1</td>
          <td>Identify the study as developing and/or validating a
          multivariable prediction model, the target population, and the
          outcome to be predicted</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Abstract</td>
          <td align="center">2</td>
          <td>Provide a summary of research objectives, setting,
          participants, data source, sample size, predictors, outcome,
          statistical analysis, results, and conclusions*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Introduction</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Background and objectives</td>
          <td align="center">3a</td>
          <td>Explain the medical context (including whether diagnostic
          or prognostic) and rationale for developing or validating the
          prediction model, including references to existing models, and
          the advantages of the study design*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">3b</td>
          <td>Specify the objectives, including whether the study
          describes the development or validation of the model*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Methods</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Participants and data</td>
          <td align="center">4a</td>
          <td>Describe eligibility criteria for participants and
          datasets*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">4b</td>
          <td>Describe the origin of the data, and how the data were
          identified, requested, and collected</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Sample size</td>
          <td align="center">5</td>
          <td>Explain how the sample size was arrived at*</td>
          <td align="center">Mar 21</td>
        </tr>
        <tr>
          <td>Outcomes and predictors</td>
          <td align="center">6a</td>
          <td>Define the outcome that is predicted by the model,
          including how and when assessed*</td>
          <td align="center">Mar 21</td>
        </tr>
        <tr>
          <td></td>
          <td align="center">6b</td>
          <td>Define all predictors used in developing or validating the
          model, including how and when measured*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Data preparation</td>
          <td align="center">7a</td>
          <td>Describe how the data were prepared for analysis,
          including any cleaning, harmonisation, linkage, and quality
          checks</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">7b</td>
          <td>Describe the method for assessing risk of bias and
          applicability in the individual clusters (eg, using
          PROBAST)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">7c</td>
          <td>For validation, identify any differences in definition and
          measurement from the development data (eg, setting,
          eligibility criteria, outcome, predictors)*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">7d</td>
          <td>Describe how missing data were handled*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Data analysis</td>
          <td align="center">8a</td>
          <td>Describe how predictors were handled in the analyses</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8b</td>
          <td>Specify the type of model, all model building procedures
          (eg, any predictor selection and penalisation), and method for
          validation*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8c</td>
          <td>Describe how any heterogeneity across clusters (eg,
          studies or settings) in model parameter values was
          handled</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8d</td>
          <td>For validation, describe how the predictions were
          calculated</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8e</td>
          <td>Specify all measures used to assess model performance (eg,
          calibration, discrimination, and decision curve analysis) and,
          if relevant, to compare multiple models</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8f</td>
          <td>Describe how any heterogeneity across clusters (eg,
          studies or settings) in model performance was handled and
          quantified</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">8g</td>
          <td>Describe any model updating (eg, recalibration) arising
          from the validation, either overall or for particular
          populations or settings*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Sensitivity analysis</td>
          <td align="center">9</td>
          <td>Describe any planned subgroup or sensitivity analysis—eg,
          assessing performance according to sources of bias,
          participant characteristics, setting</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Results</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Participants and datasets</td>
          <td align="center">10a</td>
          <td>Describe the number of clusters and participants from data
          identified through to data analysed; a flowchart might be
          helpful*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">10b</td>
          <td>Report the characteristics overall and where applicable
          for each data source or setting, including the key dates,
          predictors, treatments received, sample size, number of
          outcome events, follow-up time, and amount of missing
          data*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">10c</td>
          <td>For validation, show a comparison with the development
          data of the distribution of important variables (demographics,
          predictors, and outcome)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Risk of bias</td>
          <td align="center">11</td>
          <td>Report the results of the risk-of-bias assessment in the
          individual clusters</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Model development and specification</td>
          <td align="center">12a</td>
          <td>Report the results of any assessments of heterogeneity
          across clusters that led to subsequent actions during the
          model’s development (eg, inclusion or exclusion of particular
          predictors or clusters)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">12b</td>
          <td>Present the final prediction model (ie, all regression
          coefficients, and model intercept or baseline estimate of the
          outcome at a given time point) and explain how to use it for
          predictions in new individuals*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Model performance</td>
          <td align="center">13a</td>
          <td>Report performance measures (with uncertainty intervals)
          for the prediction model, overall and for each cluster</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">13b</td>
          <td>Report results of any heterogeneity across clusters in
          model performance</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Model updating</td>
          <td align="center">14</td>
          <td>Report the results from any model updating (including the
          updated model equation and subsequent performance), overall
          and for each cluster*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Sensitivity analysis</td>
          <td align="center">15</td>
          <td>Report results from any subgroup or sensitivity
          analysis</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Discussion</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Interpretation</td>
          <td align="center">16a</td>
          <td>Give an overall interpretation of the main results,
          including heterogeneity across clusters in model performance,
          in the context of the objectives and previous studies*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">16b</td>
          <td>For validation, discuss the results with reference to the
          model performance in the development data, and in any previous
          validations</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td></td>
          <td align="center">16c</td>
          <td>Discuss the strengths of the study and any limitations
          (eg, missing or incomplete data, non-representativeness, data
          harmonisation problems)</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Implications</td>
          <td align="center">17</td>
          <td>Discuss the potential use of the model and implications
          for future research, with specific view to generalisability
          and applicability of the model across different settings or
          (sub)populations</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td><bold>Other information</bold></td>
          <td align="center"></td>
          <td></td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Supplementary information</td>
          <td align="center">18</td>
          <td>Provide information about the availability of
          supplementary resources (eg, study protocol, analysis code,
          datasets)*</td>
          <td align="center"></td>
        </tr>
        <tr>
          <td>Funding</td>
          <td align="center">19</td>
          <td>Give the source of funding and the role of the funders for
          the present study</td>
          <td align="center"></td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</sec>
<sec id="introduction-nb-article">
  <title>2. Introduction</title>
  <sec id="background-and-objectives-nb-article">
    <title>2.1 Background and objectives</title>
    <p>Linezolid is an oxazolidinones antibiotics
    [<xref alt="1" rid="ref-cazavet_risk_2020-nb-article" ref-type="bibr">1</xref>].</p>
  </sec>
</sec>
<sec id="methods-nb-article">
  <title>3. Methods</title>
  <sec id="participants-and-data-nb-article">
    <title>3.1 Participants and data</title>
  </sec>
  <sec id="sample-size-nb-article">
    <title>3.2 Sample size</title>
    <p>Previous studies developing logistic regression models for LI-TP
    risk predictions have included 4-6 predictors in their final models
    [<xref alt="2" rid="ref-liu_analysis_2021-nb-article" ref-type="bibr">2</xref>];
    [<xref alt="3" rid="ref-duan_regression_2022-nb-article" ref-type="bibr">3</xref>];
    [<xref alt="4" rid="ref-qin_development_2021-nb-article" ref-type="bibr">4</xref>];
    [<xref alt="5" rid="ref-xu_establishment_2023-nb-article" ref-type="bibr">5</xref>].
    We expect to include about as many candidate predictors, based on
    results from the expert opinion survey and the Bayesian Model
    Selection algorithm
    <xref alt="see 3.3" rid="sec-outcomes-and-predictors-nb-article">see 3.3</xref>.
    Some of the candidate predictors might be continuous, which may
    potentially require non-linear modelling and therefore slightly
    increase the number of variables.</p>
    <p>A general rule of thumb is for at least 10 events be available
    for each candidate predictor considered in a prediction model
    [<xref alt="6" rid="ref-peduzzi1995-nb-article" ref-type="bibr">6</xref>]. We
    have a total of 816 eligible patients and 264 of those have
    experienced the outcome. If the number of candidate predictors is 7,
    we would have 37 events per candidate predictor, which is
    considerably greater than the minimum number required. Even if the
    number of parameters screened is 20, we would still have 13 events
    per candidate predictor.</p>
    <p>However, the aforementioned rule of thumb have generated some
    debate in the literature, with recent results suggesting that event
    per variable criterion is too simplistic and has no strong relation
    to the predictive performance of a model. Riley et al
    [<xref alt="7" rid="ref-riley2019-nb-article" ref-type="bibr">7</xref>]
    proposed a different set of criteria to estimate minimum sample size
    for models developed using logistic regression, which are the
    following:</p>
    <list list-type="order">
      <list-item>
        <p>Small optimism in predictor effect estimates, defined as a
        global shrinkage factor of &gt;= 0.9.</p>
      </list-item>
      <list-item>
        <p>Small absolute difference of &lt;= 0.05 in the model’s
        apparent and adjusted Nagelkerke’s R-squared.</p>
      </list-item>
      <list-item>
        <p>Precise estimation of the overall risk in the population.</p>
      </list-item>
    </list>
    <p>Criteria 1 and 2 aims to reduce the potential of overfitting.
    Criteria 3 aims to ensure the overall risk is estimated
    precisely.</p>
    <sec id="step-1-choose-the-number-of-candidate-predictors-of-interest-for-inclusion-in-the-model-and-calculate-the-corresponding-number-of-predictor-parameters-p-nb-article">
      <title>3.2.1 Step 1: Choose the number of candidate predictors of
      interest for inclusion in the model, and calculate the
      corresponding number of predictor parameters (p)</title>
      <p>Note that one predictor may require two or more parameters. For
      example, a k-category predictor requires k-1 parameters and a
      continuous predictor model with a non-linear trend requires more
      than one parameter to be estimated. Also include any potential
      interaction terms towards the total p.</p>
      <p>When using a predictor selection method, p should be defined as
      the total number of parameters screened, and not just the subset
      that are included in the final model.</p>
      <p>Assuming maximum total p to be 20.</p>
      <boxed-text>
        <disp-quote>
          <p><bold>Note</bold></p>
          <p>The value of p is assumed to be no larger than 20 because
          univariate regression shows there are 20 variables that are
          significantly correlated with the outcome.</p>
        </disp-quote>
      </boxed-text>
      <sec id="nb-code-cell-1-nb-article" specific-use="notebook-code">
      <code language="r script">parameter_number &lt;- 20</code>
      </sec>
    </sec>
    <sec id="step-2-choose-sensible-values-for-r2cs_adj-and-maxr2cs_app-based-on-previous-studies-where-r2cs-is-the-cox-snell-r2-statistic.-nb-article">
      <title>3.2.2 Step 2: Choose sensible values for
      R<sup>2</sup><sub>CS_adj</sub> and
      max(R<sup>2</sup><sub>CS_app</sub>) based on previous studies
      where R<sup>2</sup><sub>CS</sub> is the Cox-Snell R<sup>2</sup>
      statistic.</title>
      <p>The value of max(R<sup>2</sup><sub>CS_app</sub>) is based on
      the overall prevalence or overall rate of the outcome in the
      population of interest. The incidence of LI-TP in patients treated
      with linezolid was estimated to be 37% in a meta-analysis by Zhao
      et al
      [<xref alt="8" rid="ref-zhao_prediction_2024-nb-article" ref-type="bibr">8</xref>].</p>
      <p>The value of R<sup>2</sup><sub>CS_adj</sub> could be based on
      that for a previously published model in the same setting and
      population (with similar outcome definition). However, as previous
      studies does not provide any information to identify a sensible
      value of the minimum expected Cox-Snell R<sup>2</sup>, the value
      R<sup>2</sup><sub>CS_adj</sub> will be assumed to correspond to a
      R<sup>2</sup><sub>Nagelkerke</sub> of 0.15.</p>
      <sec id="nb-code-cell-2-nb-article" specific-use="notebook-code">
      <code language="r script">calculate_R2_CS_adj &lt;- function(n = 100, E, R2_N = 0.15) {
  ln_L_null &lt;- E * log(E / n) + (n - E) * log(1 - E / n)
  max_R2_CS_app &lt;- 1 - exp(2 * ln_L_null / n)
  R2_CS_adj &lt;- R2_N / max_R2_CS_app
  return(list(R2_CS_adj = R2_CS_adj, max_R2_CS_app = max_R2_CS_app))
}

(cox_snell_r2 &lt;- calculate_R2_CS_adj(E = 37)$R2_CS_adj)</code>
      <code language="r script">max_apparent_cox_snell_r2 &lt;- calculate_R2_CS_adj(E = 37)$max_R2_CS_app</code>
      <sec id="nb-code-cell-2-output-0-nb-article" specific-use="notebook-output">
      <preformat>[1] 0.2048324</preformat>
      </sec>
      </sec>
    </sec>
    <sec id="step-3-criterion-1-nb-article">
      <title>3.2.3 Step 3: Criterion 1</title>
      <p>Calculate the sample size required to ensure Van Houwelingen’s
      global shrinkage factor (S<sub>VH</sub>) is close to 1. A value of
      S<sub>VH</sub> &gt;= 0.90 is generally recommended, which reflects
      a small amount of overfitting during model development.</p>
      <sec id="nb-code-cell-3-nb-article" specific-use="notebook-code">
      <code language="r script">calculate_sample_size_1 &lt;- function(p, R2_CS_adj, S_VH = 0.90) {
  n &lt;- p / ((S_VH - 1) * log(1 - R2_CS_adj / S_VH))
  return(n)
}

(
sample_size_criterion_1 &lt;- 
  calculate_sample_size_1(
    p = parameter_number, 
    R2_CS_adj = cox_snell_r2
  ) |&gt; ceiling()
)</code>
      <sec id="nb-code-cell-3-output-0-nb-article" specific-use="notebook-output">
      <preformat>[1] 775</preformat>
      </sec>
      </sec>
      <p>We see that 775 participants are required to meet criterion
      1.</p>
    </sec>
    <sec id="step-4-criterion-2-nb-article">
      <title>3.2.4 Step 4: Criterion 2</title>
      <p>Calculate the shrinkage factor (S<sub>VH</sub>) required to
      ensure a small absolute difference of &lt;= 0.05 in the developed
      model’s apparent and adjusted Nagelkerke’s R<sup>2</sup>. Then
      derive the required sample size conditional on this value of
      S<sub>VH</sub>.</p>
      <sec id="nb-code-cell-4-nb-article" specific-use="notebook-code">
      <code language="r script">calculate_sample_size_2 &lt;- function(p, R2_CS_adj, max_R2_CS_app, delta = 0.05) {
  S_VH &lt;- R2_CS_adj / (R2_CS_adj + delta * max_R2_CS_app)
  n &lt;- p / ((S_VH - 1) * log(1 - R2_CS_adj / S_VH))
  return(n)
}

(
sample_size_criterion_2 &lt;- 
  calculate_sample_size_2(
    p = parameter_number, 
    R2_CS_adj = cox_snell_r2,
    max_R2_CS_app = max_apparent_cox_snell_r2
  ) |&gt; ceiling()
)</code>
      <sec id="nb-code-cell-4-output-0-nb-article" specific-use="notebook-output">
      <preformat>[1] 478</preformat>
      </sec>
      </sec>
      <p>We see that 478 participants are required to meet criterion
      2.</p>
    </sec>
    <sec id="step-5-criterion-3-nb-article">
      <title>3.2.5 Step 5: Criterion 3</title>
      <p>Calculate the sample size required to ensure a precise estimate
      of the overall risk in the population. The suggested absolute
      margin of error is &lt;= 0.05.</p>
      <sec id="nb-code-cell-5-nb-article" specific-use="notebook-code">
      <code language="r script">calculate_sample_size_3 &lt;- function(phi_hat, delta = 0.05) {
  n &lt;- (1.96 / delta) ^ 2 * phi_hat * (1 - phi_hat)
  return(n)
}

(
sample_size_criterion_3 &lt;- 
  calculate_sample_size_3(phi_hat = 0.37) |&gt; ceiling()
)</code>
      <sec id="nb-code-cell-5-output-0-nb-article" specific-use="notebook-output">
      <preformat>[1] 359</preformat>
      </sec>
      </sec>
      <p>We see that 359 participants are required to meet criterion
      3.</p>
    </sec>
    <sec id="step-6-final-sample-size-nb-article">
      <title>3.2.6 Step 6: Final sample size</title>
      <p>The required minimum sample size is the maximum value from
      steps 3 to 5, to ensure that each of criteria 1 to 3 are met.</p>
      <sec id="nb-code-cell-6-nb-article" specific-use="notebook-code">
      <code language="r script">(minimum_sample_size &lt;- max(sample_size_criterion_1, sample_size_criterion_2, sample_size_criterion_3))</code>
      <sec id="nb-code-cell-6-output-0-nb-article" specific-use="notebook-output">
      <preformat>[1] 775</preformat>
      </sec>
      </sec>
      <p>The final estimate of minimum sample size is 775, therefore our
      data is sufficient for model development with at most 20
      parameters.</p>
    </sec>
  </sec>
  <sec id="sec-outcomes-and-predictors-nb-article">
    <title>3.3 Outcomes and predictors</title>
    <sec id="a.-define-the-outcome-that-is-predicted-by-the-model-including-how-and-when-assessed-nb-article">
      <title>3.3.1 6a. Define the outcome that is predicted by the
      model, including how and when assessed</title>
      <p>The outcome of interest is linezolid-induced thrombocytopenia,
      defined as (i) a platelet count of &lt; 112.5 x 10<sup>9</sup>
      cells/L (75% of the lower limit of normal) for patients with a
      baseline platelet count in the normal range; (ii) A reduction in
      platelet count of ≥ 25% from the baseline value for patients with
      a baseline platelet count of &lt; 150 x 10<sup>9</sup> cells/L
      [<xref alt="9" rid="ref-zyvoxpr-nb-article" ref-type="bibr">9</xref>];
      [<xref alt="5" rid="ref-xu_establishment_2023-nb-article" ref-type="bibr">5</xref>];
      [<xref alt="10" rid="ref-kawasuji_proposal_2021-nb-article" ref-type="bibr">10</xref>].</p>
      <p>Normal platelet count is defined as 150-450 x 10<sup>9</sup>
      cells/L. Baseline platelet count is defined as the last recorded
      PLT value before the start of linezolid therapy. Participants are
      considered to have met the outcome if they have a platelet count
      that meets the above criteria at any time during linezolid therapy
      or within 5 days after the end of therapy.</p>
      <boxed-text>
        <disp-quote>
          <p><bold>Warning</bold></p>
          <p>Thrombocytopenia may occur within a few days after stopping
          LZD, when the drug hasn’t been completely eliminated. However,
          it is unknown exactly how long after stopping LZD can a TP
          event still be attributed to LZD use. The value of 5 days has
          been chosen <italic>almost</italic> arbitrarily.</p>
          <p>Our rationale is that after 5 days (120 hrs), LZD is
          guaranteed to be completely eliminated in all patients, as the
          longest t<sub>1/2</sub> is 8.3 ± 2.4 hrs in end-stage renal
          disease patients, +3 SD would be ~16 hrs, so 120 hrs is &gt;7
          half-lives, therefore in patients with the worst clearance,
          99% of them would have 99% of the drug eliminated from their
          systems. Furthermore, trough LZD concentration
          (C<sub>min</sub>) has previously been identified as a
          predictor of LI-TP development, and LI-TP itself is mostly
          reversible after discontinuation, so we would argue that any
          TP events that occur after LZD has been eliminated from the
          system would not be related to LZD use.</p>
        </disp-quote>
      </boxed-text>
    </sec>
    <sec id="b.-define-all-predictors-used-in-developing-or-validating-the-model-including-how-and-when-measured-nb-article">
      <title>3.3.2 6b. Define all predictors used in developing or
      validating the model, including how and when measured</title>
    </sec>
  </sec>
  <sec id="data-preparation-nb-article">
    <title>3.4 Data preparation</title>
    <sec id="a.-describe-how-the-data-were-prepared-for-analysis-including-any-cleaning-harmonisation-linkage-and-quality-checks-nb-article">
      <title>3.4.1 7a. Describe how the data were prepared for analysis,
      including any cleaning, harmonisation, linkage, and quality
      checks</title>
    </sec>
  </sec>
  <sec id="data-analysis-nb-article">
    <title>3.5 Data analysis</title>
  </sec>
  <sec id="sensitivity-analysis-nb-article">
    <title>3.6 Sensitivity analysis</title>
  </sec>
</sec>
<sec id="results-nb-article">
  <title>4. Results</title>
  <sec id="participants-and-datasets-nb-article">
    <title>4.1 Participants and datasets</title>
  </sec>
  <sec id="risk-of-bias-nb-article">
    <title>4.2 Risk of bias</title>
  </sec>
  <sec id="model-development-and-specification-nb-article">
    <title>4.3 Model development and specification</title>
  </sec>
  <sec id="model-performance-nb-article">
    <title>4.4 Model performance</title>
  </sec>
  <sec id="model-updating-nb-article">
    <title>4.5 Model updating</title>
  </sec>
  <sec id="sensitivity-analysis-1-nb-article">
    <title>4.6 Sensitivity analysis</title>
  </sec>
</sec>
<sec id="discussion-nb-article">
  <title>5. Discussion</title>
  <sec id="interpretation-nb-article">
    <title>5.1 Interpretation</title>
  </sec>
  <sec id="implications-nb-article">
    <title>5.2 Implications</title>
  </sec>
</sec>
<sec id="other-information-nb-article">
  <title>6. Other information</title>
  <sec id="supplementary-information-nb-article">
    <title>6.1 Supplementary information</title>
  </sec>
  <sec id="funding-nb-article">
    <title>6.2 Funding</title>
  </sec>
  <sec id="references-nb-article">
    <title>6.3 References</title>
    <ref-list>
      <ref id="ref-cazavet_risk_2020-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Cazavet</surname><given-names>J.</given-names></name>
            <name><surname>Bounes</surname><given-names>F. V.</given-names></name>
            <name><surname>Ruiz</surname><given-names>S.</given-names></name>
            <name><surname>Seguin</surname><given-names>T.</given-names></name>
            <name><surname>Crognier</surname><given-names>L.</given-names></name>
            <name><surname>Rouget</surname><given-names>A.</given-names></name>
            <name><surname>Fourcade</surname><given-names>O.</given-names></name>
            <name><surname>Minville</surname><given-names>V.</given-names></name>
            <name><surname>Conil</surname><given-names>J. M.</given-names></name>
            <name><surname>Georges</surname><given-names>B.</given-names></name>
          </person-group>
          <article-title>Risk factor analysis for linezolid-associated thrombocytopenia in critically ill patients</article-title>
          <source>Eur J Clin Microbiol Infect Dis</source>
          <year iso-8601-date="2020-03">2020</year><month>03</month>
          <volume>39</volume>
          <issue>3</issue>
          <issn>1435-4373 (Electronic) 0934-9723 (Linking)</issn>
          <uri>https://www.ncbi.nlm.nih.gov/pubmed/31853741</uri>
          <pub-id pub-id-type="doi">10.1007/s10096-019-03754-1</pub-id>
          <fpage>527</fpage>
          <lpage>538</lpage>
        </element-citation>
      </ref>
      <ref id="ref-duan_regression_2022-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Duan</surname><given-names>L.</given-names></name>
            <name><surname>Zhou</surname><given-names>Q.</given-names></name>
            <name><surname>Feng</surname><given-names>Z.</given-names></name>
            <name><surname>Zhu</surname><given-names>C.</given-names></name>
            <name><surname>Cai</surname><given-names>Y.</given-names></name>
            <name><surname>Wang</surname><given-names>S.</given-names></name>
            <name><surname>Zhu</surname><given-names>M.</given-names></name>
            <name><surname>Li</surname><given-names>J.</given-names></name>
            <name><surname>Yuan</surname><given-names>Y.</given-names></name>
            <name><surname>Liu</surname><given-names>X.</given-names></name>
            <name><surname>Sun</surname><given-names>J.</given-names></name>
            <name><surname>Yang</surname><given-names>Z.</given-names></name>
            <name><surname>Tang</surname><given-names>L.</given-names></name>
          </person-group>
          <article-title>A Regression Model to Predict Linezolid Induced Thrombocytopenia in Neonatal Sepsis Patients: A Ten-Year Retrospective Cohort Study</article-title>
          <source>Front Pharmacol</source>
          <year iso-8601-date="2022">2022</year>
          <volume>13</volume>
          <issn>1663-9812 (Print) 1663-9812 (Electronic) 1663-9812 (Linking)</issn>
          <uri>https://www.ncbi.nlm.nih.gov/pubmed/35185555</uri>
          <pub-id pub-id-type="doi">10.3389/fphar.2022.710099</pub-id>
          <fpage>710099</fpage>
          <lpage></lpage>
        </element-citation>
      </ref>
      <ref id="ref-qin_development_2021-nb-article">
        <element-citation publication-type="report">
          <person-group person-group-type="author">
            <name><surname>Qin</surname><given-names>Yan</given-names></name>
            <name><surname>Chen</surname><given-names>Zhe</given-names></name>
            <name><surname>Gao</surname><given-names>Shuai</given-names></name>
            <name><surname>Pan</surname><given-names>Ming Kun</given-names></name>
            <name><surname>Li</surname><given-names>Yu Xiao</given-names></name>
            <name><surname>Lv</surname><given-names>Zhou Qian</given-names></name>
            <name><surname>Shen</surname><given-names>Yun</given-names></name>
            <name><surname>Ye</surname><given-names>Yanrong</given-names></name>
          </person-group>
          <article-title>Development and Validation of a Risk Prediction Model of Linezolid-induced Thrombocytopenia in Elderly Patients</article-title>
          <publisher-name>In Review</publisher-name>
          <year iso-8601-date="2021-06">2021</year><month>06</month>
          <date-in-citation content-type="access-date"><year iso-8601-date="2023-08-17">2023</year><month>08</month><day>17</day></date-in-citation>
          <uri>https://www.researchsquare.com/article/rs-582799/v1</uri>
          <pub-id pub-id-type="doi">10.21203/rs.3.rs-582799/v1</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-kawasuji_proposal_2021-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Kawasuji</surname><given-names>Hitoshi</given-names></name>
            <name><surname>Tsuji</surname><given-names>Yasuhiro</given-names></name>
            <name><surname>Ogami</surname><given-names>Chika</given-names></name>
            <name><surname>Kimoto</surname><given-names>Kou</given-names></name>
            <name><surname>Ueno</surname><given-names>Akitoshi</given-names></name>
            <name><surname>Miyajima</surname><given-names>Yuki</given-names></name>
            <name><surname>Kawago</surname><given-names>Koyomi</given-names></name>
            <name><surname>Sakamaki</surname><given-names>Ippei</given-names></name>
            <name><surname>Yamamoto</surname><given-names>Yoshihiro</given-names></name>
          </person-group>
          <article-title>Proposal of initial and maintenance dosing regimens with linezolid for renal impairment patients</article-title>
          <source>BMC Pharmacology and Toxicology</source>
          <year iso-8601-date="2021-03">2021</year><month>03</month>
          <date-in-citation content-type="access-date"><year iso-8601-date="2024-02-26">2024</year><month>02</month><day>26</day></date-in-citation>
          <volume>22</volume>
          <issue>1</issue>
          <issn>2050-6511</issn>
          <uri>https://doi.org/10.1186/s40360-021-00479-w</uri>
          <pub-id pub-id-type="doi">10.1186/s40360-021-00479-w</pub-id>
          <fpage>13</fpage>
          <lpage></lpage>
        </element-citation>
      </ref>
      <ref id="ref-xu_establishment_2023-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Xu</surname><given-names>Jinhui</given-names></name>
            <name><surname>Lu</surname><given-names>Jian</given-names></name>
            <name><surname>Yuan</surname><given-names>Yunlong</given-names></name>
            <name><surname>Duan</surname><given-names>Lufen</given-names></name>
            <name><surname>Shi</surname><given-names>Lu</given-names></name>
            <name><surname>Chen</surname><given-names>Fang</given-names></name>
            <name><surname>Cao</surname><given-names>Yifei</given-names></name>
            <name><surname>Xu</surname><given-names>Guangjuan</given-names></name>
            <name><surname>Feng</surname><given-names>Zongtai</given-names></name>
            <name><surname>Li</surname><given-names>Lan</given-names></name>
            <name><surname>Xue</surname><given-names>Hongzhi</given-names></name>
            <name><surname>Sun</surname><given-names>Jiantong</given-names></name>
            <name><surname>Zhou</surname><given-names>Qin</given-names></name>
            <name><surname>Zhuang</surname><given-names>Zhiwei</given-names></name>
            <name><surname>Tang</surname><given-names>Lian</given-names></name>
          </person-group>
          <article-title>Establishment and validation of a risk prediction model incorporating concentrations of linezolid and its metabolite PNU142300 for linezolid-induced thrombocytopenia</article-title>
          <source>The Journal of Antimicrobial Chemotherapy</source>
          <year iso-8601-date="2023-08">2023</year><month>08</month>
          <volume>78</volume>
          <issue>8</issue>
          <issn>1460-2091</issn>
          <pub-id pub-id-type="doi">10.1093/jac/dkad191</pub-id>
          <pub-id pub-id-type="pmid">37341139</pub-id>
          <fpage>1974</fpage>
          <lpage>1981</lpage>
        </element-citation>
      </ref>
      <ref id="ref-liu_analysis_2021-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Liu</surname><given-names>YX</given-names></name>
            <name><surname>Liu</surname><given-names>TT</given-names></name>
            <name><surname>Wei</surname><given-names>G</given-names></name>
            <name><surname>Yan</surname><given-names>P</given-names></name>
            <name><surname>Fang</surname><given-names>XQ</given-names></name>
            <name><surname>Xie</surname><given-names>LX</given-names></name>
          </person-group>
          <article-title>Analysis of risk factors and establishment of risk prediction model for linezolid-associated thrombocytopenia.</article-title>
          <source>Medical Journal of Chinese People’s Liberation Army</source>
          <year iso-8601-date="2021">2021</year>
          <volume>46</volume>
          <issue>8</issue>
          <uri>https://d.wanfangdata.com.cn/periodical/jfjyxzz202108006</uri>
          <pub-id pub-id-type="doi">10.11855/j.issn.0577-7402.2021.08.06</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-zhao_prediction_2024-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Zhao</surname><given-names>Xian</given-names></name>
            <name><surname>Peng</surname><given-names>Qin</given-names></name>
            <name><surname>Hu</surname><given-names>Dongmei</given-names></name>
            <name><surname>Li</surname><given-names>Weiwei</given-names></name>
            <name><surname>Ji</surname><given-names>Qing</given-names></name>
            <name><surname>Dong</surname><given-names>Qianqian</given-names></name>
            <name><surname>Huang</surname><given-names>Luguang</given-names></name>
            <name><surname>Piao</surname><given-names>Miyang</given-names></name>
            <name><surname>Ding</surname><given-names>Yi</given-names></name>
            <name><surname>Wang</surname><given-names>Jingwen</given-names></name>
          </person-group>
          <article-title>Prediction of risk factors for linezolid-induced thrombocytopenia based on neural network model</article-title>
          <source>Frontiers in Pharmacology</source>
          <year iso-8601-date="2024">2024</year>
          <date-in-citation content-type="access-date"><year iso-8601-date="2024-02-27">2024</year><month>02</month><day>27</day></date-in-citation>
          <volume>15</volume>
          <issn>1663-9812</issn>
          <uri>https://www.frontiersin.org/journals/pharmacology/articles/10.3389/fphar.2024.1292828</uri>
        </element-citation>
      </ref>
      <ref id="ref-peduzzi1995-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Peduzzi</surname><given-names>Peter</given-names></name>
            <name><surname>Concato</surname><given-names>John</given-names></name>
            <name><surname>Feinstein</surname><given-names>Alvan R.</given-names></name>
            <name><surname>Holford</surname><given-names>Theodore R.</given-names></name>
          </person-group>
          <article-title>Importance of events per independent variable in proportional hazards regression analysis II. Accuracy and precision of regression estimates</article-title>
          <source>Journal of Clinical Epidemiology</source>
          <year iso-8601-date="1995-12-01">1995</year><month>12</month><day>01</day>
          <volume>48</volume>
          <issue>12</issue>
          <uri>https://www.jclinepi.com/article/0895-4356(95)00048-8/abstract</uri>
          <pub-id pub-id-type="doi">10.1016/0895-4356(95)00048-8</pub-id>
          <fpage>1503</fpage>
          <lpage>1510</lpage>
        </element-citation>
      </ref>
      <ref id="ref-riley2019-nb-article">
        <element-citation publication-type="article-journal">
          <person-group person-group-type="author">
            <name><surname>Riley</surname><given-names>Richard D</given-names></name>
            <name><surname>Snell</surname><given-names>Kym IE</given-names></name>
            <name><surname>Ensor</surname><given-names>Joie</given-names></name>
            <name><surname>Burke</surname><given-names>Danielle L</given-names></name>
            <name><surname>Harrell Jr</surname><given-names>Frank E</given-names></name>
            <name><surname>Moons</surname><given-names>Karel GM</given-names></name>
            <name><surname>Collins</surname><given-names>Gary S</given-names></name>
          </person-group>
          <article-title>Minimum sample size for developing a multivariable prediction model: PART II - binary and time-to-event outcomes</article-title>
          <source>Statistics in Medicine</source>
          <year iso-8601-date="2019">2019</year>
          <volume>38</volume>
          <issue>7</issue>
          <uri>https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.7992</uri>
          <pub-id pub-id-type="doi">10.1002/sim.7992</pub-id>
          <fpage>1276</fpage>
          <lpage>1296</lpage>
        </element-citation>
      </ref>
      <ref id="ref-zyvoxpr-nb-article">
        <element-citation>
          <article-title>Zyvox prescribing information</article-title>
          <uri>https://labeling.pfizer.com/showlabeling.aspx?id=649</uri>
        </element-citation>
      </ref>
    </ref-list>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-4-nb-1">
<front-stub>
<title-group>
<article-title>Risk Score System and Algorithm</article-title>
</title-group>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-1" specific-use="notebook-code">
<code language="r script">source(&quot;notebooks/initialize-data-analysis.r&quot;)
</code>
<code language="r script">load(&quot;data/model-performance/model-full.rda&quot;)
</code>
<sec id="nb-code-cell-1-output-0-nb-1" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
</sec>
<sec id="nb-code-cell-2-nb-1" specific-use="notebook-code">
<code language="r script">library(tidyverse)
library(tidymodels)
</code>
<code language="r script">model_beta_estimates &lt;- model_full$fit |&gt;
  tidy() |&gt;
  select(term, estimate, p.value)

model_odds_ratios &lt;- model_full$fit |&gt;
  tidy(conf.int = TRUE, exponentiate = TRUE) |&gt;
  select(term, estimate, conf.low, conf.high) |&gt;
  filter(term != &quot;(Intercept)&quot;) |&gt;
  rename(odds_ratio = estimate, OR_lower = conf.low, OR_upper = conf.high)

predictor_list_with_intercept &lt;- c(predictor_list, &quot;(Intercept)&quot;)

parameter_estimates &lt;- left_join(model_beta_estimates, model_odds_ratios, by = &quot;term&quot;) |&gt;
  rename(risk_factor = term, beta = estimate, p_value = p.value) |&gt;
  mutate(risk_factor = str_extract(risk_factor, paste(predictor_list_with_intercept, collapse = &quot;|&quot;)))
</code>
<sec id="nb-code-cell-2-output-0-nb-1" specific-use="notebook-output">
<preformat>── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──</preformat>
</sec>
<sec id="nb-code-cell-2-output-1-nb-1" specific-use="notebook-output">
<preformat>✔ broom        1.0.5      ✔ rsample      1.2.0 
✔ dials        1.2.1      ✔ tune         1.2.0 
✔ infer        1.0.6      ✔ workflows    1.1.4 
✔ modeldata    1.3.0      ✔ workflowsets 1.1.0 
✔ parsnip      1.2.0      ✔ yardstick    1.3.0 
✔ recipes      1.0.10     </preformat>
</sec>
<sec id="nb-code-cell-2-output-2-nb-1" specific-use="notebook-output">
<preformat>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ scales::discard() masks purrr::discard()
✖ dplyr::filter()   masks stats::filter()
✖ recipes::fixed()  masks stringr::fixed()
✖ dplyr::lag()      masks stats::lag()
✖ yardstick::spec() masks readr::spec()
✖ recipes::step()   masks stats::step()
• Search for functions across packages at https://www.tidymodels.org/find/</preformat>
</sec>
</sec>
<sec id="risk-score-system-nb-1">
  <title>Risk Score System</title>
  <p>All code below is not automatic. Variables and ranges are manually
  defined.</p>
  <sec id="nb-code-cell-3-nb-1" specific-use="notebook-code">
  <code language="r script">risk_profile_1 &lt;- tibble(
  risk_factor = &quot;patient_age&quot;,
  min_range = c(18, 30, 40, 50, 60, 70, 80, 90), # minimum age is 18
  max_range = lead(min_range, default = 101), # maximum age is 101, interval is 10
  reference = (min_range + max_range) / 2,
  flag_base_risk = FALSE
) |&gt;
  mutate(
    flag_base_risk = replace(flag_base_risk, 1, TRUE)
  )

risk_profile_2 &lt;- tibble(
  risk_factor = &quot;baseline_PLT&quot;,
  min_range = c(150, 75, 50, 25, 18), # 1% percentile is 18
  max_range = lag(min_range, default = 434), # 99% percentile is 434
  reference = (min_range + max_range) / 2,
  flag_base_risk = FALSE
) |&gt;
  mutate(
    min_range = replace(min_range, n(), -Inf),
    max_range = replace(max_range, 1, Inf),
    flag_base_risk = replace(flag_base_risk, 1, TRUE)
  )

risk_profile_3 &lt;- tibble(
  risk_factor = &quot;LZD_duration&quot;,
  min_range = c(3, 7, 14), # 1% percentile is 3
  max_range = lead(min_range, default = 26), # 99% percentile is 26
  reference = (min_range + max_range) / 2,
  flag_base_risk = FALSE
) |&gt;
  mutate(
    min_range = replace(min_range, 1, -Inf),
    max_range = replace(max_range, n(), Inf),
    flag_base_risk = replace(flag_base_risk, 1, TRUE)
  )

risk_profile_4 &lt;- tibble(
  risk_factor = &quot;invasive_CRRT&quot;,
  min_range = c(0, 1), # 0 or 1
  max_range = c(0, 1), # 0 or 1
  reference = c(0, 1),
  flag_base_risk = FALSE
) |&gt;
  mutate(
    flag_base_risk = replace(flag_base_risk, 1, TRUE)
  )

risk_profile_5 &lt;- tibble(
  risk_factor = &quot;invasive_CVC&quot;,
  min_range = c(0, 1), # 0 or 1
  max_range = c(0, 1), # 0 or 1
  reference = c(0, 1),
  flag_base_risk = FALSE
) |&gt;
  mutate(
    flag_base_risk = replace(flag_base_risk, 1, TRUE)
  )

risk_profile &lt;- bind_rows(risk_profile_1, risk_profile_2, risk_profile_3, risk_profile_4, risk_profile_5)
  </code>
  </sec>
  <sec id="nb-code-cell-4-nb-1" specific-use="notebook-code">
  <code language="r script">B_constant &lt;- parameter_estimates |&gt;
  filter(risk_factor == &quot;patient_age&quot;) |&gt;
  pull(beta) * 10 # constant equivalent to 10-year increase in age

points_system_full &lt;- parameter_estimates |&gt;
  select(risk_factor, beta) |&gt;
  right_join(risk_profile, by = &quot;risk_factor&quot;) |&gt;
  group_by(risk_factor) |&gt;
  mutate(
    beta_sum = beta * (reference - reference[which.max(flag_base_risk)]),
    points = round(beta_sum / B_constant, 0)
  )

points_system_factors &lt;- points_system_full |&gt;
  select(risk_factor, min_range, max_range, points)

min_points &lt;- points_system_full |&gt;
  group_by(risk_factor) |&gt;
  summarise(min_points = min(points)) |&gt;
  summarise(total_min_points = sum(min_points)) |&gt;
  pull(total_min_points)

max_points &lt;- points_system_full |&gt;
  group_by(risk_factor) |&gt;
  summarise(max_points = max(points)) |&gt;
  summarise(total_max_points = sum(max_points)) |&gt;
  pull(total_max_points)

risk_function &lt;- function(points) {
  intercept &lt;- parameter_estimates |&gt;
    filter(risk_factor == &quot;Intercept&quot;) |&gt;
    pull(beta)

  beta_base &lt;- points_system_full |&gt;
    filter(flag_base_risk == TRUE) |&gt;
    ungroup() |&gt;
    summarise(
      beta_base = sum(beta * reference)
    ) |&gt;
    pull(beta_base)

  1 / (1 + exp(-(intercept + beta_base + B_constant * points)))
}

points_system_risks &lt;- tibble(
  points_total = seq(min_points, max_points),
  risk_estimate = risk_function(points_total)
)

points_system_factors |&gt; knitr::kable()
  </code>
  <table-wrap>
    <table>
      <thead>
        <tr>
          <th align="left">risk_factor</th>
          <th align="right">min_range</th>
          <th align="right">max_range</th>
          <th align="right">points</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">18</td>
          <td align="right">30</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">30</td>
          <td align="right">40</td>
          <td align="right">1</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">40</td>
          <td align="right">50</td>
          <td align="right">2</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">50</td>
          <td align="right">60</td>
          <td align="right">3</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">60</td>
          <td align="right">70</td>
          <td align="right">4</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">70</td>
          <td align="right">80</td>
          <td align="right">5</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">80</td>
          <td align="right">90</td>
          <td align="right">6</td>
        </tr>
        <tr>
          <td align="left">patient_age</td>
          <td align="right">90</td>
          <td align="right">101</td>
          <td align="right">7</td>
        </tr>
        <tr>
          <td align="left">baseline_PLT</td>
          <td align="right">150</td>
          <td align="right">Inf</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="left">baseline_PLT</td>
          <td align="right">75</td>
          <td align="right">150</td>
          <td align="right">7</td>
        </tr>
        <tr>
          <td align="left">baseline_PLT</td>
          <td align="right">50</td>
          <td align="right">75</td>
          <td align="right">9</td>
        </tr>
        <tr>
          <td align="left">baseline_PLT</td>
          <td align="right">25</td>
          <td align="right">50</td>
          <td align="right">10</td>
        </tr>
        <tr>
          <td align="left">baseline_PLT</td>
          <td align="right">-Inf</td>
          <td align="right">25</td>
          <td align="right">11</td>
        </tr>
        <tr>
          <td align="left">LZD_duration</td>
          <td align="right">-Inf</td>
          <td align="right">7</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="left">LZD_duration</td>
          <td align="right">7</td>
          <td align="right">14</td>
          <td align="right">2</td>
        </tr>
        <tr>
          <td align="left">LZD_duration</td>
          <td align="right">14</td>
          <td align="right">Inf</td>
          <td align="right">5</td>
        </tr>
        <tr>
          <td align="left">invasive_CVC</td>
          <td align="right">0</td>
          <td align="right">0</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="left">invasive_CVC</td>
          <td align="right">1</td>
          <td align="right">1</td>
          <td align="right">3</td>
        </tr>
        <tr>
          <td align="left">invasive_CRRT</td>
          <td align="right">0</td>
          <td align="right">0</td>
          <td align="right">0</td>
        </tr>
        <tr>
          <td align="left">invasive_CRRT</td>
          <td align="right">1</td>
          <td align="right">1</td>
          <td align="right">4</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <code language="r script">points_system_risks |&gt; knitr::kable()
  </code>
  <table-wrap>
    <table>
      <thead>
        <tr>
          <th align="right">points_total</th>
          <th align="right">risk_estimate</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="right">0</td>
          <td align="right">0.1145607</td>
        </tr>
        <tr>
          <td align="right">1</td>
          <td align="right">0.1390520</td>
        </tr>
        <tr>
          <td align="right">2</td>
          <td align="right">0.1677869</td>
        </tr>
        <tr>
          <td align="right">3</td>
          <td align="right">0.2010730</td>
        </tr>
        <tr>
          <td align="right">4</td>
          <td align="right">0.2390657</td>
        </tr>
        <tr>
          <td align="right">5</td>
          <td align="right">0.2817057</td>
        </tr>
        <tr>
          <td align="right">6</td>
          <td align="right">0.3286662</td>
        </tr>
        <tr>
          <td align="right">7</td>
          <td align="right">0.3793210</td>
        </tr>
        <tr>
          <td align="right">8</td>
          <td align="right">0.4327503</td>
        </tr>
        <tr>
          <td align="right">9</td>
          <td align="right">0.4877908</td>
        </tr>
        <tr>
          <td align="right">10</td>
          <td align="right">0.5431291</td>
        </tr>
        <tr>
          <td align="right">11</td>
          <td align="right">0.5974229</td>
        </tr>
        <tr>
          <td align="right">12</td>
          <td align="right">0.6494292</td>
        </tr>
        <tr>
          <td align="right">13</td>
          <td align="right">0.6981120</td>
        </tr>
        <tr>
          <td align="right">14</td>
          <td align="right">0.7427127</td>
        </tr>
        <tr>
          <td align="right">15</td>
          <td align="right">0.7827745</td>
        </tr>
        <tr>
          <td align="right">16</td>
          <td align="right">0.8181258</td>
        </tr>
        <tr>
          <td align="right">17</td>
          <td align="right">0.8488351</td>
        </tr>
        <tr>
          <td align="right">18</td>
          <td align="right">0.8751504</td>
        </tr>
        <tr>
          <td align="right">19</td>
          <td align="right">0.8974382</td>
        </tr>
        <tr>
          <td align="right">20</td>
          <td align="right">0.9161285</td>
        </tr>
        <tr>
          <td align="right">21</td>
          <td align="right">0.9316722</td>
        </tr>
        <tr>
          <td align="right">22</td>
          <td align="right">0.9445096</td>
        </tr>
        <tr>
          <td align="right">23</td>
          <td align="right">0.9550515</td>
        </tr>
        <tr>
          <td align="right">24</td>
          <td align="right">0.9636678</td>
        </tr>
        <tr>
          <td align="right">25</td>
          <td align="right">0.9706830</td>
        </tr>
        <tr>
          <td align="right">26</td>
          <td align="right">0.9763770</td>
        </tr>
        <tr>
          <td align="right">27</td>
          <td align="right">0.9809867</td>
        </tr>
        <tr>
          <td align="right">28</td>
          <td align="right">0.9847109</td>
        </tr>
        <tr>
          <td align="right">29</td>
          <td align="right">0.9877149</td>
        </tr>
        <tr>
          <td align="right">30</td>
          <td align="right">0.9901345</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-8-nb-2">
<front-stub>
<title-group>
<article-title>Descriptive Statistics</article-title>
</title-group>
</front-stub>

<body>
<p>Initialize data to analyze.</p>
<sec id="nb-code-cell-1-nb-2" specific-use="notebook-code">
<code language="r script">source(&quot;notebooks/initialize-data-analysis.r&quot;)
</code>
<sec id="nb-code-cell-1-output-0-nb-2" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
</sec>
<p>Summary statistics, by thrombocytopenia status.</p>
<sec id="nb-code-cell-2-nb-2" specific-use="notebook-code">
<code language="r script">library(gtsummary)

table_stats &lt;- data_patient_complete |&gt;
  select(
    all_of(predictor_list), starts_with(&quot;comed&quot;), flag_ADR_TP_ID
  ) |&gt;
  tbl_summary(
    by = flag_ADR_TP_ID,
    statistic = list(all_continuous() ~ &quot;{median} ({p25} - {p75})&quot;),
    missing = &quot;no&quot;
  ) |&gt;
  add_overall() |&gt;
  bold_labels()
</code>
</sec>
<p>Univariate logistic regression, by thrombocytopenia status.</p>
<sec id="nb-code-cell-3-nb-2" specific-use="notebook-code">
<code language="r script">library(tidymodels)
</code>
<code language="r script">library(furrr)
</code>
<code language="r script">data_patient_complete_response_as_factor &lt;- data_patient_complete |&gt;
  mutate(
    flag_ADR_TP_ID = as.factor(flag_ADR_TP_ID)
  )

fit_univariate_regression &lt;- function(predictor) {
  model &lt;- logistic_reg() |&gt;
    set_engine(&quot;glm&quot;) |&gt;
    set_mode(&quot;classification&quot;) |&gt;
    fit(
      reformulate(
        termlabels = predictor,
        response = &quot;flag_ADR_TP_ID&quot;
      ),
      data = data_patient_complete_response_as_factor
    )
}

arrange_univariate_regression &lt;- function(model) {
  model |&gt;
    tbl_regression(
      exponentiate = TRUE,
      show_single_row = everything()
    ) |&gt;
    bold_p()
}

plan(multisession, workers = min(parallel::detectCores() - 2, 10))
uni_model_list &lt;- future_map(predictor_list, fit_univariate_regression)
table_uni_list &lt;- future_map(uni_model_list, arrange_univariate_regression)
</code>
<code language="r script">plan(sequential)

table_uni &lt;- tbl_stack(table_uni_list)
</code>
<sec id="nb-code-cell-3-output-0-nb-2" specific-use="notebook-output">
<preformat>── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──</preformat>
</sec>
<sec id="nb-code-cell-3-output-1-nb-2" specific-use="notebook-output">
<preformat>✔ broom        1.0.5      ✔ rsample      1.2.0 
✔ dials        1.2.1      ✔ tune         1.2.0 
✔ infer        1.0.6      ✔ workflows    1.1.4 
✔ modeldata    1.3.0      ✔ workflowsets 1.1.0 
✔ parsnip      1.2.0      ✔ yardstick    1.3.0 
✔ recipes      1.0.10     </preformat>
</sec>
<sec id="nb-code-cell-3-output-2-nb-2" specific-use="notebook-output">
<preformat>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ recipes::all_double()  masks gtsummary::all_double()
✖ recipes::all_factor()  masks gtsummary::all_factor()
✖ recipes::all_integer() masks gtsummary::all_integer()
✖ recipes::all_logical() masks gtsummary::all_logical()
✖ recipes::all_numeric() masks gtsummary::all_numeric()
✖ scales::discard()      masks purrr::discard()
✖ dplyr::filter()        masks stats::filter()
✖ recipes::fixed()       masks stringr::fixed()
✖ dplyr::lag()           masks stats::lag()
✖ yardstick::spec()      masks readr::spec()
✖ recipes::step()        masks stats::step()
• Use suppressPackageStartupMessages() to eliminate package startup messages</preformat>
</sec>
<sec id="nb-code-cell-3-output-3-nb-2" specific-use="notebook-output">
<preformat>Loading required package: future</preformat>
</sec>
<sec id="nb-code-cell-3-output-4-nb-2" specific-use="notebook-output">
<preformat>Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`</preformat>
</sec>
<sec id="nb-code-cell-3-output-5-nb-2" specific-use="notebook-output">
<preformat>Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`</preformat>
</sec>
<sec id="nb-code-cell-3-output-6-nb-2" specific-use="notebook-output">
<preformat>Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`
Extracting {parsnip} model fit with `tbl_regression(x = x$fit, ...)`</preformat>
</sec>
</sec>
<p>Print and save results.</p>
<sec id="nb-code-cell-4-nb-2" specific-use="notebook-code">
<code language="r script">table_descriptive &lt;- tbl_merge(
  list(table_stats, table_uni),
  tab_spanner = c(
    &quot;**Thrombocytopenia Status**&quot;,
    &quot;**Univariate Regression**&quot;
  )
)

table_descriptive
</code>
<table-wrap>
  <table>
    <colgroup>
      <col width="14%" />
      <col width="14%" />
      <col width="14%" />
      <col width="14%" />
      <col width="14%" />
      <col width="14%" />
      <col width="14%" />
    </colgroup>
    <thead>
      <tr>
        <th rowspan="2" id="U003CstrongU003ECharacteristicU003CU002FstrongU003E-nb-2" scope="col"><bold>Characteristic</bold></th>
        <th colspan="3" id="U003CstrongU003EThrombocytopeniaU0020StatusU003CU002FstrongU003E-nb-2" scope="colgroup"><named-content content-type="gt_column_spanner"><bold>Thrombocytopenia
        Status</bold></named-content></th>
        <th colspan="3" id="U003CstrongU003EUnivariateU0020RegressionU003CU002FstrongU003E-nb-2" scope="colgroup"><named-content content-type="gt_column_spanner"><bold>Univariate
        Regression</bold></named-content></th>
      </tr>
      <tr>
        <th id="U003CstrongU003EOverallU003CU002FstrongU003EU002CU0020NU0020U003DU0020816U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>Overall</bold>,
        N =
        816<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003EFALSEU003CU002FstrongU003EU002CU0020NU0020U003DU0020552U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>FALSE</bold>,
        N =
        552<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003ETRUEU003CU002FstrongU003EU002CU0020NU0020U003DU0020264U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>TRUE</bold>,
        N =
        264<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003EORU003CU002FstrongU003EU003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E2U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>OR</bold><named-content content-type="gt_footnote_marks"><sup>2</sup></named-content></th>
        <th id="U003CstrongU003E95U0025U0020CIU003CU002FstrongU003EU003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E2U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>95%
        CI</bold><named-content content-type="gt_footnote_marks"><sup>2</sup></named-content></th>
        <th id="U003CstrongU003Ep-valueU003CU002FstrongU003E-nb-2" scope="col"><bold>p-value</bold></th>
      </tr>
    </thead>
    <tfoot>
      <tr>
        <td colspan="7"><named-content content-type="gt_footnote_marks"><sup>1</sup></named-content>
        Median (IQR); n (%)</td>
      </tr>
      <tr>
        <td colspan="7"><named-content content-type="gt_footnote_marks"><sup>2</sup></named-content>
        OR = Odds Ratio, CI = Confidence Interval</td>
      </tr>
    </tfoot>
    <tbody>
      <tr>
        <td headers="label" style="font-weight: bold">patient_age</td>
        <td headers="stat_0_1">62 (50 - 73)</td>
        <td headers="stat_1_1">61 (47 - 72)</td>
        <td headers="stat_2_1">64 (54 - 74)</td>
        <td headers="estimate_2">1.02</td>
        <td headers="ci_2">1.01, 1.03</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">patient_sex</td>
        <td headers="stat_0_1">306 (38%)</td>
        <td headers="stat_1_1">206 (37%)</td>
        <td headers="stat_2_1">100 (38%)</td>
        <td headers="estimate_2">1.02</td>
        <td headers="ci_2">0.76, 1.38</td>
        <td headers="p.value_2">0.9</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_dose_per_weight</td>
        <td headers="stat_0_1">21.8 (20.0 - 24.0)</td>
        <td headers="stat_1_1">21.8 (20.0 - 24.0)</td>
        <td headers="stat_2_1">21.8 (19.4 - 24.6)</td>
        <td headers="estimate_2">0.99</td>
        <td headers="ci_2">0.96, 1.03</td>
        <td headers="p.value_2">0.8</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_CLCR</td>
        <td headers="stat_0_1">48 (21 - 84)</td>
        <td headers="stat_1_1">55 (26 - 88)</td>
        <td headers="stat_2_1">32 (15 - 64)</td>
        <td headers="estimate_2">0.99</td>
        <td headers="ci_2">0.99, 0.99</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">dept_ER</td>
        <td headers="stat_0_1">140 (17%)</td>
        <td headers="stat_1_1">95 (17%)</td>
        <td headers="stat_2_1">45 (17%)</td>
        <td headers="estimate_2">0.99</td>
        <td headers="ci_2">0.67, 1.45</td>
        <td headers="p.value_2">&gt;0.9</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">dept_ICU</td>
        <td headers="stat_0_1">390 (48%)</td>
        <td headers="stat_1_1">240 (43%)</td>
        <td headers="stat_2_1">150 (57%)</td>
        <td headers="estimate_2">1.71</td>
        <td headers="ci_2">1.27, 2.30</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_HGB</td>
        <td headers="stat_0_1">102 (89 - 120)</td>
        <td headers="stat_1_1">105 (91 - 121)</td>
        <td headers="stat_2_1">98 (85 - 117)</td>
        <td headers="estimate_2">0.99</td>
        <td headers="ci_2">0.98, 0.99</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_WBC</td>
        <td headers="stat_0_1">12 (8 - 17)</td>
        <td headers="stat_1_1">12 (8 - 17)</td>
        <td headers="stat_2_1">12 (8 - 18)</td>
        <td headers="estimate_2">1.01</td>
        <td headers="ci_2">0.99, 1.03</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_PLT</td>
        <td headers="stat_0_1">206 (143 - 288)</td>
        <td headers="stat_1_1">234 (167 - 309)</td>
        <td headers="stat_2_1">154 (103 - 211)</td>
        <td headers="estimate_2">0.99</td>
        <td headers="ci_2">0.99, 0.99</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_duration</td>
        <td headers="stat_0_1">9.0 (6.0 - 14.0)</td>
        <td headers="stat_1_1">9.0 (6.0 - 13.0)</td>
        <td headers="stat_2_1">10.0 (6.0 - 14.0)</td>
        <td headers="estimate_2">1.03</td>
        <td headers="ci_2">1.01, 1.06</td>
        <td headers="p.value_2" style="font-weight: bold">0.017</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_ETI</td>
        <td headers="stat_0_1">386 (47%)</td>
        <td headers="stat_1_1">230 (42%)</td>
        <td headers="stat_2_1">156 (59%)</td>
        <td headers="estimate_2">2.02</td>
        <td headers="ci_2">1.50, 2.73</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_CVC</td>
        <td headers="stat_0_1">423 (52%)</td>
        <td headers="stat_1_1">246 (45%)</td>
        <td headers="stat_2_1">177 (67%)</td>
        <td headers="estimate_2">2.53</td>
        <td headers="ci_2">1.87, 3.45</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_IHD</td>
        <td headers="stat_0_1">111 (14%)</td>
        <td headers="stat_1_1">64 (12%)</td>
        <td headers="stat_2_1">47 (18%)</td>
        <td headers="estimate_2">1.65</td>
        <td headers="ci_2">1.09, 2.48</td>
        <td headers="p.value_2" style="font-weight: bold">0.016</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_CRRT</td>
        <td headers="stat_0_1">147 (18%)</td>
        <td headers="stat_1_1">64 (12%)</td>
        <td headers="stat_2_1">83 (31%)</td>
        <td headers="estimate_2">3.50</td>
        <td headers="ci_2">2.42, 5.07</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_HTN</td>
        <td headers="stat_0_1">333 (41%)</td>
        <td headers="stat_1_1">218 (39%)</td>
        <td headers="stat_2_1">115 (44%)</td>
        <td headers="estimate_2">1.18</td>
        <td headers="ci_2">0.88, 1.59</td>
        <td headers="p.value_2">0.3</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_DM</td>
        <td headers="stat_0_1">222 (27%)</td>
        <td headers="stat_1_1">150 (27%)</td>
        <td headers="stat_2_1">72 (27%)</td>
        <td headers="estimate_2">1.01</td>
        <td headers="ci_2">0.72, 1.39</td>
        <td headers="p.value_2">&gt;0.9</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_HF</td>
        <td headers="stat_0_1">225 (28%)</td>
        <td headers="stat_1_1">131 (24%)</td>
        <td headers="stat_2_1">94 (36%)</td>
        <td headers="estimate_2">1.78</td>
        <td headers="ci_2">1.29, 2.44</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_angina</td>
        <td headers="stat_0_1">32 (3.9%)</td>
        <td headers="stat_1_1">19 (3.4%)</td>
        <td headers="stat_2_1">13 (4.9%)</td>
        <td headers="estimate_2">1.45</td>
        <td headers="ci_2">0.69, 2.96</td>
        <td headers="p.value_2">0.3</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_cirr</td>
        <td headers="stat_0_1">48 (5.9%)</td>
        <td headers="stat_1_1">20 (3.6%)</td>
        <td headers="stat_2_1">28 (11%)</td>
        <td headers="estimate_2">3.16</td>
        <td headers="ci_2">1.75, 5.79</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_COPD</td>
        <td headers="stat_0_1">39 (4.8%)</td>
        <td headers="stat_1_1">25 (4.5%)</td>
        <td headers="stat_2_1">14 (5.3%)</td>
        <td headers="estimate_2">1.18</td>
        <td headers="ci_2">0.59, 2.28</td>
        <td headers="p.value_2">0.6</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_CVA</td>
        <td headers="stat_0_1">93 (11%)</td>
        <td headers="stat_1_1">64 (12%)</td>
        <td headers="stat_2_1">29 (11%)</td>
        <td headers="estimate_2">0.94</td>
        <td headers="ci_2">0.58, 1.49</td>
        <td headers="p.value_2">0.8</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_MI</td>
        <td headers="stat_0_1">20 (2.5%)</td>
        <td headers="stat_1_1">15 (2.7%)</td>
        <td headers="stat_2_1">5 (1.9%)</td>
        <td headers="estimate_2">0.69</td>
        <td headers="ci_2">0.22, 1.81</td>
        <td headers="p.value_2">0.5</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_K</td>
        <td headers="stat_0_1">67 (8.2%)</td>
        <td headers="stat_1_1">44 (8.0%)</td>
        <td headers="stat_2_1">23 (8.7%)</td>
        <td headers="estimate_2">1.10</td>
        <td headers="ci_2">0.64, 1.85</td>
        <td headers="p.value_2">0.7</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_hematological</td>
        <td headers="stat_0_1">46 (5.6%)</td>
        <td headers="stat_1_1">27 (4.9%)</td>
        <td headers="stat_2_1">19 (7.2%)</td>
        <td headers="estimate_2">1.51</td>
        <td headers="ci_2">0.81, 2.75</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_hema</td>
        <td headers="stat_0_1">61 (7.5%)</td>
        <td headers="stat_1_1">37 (6.7%)</td>
        <td headers="stat_2_1">24 (9.1%)</td>
        <td headers="estimate_2">1.39</td>
        <td headers="ci_2">0.81, 2.36</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_sepsis</td>
        <td headers="stat_0_1">134 (16%)</td>
        <td headers="stat_1_1">66 (12%)</td>
        <td headers="stat_2_1">68 (26%)</td>
        <td headers="estimate_2">2.55</td>
        <td headers="ci_2">1.75, 3.73</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_CAP</td>
        <td headers="stat_0_1">118 (14%)</td>
        <td headers="stat_1_1">70 (13%)</td>
        <td headers="stat_2_1">48 (18%)</td>
        <td headers="estimate_2">1.53</td>
        <td headers="ci_2">1.02, 2.28</td>
        <td headers="p.value_2" style="font-weight: bold">0.038</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_HAP</td>
        <td headers="stat_0_1">375 (46%)</td>
        <td headers="stat_1_1">255 (46%)</td>
        <td headers="stat_2_1">120 (45%)</td>
        <td headers="estimate_2">0.97</td>
        <td headers="ci_2">0.72, 1.30</td>
        <td headers="p.value_2">0.8</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_SSTI</td>
        <td headers="stat_0_1">133 (16%)</td>
        <td headers="stat_1_1">100 (18%)</td>
        <td headers="stat_2_1">33 (13%)</td>
        <td headers="estimate_2">0.65</td>
        <td headers="ci_2">0.42, 0.98</td>
        <td headers="p.value_2" style="font-weight: bold">0.043</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_CNS</td>
        <td headers="stat_0_1">68 (8.3%)</td>
        <td headers="stat_1_1">46 (8.3%)</td>
        <td headers="stat_2_1">22 (8.3%)</td>
        <td headers="estimate_2">1.00</td>
        <td headers="ci_2">0.58, 1.68</td>
        <td headers="p.value_2">&gt;0.9</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_IAI</td>
        <td headers="stat_0_1">50 (6.1%)</td>
        <td headers="stat_1_1">34 (6.2%)</td>
        <td headers="stat_2_1">16 (6.1%)</td>
        <td headers="estimate_2">0.98</td>
        <td headers="ci_2">0.52, 1.79</td>
        <td headers="p.value_2">&gt;0.9</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_UTI</td>
        <td headers="stat_0_1">53 (6.5%)</td>
        <td headers="stat_1_1">37 (6.7%)</td>
        <td headers="stat_2_1">16 (6.1%)</td>
        <td headers="estimate_2">0.90</td>
        <td headers="ci_2">0.48, 1.62</td>
        <td headers="p.value_2">0.7</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_BJI</td>
        <td headers="stat_0_1">11 (1.3%)</td>
        <td headers="stat_1_1">10 (1.8%)</td>
        <td headers="stat_2_1">1 (0.4%)</td>
        <td headers="estimate_2">0.21</td>
        <td headers="ci_2">0.01, 1.08</td>
        <td headers="p.value_2">0.13</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_septicemia</td>
        <td headers="stat_0_1">237 (29%)</td>
        <td headers="stat_1_1">148 (27%)</td>
        <td headers="stat_2_1">89 (34%)</td>
        <td headers="estimate_2">1.39</td>
        <td headers="ci_2">1.01, 1.90</td>
        <td headers="p.value_2" style="font-weight: bold">0.043</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_aspirin</td>
        <td headers="stat_0_1">47 (5.8%)</td>
        <td headers="stat_1_1">30 (5.4%)</td>
        <td headers="stat_2_1">17 (6.4%)</td>
        <td headers="estimate_2">1.20</td>
        <td headers="ci_2">0.64, 2.19</td>
        <td headers="p.value_2">0.6</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_diclofenac</td>
        <td headers="stat_0_1">27 (3.3%)</td>
        <td headers="stat_1_1">20 (3.6%)</td>
        <td headers="stat_2_1">7 (2.7%)</td>
        <td headers="estimate_2">0.72</td>
        <td headers="ci_2">0.28, 1.66</td>
        <td headers="p.value_2">0.5</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_ibuprofen</td>
        <td headers="stat_0_1">26 (3.2%)</td>
        <td headers="stat_1_1">15 (2.7%)</td>
        <td headers="stat_2_1">11 (4.2%)</td>
        <td headers="estimate_2">1.56</td>
        <td headers="ci_2">0.69, 3.42</td>
        <td headers="p.value_2">0.3</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_paracetamol</td>
        <td headers="stat_0_1">357 (44%)</td>
        <td headers="stat_1_1">246 (45%)</td>
        <td headers="stat_2_1">111 (42%)</td>
        <td headers="estimate_2">0.90</td>
        <td headers="ci_2">0.67, 1.21</td>
        <td headers="p.value_2">0.5</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_penicillin</td>
        <td headers="stat_0_1">123 (15%)</td>
        <td headers="stat_1_1">78 (14%)</td>
        <td headers="stat_2_1">45 (17%)</td>
        <td headers="estimate_2">1.25</td>
        <td headers="ci_2">0.83, 1.86</td>
        <td headers="p.value_2">0.3</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_cepha</td>
        <td headers="stat_0_1">208 (25%)</td>
        <td headers="stat_1_1">150 (27%)</td>
        <td headers="stat_2_1">58 (22%)</td>
        <td headers="estimate_2">0.75</td>
        <td headers="ci_2">0.53, 1.06</td>
        <td headers="p.value_2">0.11</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_carbapenem</td>
        <td headers="stat_0_1">588 (72%)</td>
        <td headers="stat_1_1">385 (70%)</td>
        <td headers="stat_2_1">203 (77%)</td>
        <td headers="estimate_2">1.44</td>
        <td headers="ci_2">1.03, 2.04</td>
        <td headers="p.value_2" style="font-weight: bold">0.034</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_cotrimoxazol</td>
        <td headers="stat_0_1">67 (8.2%)</td>
        <td headers="stat_1_1">39 (7.1%)</td>
        <td headers="stat_2_1">28 (11%)</td>
        <td headers="estimate_2">1.56</td>
        <td headers="ci_2">0.93, 2.59</td>
        <td headers="p.value_2">0.087</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_vancomycin</td>
        <td headers="stat_0_1">67 (8.2%)</td>
        <td headers="stat_1_1">41 (7.4%)</td>
        <td headers="stat_2_1">26 (9.8%)</td>
        <td headers="estimate_2">1.36</td>
        <td headers="ci_2">0.81, 2.27</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_levofloxacin</td>
        <td headers="stat_0_1">250 (31%)</td>
        <td headers="stat_1_1">162 (29%)</td>
        <td headers="stat_2_1">88 (33%)</td>
        <td headers="estimate_2">1.20</td>
        <td headers="ci_2">0.88, 1.65</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_teicoplanin</td>
        <td headers="stat_0_1">37 (4.5%)</td>
        <td headers="stat_1_1">23 (4.2%)</td>
        <td headers="stat_2_1">14 (5.3%)</td>
        <td headers="estimate_2">1.29</td>
        <td headers="ci_2">0.64, 2.52</td>
        <td headers="p.value_2">0.5</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_ethambutol</td>
        <td headers="stat_0_1">8 (1.0%)</td>
        <td headers="stat_1_1">5 (0.9%)</td>
        <td headers="stat_2_1">3 (1.1%)</td>
        <td headers="estimate_2">1.26</td>
        <td headers="ci_2">0.26, 5.16</td>
        <td headers="p.value_2">0.8</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_pyrazinamid</td>
        <td headers="stat_0_1">12 (1.5%)</td>
        <td headers="stat_1_1">6 (1.1%)</td>
        <td headers="stat_2_1">6 (2.3%)</td>
        <td headers="estimate_2">2.12</td>
        <td headers="ci_2">0.66, 6.83</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_rifampin</td>
        <td headers="stat_0_1">15 (1.8%)</td>
        <td headers="stat_1_1">8 (1.4%)</td>
        <td headers="stat_2_1">7 (2.7%)</td>
        <td headers="estimate_2">1.85</td>
        <td headers="ci_2">0.64, 5.21</td>
        <td headers="p.value_2">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_heparin</td>
        <td headers="stat_0_1">207 (25%)</td>
        <td headers="stat_1_1">109 (20%)</td>
        <td headers="stat_2_1">98 (37%)</td>
        <td headers="estimate_2">2.40</td>
        <td headers="ci_2">1.73, 3.33</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_clopidogrel</td>
        <td headers="stat_0_1">40 (4.9%)</td>
        <td headers="stat_1_1">30 (5.4%)</td>
        <td headers="stat_2_1">10 (3.8%)</td>
        <td headers="estimate_2">0.69</td>
        <td headers="ci_2">0.31, 1.38</td>
        <td headers="p.value_2">0.3</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_enoxaparin</td>
        <td headers="stat_0_1">352 (43%)</td>
        <td headers="stat_1_1">235 (43%)</td>
        <td headers="stat_2_1">117 (44%)</td>
        <td headers="estimate_2">1.07</td>
        <td headers="ci_2">0.80, 1.44</td>
        <td headers="p.value_2">0.6</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_dexamethason</td>
        <td headers="stat_0_1">106 (13%)</td>
        <td headers="stat_1_1">72 (13%)</td>
        <td headers="stat_2_1">34 (13%)</td>
        <td headers="estimate_2">0.99</td>
        <td headers="ci_2">0.63, 1.51</td>
        <td headers="p.value_2">&gt;0.9</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_amiodaron</td>
        <td headers="stat_0_1">36 (4.4%)</td>
        <td headers="stat_1_1">17 (3.1%)</td>
        <td headers="stat_2_1">19 (7.2%)</td>
        <td headers="estimate_2">2.44</td>
        <td headers="ci_2">1.24, 4.82</td>
        <td headers="p.value_2" style="font-weight: bold">0.009</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_furosemid</td>
        <td headers="stat_0_1">436 (53%)</td>
        <td headers="stat_1_1">260 (47%)</td>
        <td headers="stat_2_1">176 (67%)</td>
        <td headers="estimate_2">2.25</td>
        <td headers="ci_2">1.66, 3.06</td>
        <td headers="p.value_2" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_haloperidol</td>
        <td headers="stat_0_1">53 (6.5%)</td>
        <td headers="stat_1_1">36 (6.5%)</td>
        <td headers="stat_2_1">17 (6.4%)</td>
        <td headers="estimate_2">0.99</td>
        <td headers="ci_2">0.53, 1.76</td>
        <td headers="p.value_2">&gt;0.9</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_valproic</td>
        <td headers="stat_0_1">32 (3.9%)</td>
        <td headers="stat_1_1">23 (4.2%)</td>
        <td headers="stat_2_1">9 (3.4%)</td>
        <td headers="estimate_2">0.81</td>
        <td headers="ci_2">0.35, 1.72</td>
        <td headers="p.value_2">0.6</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_aceclofenac</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_naproxen</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_daptomycin</td>
        <td headers="stat_0_1">1 (0.1%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">1 (0.4%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_cetirizin</td>
        <td headers="stat_0_1">6 (0.7%)</td>
        <td headers="stat_1_1">5 (0.9%)</td>
        <td headers="stat_2_1">1 (0.4%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_simvas</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_bisoprolol</td>
        <td headers="stat_0_1">6 (0.7%)</td>
        <td headers="stat_1_1">4 (0.7%)</td>
        <td headers="stat_2_1">2 (0.8%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_diltiazem</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_eptifibatid</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_quinidin</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_carbamazepin</td>
        <td headers="stat_0_1">8 (1.0%)</td>
        <td headers="stat_1_1">8 (1.4%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_phenytoin</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_mirtazapin</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_quetiapin</td>
        <td headers="stat_0_1">4 (0.5%)</td>
        <td headers="stat_1_1">4 (0.7%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_ondansetron</td>
        <td headers="stat_0_1">6 (0.7%)</td>
        <td headers="stat_1_1">4 (0.7%)</td>
        <td headers="stat_2_1">2 (0.8%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_palonosetron</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_oseltamivir</td>
        <td headers="stat_0_1">2 (0.2%)</td>
        <td headers="stat_1_1">1 (0.2%)</td>
        <td headers="stat_2_1">1 (0.4%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_quinin</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_pembrolizumab</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_trastuzumab</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_atezolizumab</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_durvalumab</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_IVIG</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_tacrolimus</td>
        <td headers="stat_0_1">1 (0.1%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">1 (0.4%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_fluorouracil</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_irinotecan</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_leucovorin</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_oxaliplatin</td>
        <td headers="stat_0_1">0 (0%)</td>
        <td headers="stat_1_1">0 (0%)</td>
        <td headers="stat_2_1">0 (0%)</td>
        <td headers="estimate_2"><break/></td>
        <td headers="ci_2"><break/></td>
        <td headers="p.value_2"><break/></td>
      </tr>
    </tbody>
  </table>
</table-wrap>
<code language="r script">save(table_descriptive, file = &quot;data/results/table-descriptive.rda&quot;)
</code>
</sec>
<p>Summary statistics, by site.</p>
<sec id="nb-code-cell-5-nb-2" specific-use="notebook-code">
<code language="r script">table_descriptive_site &lt;- data_patient_complete |&gt;
  select(
    all_of(predictor_list), starts_with(&quot;comed&quot;), flag_ADR_TP_ID, site, ADR_CTCAE_max, ADR_onset_first, ADR_PLT_ratio
  ) |&gt;
  tbl_summary(
    by = site,
    statistic = list(all_continuous() ~ &quot;{median} ({p25} - {p75})&quot;),
    missing = &quot;no&quot;
  ) |&gt;
  add_overall() |&gt;
  bold_labels() |&gt;
  add_p(
    test.args = all_tests(&quot;fisher.test&quot;) ~ list(simulate.p.value = TRUE)
  ) |&gt;
  bold_p()
</code>
<code language="r script">table_descriptive_site
</code>
<table-wrap>
  <table>
    <colgroup>
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
      <col width="11%" />
    </colgroup>
    <thead>
      <tr>
        <th id="U003CstrongU003ECharacteristicU003CU002FstrongU003E-nb-2" scope="col"><bold>Characteristic</bold></th>
        <th id="U003CstrongU003EOverallU003CU002FstrongU003EU002CU0020NU0020U003DU0020816U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>Overall</bold>,
        N =
        816<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003EBM1U003CU002FstrongU003EU002CU0020NU0020U003DU0020125U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>BM1</bold>,
        N =
        125<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003EBM2U003CU002FstrongU003EU002CU0020NU0020U003DU002077U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>BM2</bold>,
        N =
        77<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003END1U003CU002FstrongU003EU002CU0020NU0020U003DU0020179U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>ND1</bold>,
        N =
        179<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003END2U003CU002FstrongU003EU002CU0020NU0020U003DU0020116U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>ND2</bold>,
        N =
        116<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003ETN1U003CU002FstrongU003EU002CU0020NU0020U003DU0020100U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>TN1</bold>,
        N =
        100<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003ETN2U003CU002FstrongU003EU002CU0020NU0020U003DU0020219U003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>TN2</bold>,
        N =
        219<named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        <th id="U003CstrongU003Ep-valueU003CU002FstrongU003EU003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E2U003CU002FsupU003EU003CU002FspanU003E-nb-2" scope="col"><bold>p-value</bold><named-content content-type="gt_footnote_marks"><sup>2</sup></named-content></th>
      </tr>
    </thead>
    <tfoot>
      <tr>
        <td colspan="9"><named-content content-type="gt_footnote_marks"><sup>1</sup></named-content>
        Median (IQR); n (%)</td>
      </tr>
      <tr>
        <td colspan="9"><named-content content-type="gt_footnote_marks"><sup>2</sup></named-content>
        Kruskal-Wallis rank sum test; Pearson’s Chi-squared test;
        Fisher’s Exact Test for Count Data with simulated p-value (based
        on 2000 replicates)</td>
      </tr>
    </tfoot>
    <tbody>
      <tr>
        <td headers="label" style="font-weight: bold">patient_age</td>
        <td headers="stat_0">62 (50 - 73)</td>
        <td headers="stat_1">58 (43 - 69)</td>
        <td headers="stat_2">60 (45 - 72)</td>
        <td headers="stat_3">60 (45 - 68)</td>
        <td headers="stat_4">59 (46 - 68)</td>
        <td headers="stat_5">69 (60 - 78)</td>
        <td headers="stat_6">66 (58 - 78)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">patient_sex</td>
        <td headers="stat_0">306 (38%)</td>
        <td headers="stat_1">54 (43%)</td>
        <td headers="stat_2">27 (35%)</td>
        <td headers="stat_3">73 (41%)</td>
        <td headers="stat_4">28 (24%)</td>
        <td headers="stat_5">48 (48%)</td>
        <td headers="stat_6">76 (35%)</td>
        <td headers="p.value" style="font-weight: bold">0.004</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_dose_per_weight</td>
        <td headers="stat_0">21.8 (20.0 - 24.0)</td>
        <td headers="stat_1">22.6 (20.0 - 25.5)</td>
        <td headers="stat_2">21.4 (19.0 - 24.0)</td>
        <td headers="stat_3">21.4 (19.4 - 24.0)</td>
        <td headers="stat_4">21.8 (20.0 - 24.0)</td>
        <td headers="stat_5">24.0 (20.0 - 24.6)</td>
        <td headers="stat_6">21.8 (19.7 - 24.0)</td>
        <td headers="p.value" style="font-weight: bold">0.028</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_CLCR</td>
        <td headers="stat_0">48 (21 - 84)</td>
        <td headers="stat_1">50 (24 - 80)</td>
        <td headers="stat_2">40 (17 - 86)</td>
        <td headers="stat_3">70 (41 - 104)</td>
        <td headers="stat_4">60 (27 - 95)</td>
        <td headers="stat_5">29 (14 - 54)</td>
        <td headers="stat_6">35 (17 - 67)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">dept_ER</td>
        <td headers="stat_0">140 (17%)</td>
        <td headers="stat_1">7 (5.6%)</td>
        <td headers="stat_2">9 (12%)</td>
        <td headers="stat_3">67 (37%)</td>
        <td headers="stat_4">15 (13%)</td>
        <td headers="stat_5">16 (16%)</td>
        <td headers="stat_6">26 (12%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">dept_ICU</td>
        <td headers="stat_0">390 (48%)</td>
        <td headers="stat_1">10 (8.0%)</td>
        <td headers="stat_2">23 (30%)</td>
        <td headers="stat_3">73 (41%)</td>
        <td headers="stat_4">42 (36%)</td>
        <td headers="stat_5">77 (77%)</td>
        <td headers="stat_6">165 (75%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_HGB</td>
        <td headers="stat_0">102 (89 - 120)</td>
        <td headers="stat_1">105 (91 - 124)</td>
        <td headers="stat_2">99 (83 - 118)</td>
        <td headers="stat_3">105 (89 - 123)</td>
        <td headers="stat_4">100 (88 - 118)</td>
        <td headers="stat_5">99 (89 - 116)</td>
        <td headers="stat_6">104 (91 - 120)</td>
        <td headers="p.value">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_WBC</td>
        <td headers="stat_0">12 (8 - 17)</td>
        <td headers="stat_1">11 (7 - 16)</td>
        <td headers="stat_2">11 (7 - 17)</td>
        <td headers="stat_3">12 (8 - 18)</td>
        <td headers="stat_4">11 (7 - 15)</td>
        <td headers="stat_5">12 (8 - 18)</td>
        <td headers="stat_6">13 (9 - 18)</td>
        <td headers="p.value" style="font-weight: bold">0.023</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">baseline_PLT</td>
        <td headers="stat_0">206 (143 - 288)</td>
        <td headers="stat_1">195 (139 - 247)</td>
        <td headers="stat_2">234 (160 - 318)</td>
        <td headers="stat_3">207 (129 - 293)</td>
        <td headers="stat_4">225 (127 - 310)</td>
        <td headers="stat_5">172 (122 - 245)</td>
        <td headers="stat_6">225 (161 - 299)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">LZD_duration</td>
        <td headers="stat_0">9.0 (6.0 - 14.0)</td>
        <td headers="stat_1">8.0 (6.0 - 13.0)</td>
        <td headers="stat_2">10.0 (6.0 - 14.0)</td>
        <td headers="stat_3">10.0 (6.0 - 14.0)</td>
        <td headers="stat_4">9.0 (6.0 - 12.0)</td>
        <td headers="stat_5">11.0 (6.0 - 15.0)</td>
        <td headers="stat_6">9.0 (6.0 - 12.0)</td>
        <td headers="p.value">0.3</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_ETI</td>
        <td headers="stat_0">386 (47%)</td>
        <td headers="stat_1">63 (50%)</td>
        <td headers="stat_2">30 (39%)</td>
        <td headers="stat_3">111 (62%)</td>
        <td headers="stat_4">49 (42%)</td>
        <td headers="stat_5">48 (48%)</td>
        <td headers="stat_6">85 (39%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_CVC</td>
        <td headers="stat_0">423 (52%)</td>
        <td headers="stat_1">75 (60%)</td>
        <td headers="stat_2">30 (39%)</td>
        <td headers="stat_3">99 (55%)</td>
        <td headers="stat_4">48 (41%)</td>
        <td headers="stat_5">50 (50%)</td>
        <td headers="stat_6">121 (55%)</td>
        <td headers="p.value" style="font-weight: bold">0.008</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_IHD</td>
        <td headers="stat_0">111 (14%)</td>
        <td headers="stat_1">17 (14%)</td>
        <td headers="stat_2">16 (21%)</td>
        <td headers="stat_3">9 (5.0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">27 (27%)</td>
        <td headers="stat_6">42 (19%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">invasive_CRRT</td>
        <td headers="stat_0">147 (18%)</td>
        <td headers="stat_1">17 (14%)</td>
        <td headers="stat_2">9 (12%)</td>
        <td headers="stat_3">52 (29%)</td>
        <td headers="stat_4">5 (4.3%)</td>
        <td headers="stat_5">20 (20%)</td>
        <td headers="stat_6">44 (20%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_HTN</td>
        <td headers="stat_0">333 (41%)</td>
        <td headers="stat_1">42 (34%)</td>
        <td headers="stat_2">31 (40%)</td>
        <td headers="stat_3">49 (27%)</td>
        <td headers="stat_4">28 (24%)</td>
        <td headers="stat_5">59 (59%)</td>
        <td headers="stat_6">124 (57%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_DM</td>
        <td headers="stat_0">222 (27%)</td>
        <td headers="stat_1">28 (22%)</td>
        <td headers="stat_2">24 (31%)</td>
        <td headers="stat_3">28 (16%)</td>
        <td headers="stat_4">27 (23%)</td>
        <td headers="stat_5">31 (31%)</td>
        <td headers="stat_6">84 (38%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_HF</td>
        <td headers="stat_0">225 (28%)</td>
        <td headers="stat_1">55 (44%)</td>
        <td headers="stat_2">11 (14%)</td>
        <td headers="stat_3">14 (7.8%)</td>
        <td headers="stat_4">7 (6.0%)</td>
        <td headers="stat_5">70 (70%)</td>
        <td headers="stat_6">68 (31%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_angina</td>
        <td headers="stat_0">32 (3.9%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">1 (0.6%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">13 (13%)</td>
        <td headers="stat_6">18 (8.2%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_cirr</td>
        <td headers="stat_0">48 (5.9%)</td>
        <td headers="stat_1">6 (4.8%)</td>
        <td headers="stat_2">1 (1.3%)</td>
        <td headers="stat_3">10 (5.6%)</td>
        <td headers="stat_4">5 (4.3%)</td>
        <td headers="stat_5">12 (12%)</td>
        <td headers="stat_6">14 (6.4%)</td>
        <td headers="p.value">0.086</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_COPD</td>
        <td headers="stat_0">39 (4.8%)</td>
        <td headers="stat_1">3 (2.4%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">2 (1.1%)</td>
        <td headers="stat_4">2 (1.7%)</td>
        <td headers="stat_5">9 (9.0%)</td>
        <td headers="stat_6">23 (11%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_CVA</td>
        <td headers="stat_0">93 (11%)</td>
        <td headers="stat_1">19 (15%)</td>
        <td headers="stat_2">11 (14%)</td>
        <td headers="stat_3">6 (3.4%)</td>
        <td headers="stat_4">4 (3.4%)</td>
        <td headers="stat_5">16 (16%)</td>
        <td headers="stat_6">37 (17%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_MI</td>
        <td headers="stat_0">20 (2.5%)</td>
        <td headers="stat_1">10 (8.0%)</td>
        <td headers="stat_2">3 (3.9%)</td>
        <td headers="stat_3">2 (1.1%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">1 (1.0%)</td>
        <td headers="stat_6">4 (1.8%)</td>
        <td headers="p.value" style="font-weight: bold">0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_K</td>
        <td headers="stat_0">67 (8.2%)</td>
        <td headers="stat_1">5 (4.0%)</td>
        <td headers="stat_2">5 (6.5%)</td>
        <td headers="stat_3">8 (4.5%)</td>
        <td headers="stat_4">6 (5.2%)</td>
        <td headers="stat_5">11 (11%)</td>
        <td headers="stat_6">32 (15%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_hematological</td>
        <td headers="stat_0">46 (5.6%)</td>
        <td headers="stat_1">9 (7.2%)</td>
        <td headers="stat_2">12 (16%)</td>
        <td headers="stat_3">10 (5.6%)</td>
        <td headers="stat_4">5 (4.3%)</td>
        <td headers="stat_5">8 (8.0%)</td>
        <td headers="stat_6">2 (0.9%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comorb_hema</td>
        <td headers="stat_0">61 (7.5%)</td>
        <td headers="stat_1">13 (10%)</td>
        <td headers="stat_2">17 (22%)</td>
        <td headers="stat_3">14 (7.8%)</td>
        <td headers="stat_4">2 (1.7%)</td>
        <td headers="stat_5">13 (13%)</td>
        <td headers="stat_6">2 (0.9%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_sepsis</td>
        <td headers="stat_0">134 (16%)</td>
        <td headers="stat_1">10 (8.0%)</td>
        <td headers="stat_2">14 (18%)</td>
        <td headers="stat_3">16 (8.9%)</td>
        <td headers="stat_4">15 (13%)</td>
        <td headers="stat_5">44 (44%)</td>
        <td headers="stat_6">35 (16%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_CAP</td>
        <td headers="stat_0">118 (14%)</td>
        <td headers="stat_1">7 (5.6%)</td>
        <td headers="stat_2">6 (7.8%)</td>
        <td headers="stat_3">11 (6.1%)</td>
        <td headers="stat_4">1 (0.9%)</td>
        <td headers="stat_5">26 (26%)</td>
        <td headers="stat_6">67 (31%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_HAP</td>
        <td headers="stat_0">375 (46%)</td>
        <td headers="stat_1">38 (30%)</td>
        <td headers="stat_2">33 (43%)</td>
        <td headers="stat_3">93 (52%)</td>
        <td headers="stat_4">59 (51%)</td>
        <td headers="stat_5">52 (52%)</td>
        <td headers="stat_6">100 (46%)</td>
        <td headers="p.value" style="font-weight: bold">0.003</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_SSTI</td>
        <td headers="stat_0">133 (16%)</td>
        <td headers="stat_1">33 (26%)</td>
        <td headers="stat_2">34 (44%)</td>
        <td headers="stat_3">1 (0.6%)</td>
        <td headers="stat_4">4 (3.4%)</td>
        <td headers="stat_5">23 (23%)</td>
        <td headers="stat_6">38 (17%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_CNS</td>
        <td headers="stat_0">68 (8.3%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">5 (6.5%)</td>
        <td headers="stat_3">24 (13%)</td>
        <td headers="stat_4">20 (17%)</td>
        <td headers="stat_5">4 (4.0%)</td>
        <td headers="stat_6">15 (6.8%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_IAI</td>
        <td headers="stat_0">50 (6.1%)</td>
        <td headers="stat_1">8 (6.4%)</td>
        <td headers="stat_2">8 (10%)</td>
        <td headers="stat_3">1 (0.6%)</td>
        <td headers="stat_4">2 (1.7%)</td>
        <td headers="stat_5">12 (12%)</td>
        <td headers="stat_6">19 (8.7%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_UTI</td>
        <td headers="stat_0">53 (6.5%)</td>
        <td headers="stat_1">6 (4.8%)</td>
        <td headers="stat_2">8 (10%)</td>
        <td headers="stat_3">10 (5.6%)</td>
        <td headers="stat_4">5 (4.3%)</td>
        <td headers="stat_5">4 (4.0%)</td>
        <td headers="stat_6">20 (9.1%)</td>
        <td headers="p.value">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_BJI</td>
        <td headers="stat_0">11 (1.3%)</td>
        <td headers="stat_1">3 (2.4%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">2 (1.7%)</td>
        <td headers="stat_5">1 (1.0%)</td>
        <td headers="stat_6">5 (2.3%)</td>
        <td headers="p.value">0.2</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">infect_septicemia</td>
        <td headers="stat_0">237 (29%)</td>
        <td headers="stat_1">35 (28%)</td>
        <td headers="stat_2">24 (31%)</td>
        <td headers="stat_3">57 (32%)</td>
        <td headers="stat_4">60 (52%)</td>
        <td headers="stat_5">7 (7.0%)</td>
        <td headers="stat_6">54 (25%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_aspirin</td>
        <td headers="stat_0">47 (5.8%)</td>
        <td headers="stat_1">8 (6.4%)</td>
        <td headers="stat_2">9 (12%)</td>
        <td headers="stat_3">3 (1.7%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">5 (5.0%)</td>
        <td headers="stat_6">22 (10%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_diclofenac</td>
        <td headers="stat_0">27 (3.3%)</td>
        <td headers="stat_1">24 (19%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">1 (0.9%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">2 (0.9%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_ibuprofen</td>
        <td headers="stat_0">26 (3.2%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">2 (1.7%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">24 (11%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_paracetamol</td>
        <td headers="stat_0">357 (44%)</td>
        <td headers="stat_1">66 (53%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">92 (51%)</td>
        <td headers="stat_4">69 (59%)</td>
        <td headers="stat_5">47 (47%)</td>
        <td headers="stat_6">83 (38%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_penicillin</td>
        <td headers="stat_0">123 (15%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">5 (6.5%)</td>
        <td headers="stat_3">34 (19%)</td>
        <td headers="stat_4">19 (16%)</td>
        <td headers="stat_5">17 (17%)</td>
        <td headers="stat_6">48 (22%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_cepha</td>
        <td headers="stat_0">208 (25%)</td>
        <td headers="stat_1">12 (9.6%)</td>
        <td headers="stat_2">10 (13%)</td>
        <td headers="stat_3">36 (20%)</td>
        <td headers="stat_4">33 (28%)</td>
        <td headers="stat_5">11 (11%)</td>
        <td headers="stat_6">106 (48%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_carbapenem</td>
        <td headers="stat_0">588 (72%)</td>
        <td headers="stat_1">52 (42%)</td>
        <td headers="stat_2">46 (60%)</td>
        <td headers="stat_3">158 (88%)</td>
        <td headers="stat_4">78 (67%)</td>
        <td headers="stat_5">80 (80%)</td>
        <td headers="stat_6">174 (79%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_cotrimoxazol</td>
        <td headers="stat_0">67 (8.2%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">5 (6.5%)</td>
        <td headers="stat_3">20 (11%)</td>
        <td headers="stat_4">14 (12%)</td>
        <td headers="stat_5">9 (9.0%)</td>
        <td headers="stat_6">19 (8.7%)</td>
        <td headers="p.value" style="font-weight: bold">0.007</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_vancomycin</td>
        <td headers="stat_0">67 (8.2%)</td>
        <td headers="stat_1">8 (6.4%)</td>
        <td headers="stat_2">3 (3.9%)</td>
        <td headers="stat_3">10 (5.6%)</td>
        <td headers="stat_4">22 (19%)</td>
        <td headers="stat_5">3 (3.0%)</td>
        <td headers="stat_6">21 (9.6%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_levofloxacin</td>
        <td headers="stat_0">250 (31%)</td>
        <td headers="stat_1">27 (22%)</td>
        <td headers="stat_2">6 (7.8%)</td>
        <td headers="stat_3">24 (13%)</td>
        <td headers="stat_4">20 (17%)</td>
        <td headers="stat_5">34 (34%)</td>
        <td headers="stat_6">139 (63%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_teicoplanin</td>
        <td headers="stat_0">37 (4.5%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">7 (3.9%)</td>
        <td headers="stat_4">2 (1.7%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">28 (13%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_ethambutol</td>
        <td headers="stat_0">8 (1.0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">2 (1.1%)</td>
        <td headers="stat_4">6 (5.2%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_pyrazinamid</td>
        <td headers="stat_0">12 (1.5%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">5 (2.8%)</td>
        <td headers="stat_4">7 (6.0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_rifampin</td>
        <td headers="stat_0">15 (1.8%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">5 (2.8%)</td>
        <td headers="stat_4">9 (7.8%)</td>
        <td headers="stat_5">1 (1.0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_heparin</td>
        <td headers="stat_0">207 (25%)</td>
        <td headers="stat_1">12 (9.6%)</td>
        <td headers="stat_2">2 (2.6%)</td>
        <td headers="stat_3">74 (41%)</td>
        <td headers="stat_4">24 (21%)</td>
        <td headers="stat_5">33 (33%)</td>
        <td headers="stat_6">62 (28%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_clopidogrel</td>
        <td headers="stat_0">40 (4.9%)</td>
        <td headers="stat_1">7 (5.6%)</td>
        <td headers="stat_2">4 (5.2%)</td>
        <td headers="stat_3">1 (0.6%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">8 (8.0%)</td>
        <td headers="stat_6">20 (9.1%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_enoxaparin</td>
        <td headers="stat_0">352 (43%)</td>
        <td headers="stat_1">33 (26%)</td>
        <td headers="stat_2">13 (17%)</td>
        <td headers="stat_3">119 (66%)</td>
        <td headers="stat_4">44 (38%)</td>
        <td headers="stat_5">40 (40%)</td>
        <td headers="stat_6">103 (47%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_dexamethason</td>
        <td headers="stat_0">106 (13%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">75 (42%)</td>
        <td headers="stat_4">20 (17%)</td>
        <td headers="stat_5">2 (2.0%)</td>
        <td headers="stat_6">9 (4.1%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_amiodaron</td>
        <td headers="stat_0">36 (4.4%)</td>
        <td headers="stat_1">8 (6.4%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">14 (7.8%)</td>
        <td headers="stat_4">5 (4.3%)</td>
        <td headers="stat_5">4 (4.0%)</td>
        <td headers="stat_6">5 (2.3%)</td>
        <td headers="p.value" style="font-weight: bold">0.025</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_furosemid</td>
        <td headers="stat_0">436 (53%)</td>
        <td headers="stat_1">72 (58%)</td>
        <td headers="stat_2">15 (19%)</td>
        <td headers="stat_3">81 (45%)</td>
        <td headers="stat_4">49 (42%)</td>
        <td headers="stat_5">71 (71%)</td>
        <td headers="stat_6">148 (68%)</td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_haloperidol</td>
        <td headers="stat_0">53 (6.5%)</td>
        <td headers="stat_1">3 (2.4%)</td>
        <td headers="stat_2">4 (5.2%)</td>
        <td headers="stat_3">21 (12%)</td>
        <td headers="stat_4">4 (3.4%)</td>
        <td headers="stat_5">5 (5.0%)</td>
        <td headers="stat_6">16 (7.3%)</td>
        <td headers="p.value" style="font-weight: bold">0.015</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_valproic</td>
        <td headers="stat_0">32 (3.9%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">1 (1.3%)</td>
        <td headers="stat_3">10 (5.6%)</td>
        <td headers="stat_4">5 (4.3%)</td>
        <td headers="stat_5">3 (3.0%)</td>
        <td headers="stat_6">13 (5.9%)</td>
        <td headers="p.value" style="font-weight: bold">0.024</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_aceclofenac</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_naproxen</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_daptomycin</td>
        <td headers="stat_0">1 (0.1%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">1 (0.9%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value">0.4</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_cetirizin</td>
        <td headers="stat_0">6 (0.7%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">6 (2.7%)</td>
        <td headers="p.value" style="font-weight: bold">0.017</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_simvas</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_bisoprolol</td>
        <td headers="stat_0">6 (0.7%)</td>
        <td headers="stat_1">4 (3.2%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">1 (0.6%)</td>
        <td headers="stat_4">1 (0.9%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value" style="font-weight: bold">0.035</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_diltiazem</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_eptifibatid</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_quinidin</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_carbamazepin</td>
        <td headers="stat_0">8 (1.0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">7 (3.9%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">1 (0.5%)</td>
        <td headers="p.value" style="font-weight: bold">0.002</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_phenytoin</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_mirtazapin</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_quetiapin</td>
        <td headers="stat_0">4 (0.5%)</td>
        <td headers="stat_1">1 (0.8%)</td>
        <td headers="stat_2">1 (1.3%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">2 (0.9%)</td>
        <td headers="p.value">0.5</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_ondansetron</td>
        <td headers="stat_0">6 (0.7%)</td>
        <td headers="stat_1">2 (1.6%)</td>
        <td headers="stat_2">1 (1.3%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">3 (2.6%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value" style="font-weight: bold">0.015</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_palonosetron</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_oseltamivir</td>
        <td headers="stat_0">2 (0.2%)</td>
        <td headers="stat_1">1 (0.8%)</td>
        <td headers="stat_2">1 (1.3%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value">0.14</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_quinin</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_pembrolizumab</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_trastuzumab</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_atezolizumab</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_durvalumab</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_IVIG</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_tacrolimus</td>
        <td headers="stat_0">1 (0.1%)</td>
        <td headers="stat_1">1 (0.8%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value">0.5</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_fluorouracil</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_irinotecan</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_leucovorin</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">comed_oxaliplatin</td>
        <td headers="stat_0">0 (0%)</td>
        <td headers="stat_1">0 (0%)</td>
        <td headers="stat_2">0 (0%)</td>
        <td headers="stat_3">0 (0%)</td>
        <td headers="stat_4">0 (0%)</td>
        <td headers="stat_5">0 (0%)</td>
        <td headers="stat_6">0 (0%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">flag_ADR_TP_ID</td>
        <td headers="stat_0">264 (32%)</td>
        <td headers="stat_1">34 (27%)</td>
        <td headers="stat_2">22 (29%)</td>
        <td headers="stat_3">59 (33%)</td>
        <td headers="stat_4">35 (30%)</td>
        <td headers="stat_5">38 (38%)</td>
        <td headers="stat_6">76 (35%)</td>
        <td headers="p.value">0.5</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">ADR_CTCAE_max</td>
        <td headers="stat_0"><break/></td>
        <td headers="stat_1"><break/></td>
        <td headers="stat_2"><break/></td>
        <td headers="stat_3"><break/></td>
        <td headers="stat_4"><break/></td>
        <td headers="stat_5"><break/></td>
        <td headers="stat_6"><break/></td>
        <td headers="p.value" style="font-weight: bold">&lt;0.001</td>
      </tr>
      <tr>
        <td headers="label">    1</td>
        <td headers="stat_0">85 (32%)</td>
        <td headers="stat_1">11 (32%)</td>
        <td headers="stat_2">9 (41%)</td>
        <td headers="stat_3">17 (29%)</td>
        <td headers="stat_4">7 (20%)</td>
        <td headers="stat_5">7 (18%)</td>
        <td headers="stat_6">34 (45%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label">    2</td>
        <td headers="stat_0">78 (30%)</td>
        <td headers="stat_1">10 (29%)</td>
        <td headers="stat_2">6 (27%)</td>
        <td headers="stat_3">12 (20%)</td>
        <td headers="stat_4">6 (17%)</td>
        <td headers="stat_5">17 (45%)</td>
        <td headers="stat_6">27 (36%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label">    3</td>
        <td headers="stat_0">49 (19%)</td>
        <td headers="stat_1">4 (12%)</td>
        <td headers="stat_2">3 (14%)</td>
        <td headers="stat_3">17 (29%)</td>
        <td headers="stat_4">7 (20%)</td>
        <td headers="stat_5">6 (16%)</td>
        <td headers="stat_6">12 (16%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label">    4</td>
        <td headers="stat_0">52 (20%)</td>
        <td headers="stat_1">9 (26%)</td>
        <td headers="stat_2">4 (18%)</td>
        <td headers="stat_3">13 (22%)</td>
        <td headers="stat_4">15 (43%)</td>
        <td headers="stat_5">8 (21%)</td>
        <td headers="stat_6">3 (3.9%)</td>
        <td headers="p.value"><break/></td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">ADR_onset_first</td>
        <td headers="stat_0">4.0 (2.0 - 10.0)</td>
        <td headers="stat_1">2.0 (1.0 - 9.8)</td>
        <td headers="stat_2">3.5 (2.0 - 7.8)</td>
        <td headers="stat_3">4.0 (2.0 - 9.0)</td>
        <td headers="stat_4">6.0 (2.5 - 11.0)</td>
        <td headers="stat_5">4.0 (2.0 - 9.0)</td>
        <td headers="stat_6">6.0 (2.0 - 11.0)</td>
        <td headers="p.value">0.15</td>
      </tr>
      <tr>
        <td headers="label" style="font-weight: bold">ADR_PLT_ratio</td>
        <td headers="stat_0">0.36 (0.22 - 0.52)</td>
        <td headers="stat_1">0.55 (0.26 - 0.64)</td>
        <td headers="stat_2">0.39 (0.21 - 0.58)</td>
        <td headers="stat_3">0.37 (0.26 - 0.50)</td>
        <td headers="stat_4">0.30 (0.16 - 0.45)</td>
        <td headers="stat_5">0.36 (0.20 - 0.48)</td>
        <td headers="stat_6">0.35 (0.25 - 0.50)</td>
        <td headers="p.value">0.077</td>
      </tr>
    </tbody>
  </table>
</table-wrap>
<code language="r script">save(table_descriptive_site, file = &quot;data/results/table-descriptive-site.rda&quot;)
</code>
<sec id="nb-code-cell-5-output-0-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_aceclofenac', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-1-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_naproxen', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-2-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_simvas', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-3-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_diltiazem', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-4-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_eptifibatid', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-5-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_quinidin', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-6-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_phenytoin', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-7-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_mirtazapin', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-8-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_palonosetron', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-9-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_quinin', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-10-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_pembrolizumab', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-11-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_trastuzumab', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-12-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_atezolizumab', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-13-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_durvalumab', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-14-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_IVIG', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-15-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_fluorouracil', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-16-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_irinotecan', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-17-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_leucovorin', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
<sec id="nb-code-cell-5-output-18-nb-2" specific-use="notebook-output">
<preformat>There was an error in 'add_p()/add_difference()' for variable 'comed_oxaliplatin', p-value omitted:
Error in stats::chisq.test(x = c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, : 'x' and 'y' must have at least 2 levels</preformat>
</sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-12-nb-3">
<front-stub>
</front-stub>

<body>

</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-16-nb-4">
<front-stub>
<title-group>
<article-title>Data Cleaning</article-title>
</title-group>
</front-stub>

<body>
<sec id="inputs-nb-4">
  <title>Inputs</title>
  <p>Import processed original data from the
  <monospace>data-original-processed</monospace> directory, which is
  available on Github.</p>
  <p>The import code is in the <monospace>process-data.R</monospace>
  file in the <monospace>data-original-processed</monospace>
  directory.</p>
  <p>The unprocessed data in Excel format is not available on GitHub as
  it contains non-anonymized patient data.</p>
  <p>Some cleaning steps were performed in Excel before importing the
  data into R.</p>
  <sec id="nb-code-cell-1-nb-4" specific-use="notebook-code">
  <code language="r script">library(tidyverse)
  </code>
  <code language="r script">load(&quot;data/data-original-processed/data-processed.rda&quot;)
  </code>
  <sec id="nb-code-cell-1-output-0-nb-4" specific-use="notebook-output">
  <preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
  </sec>
  </sec>
</sec>
<sec id="cleaning-nb-4">
  <title>Cleaning</title>
  <p>This code cleans and filters the ‘inputs_general’ data.</p>
  <list list-type="order">
    <list-item>
      <p>Replaces ‘TrTM’ with ‘IV’ in the ‘LZD_route’ column.</p>
    </list-item>
    <list-item>
      <p>Replaces any occurrence of ‘IV’ followed by ‘PO’ or ‘PO’
      followed by ‘IV’ in the ‘LZD_route’ column with ‘IV&amp;PO’.</p>
    </list-item>
    <list-item>
      <p>Removes rows where ‘LZD_route’ is ‘0’.</p>
    </list-item>
    <list-item>
      <p>Removes rows where ‘patient_age’ is less than 18.</p>
    </list-item>
    <list-item>
      <p>Removes rows where ‘LZD_duration’ is less than 3.</p>
    </list-item>
    <list-item>
      <p>Removes rows where ‘LZD_start’ or ‘LZD_end’ is not within the
      study period.</p>
    </list-item>
    <list-item>
      <p>Removes rows where any variable that starts with “comed” is
      NA.</p>
    </list-item>
    <list-item>
      <p>Removes second treatment period (if any) by removing rows where
      ‘patient_ID’ contains “_2”.</p>
    </list-item>
  </list>
  <sec id="nb-code-cell-2-nb-4" specific-use="notebook-code">
  <code language="r script">inputs_cleaned &lt;- inputs_general |&gt;
  mutate(
    LZD_route = str_replace(LZD_route, &quot;TrTM&quot;, &quot;IV&quot;),
    LZD_route = str_replace(LZD_route, &quot;IV.*PO|PO.*IV&quot;, &quot;IV&amp;PO&quot;)
  ) |&gt;
  filter(!LZD_route == &quot;0&quot;) |&gt;
  filter(patient_age &gt;= 18) |&gt;
  filter(LZD_duration &gt;= 3) |&gt;
  filter(complete.cases(across(starts_with(&quot;comed&quot;)))) |&gt;
  filter(
    site == &quot;ND1&quot; &amp;
      (between(LZD_start, as_date(&quot;2021-05-01&quot;), as_date(&quot;2021-12-31&quot;)) |
        between(LZD_end, as_date(&quot;2021-05-01&quot;), as_date(&quot;2021-12-31&quot;))) |
      site == &quot;ND2&quot; &amp;
        (between(LZD_start, as_date(&quot;2022-04-01&quot;), as_date(&quot;2022-09-30&quot;)) |
          between(LZD_end, as_date(&quot;2022-04-01&quot;), as_date(&quot;2022-09-30&quot;))) |
      site == &quot;BM1&quot; &amp;
        (between(LZD_start, as_date(&quot;2019-11-01&quot;), as_date(&quot;2019-12-31&quot;)) |
          between(LZD_end, as_date(&quot;2019-11-01&quot;), as_date(&quot;2019-12-31&quot;))) |
      site == &quot;BM2&quot; &amp;
        (between(LZD_start, as_date(&quot;2022-12-01&quot;), as_date(&quot;2023-03-31&quot;)) |
          between(LZD_end, as_date(&quot;2022-12-01&quot;), as_date(&quot;2023-03-31&quot;))) |
      site == &quot;TN1&quot; &amp;
        (between(LZD_start, as_date(&quot;2020-01-01&quot;), as_date(&quot;2020-06-30&quot;)) |
          between(LZD_end, as_date(&quot;2020-01-01&quot;), as_date(&quot;2020-06-30&quot;))) |
      site == &quot;TN2&quot; &amp;
        (between(LZD_start, as_date(&quot;2022-09-01&quot;), as_date(&quot;2023-02-28&quot;)) |
          between(LZD_end, as_date(&quot;2022-09-01&quot;), as_date(&quot;2023-02-28&quot;)))
  ) |&gt;
  filter(!str_detect(patient_ID, &quot;_2&quot;))
  </code>
  </sec>
  <p>This code filters the ‘inputs_labs_general’ data frame.</p>
  <list list-type="order">
    <list-item>
      <p>Remove rows with LZD use duration less than 3 days.</p>
    </list-item>
  </list>
  <sec id="nb-code-cell-3-nb-4" specific-use="notebook-code">
  <code language="r script">inputs_labs_pipe_1 &lt;- inputs_labs_general |&gt;
  filter(LZD_end - LZD_start &gt;= 2) |&gt;
  filter(!str_detect(patient_ID, &quot;_2&quot;))
  </code>
  </sec>
  <p>This code remove ‘patient_ID’ that has no valid ‘test_PLT’ either
  in 7 days prior to ‘LZD_start’ or during LZD use.</p>
  <list list-type="order">
    <list-item>
      <p>Two rows are added to each ‘patient_ID’ to ensure there is at
      least one row in both time periods of each patient that can be
      used for flagging.</p>
    </list-item>
    <list-item>
      <p>‘flag_post_start’ is used to separate two time periods for each
      ‘patient_ID’. The first period is 7 days prior to ‘LZD_start’ and
      the second period is during LZD use.</p>
    </list-item>
    <list-item>
      <p>‘flag_too_early’ and ‘flag_post_end’ are used to flag
      observations that are before 7 days prior to ‘LZD_start’ or after
      ‘LZD_end’, so ‘test_PLT’ in these periods will not be valid.</p>
    </list-item>
    <list-item>
      <p>‘flag_remove_check’ is used to check if all ‘test_PLT’ values
      are NAs in each time periods of each ‘patient_ID’. If any time
      period initially had no rows, the new row added in step 1 will be
      used. That group will have only one ‘test_PLT’ with the value NA
      and so the flag will be TRUE. The ‘test_PLT’ in ‘flag_too_early’
      and ‘flag_post_end’ periods are not included in the check as they
      are not valid.</p>
    </list-item>
    <list-item>
      <p>For each ‘patient_ID’, if any ‘flag_remove_check’ is TRUE, all
      rows of that ‘patient_ID’ will be removed.</p>
    </list-item>
    <list-item>
      <p>Finally, rows with ‘flag_temp’ as TRUE are removed. These rows
      were added in step 1 and are no longer needed. The column itself
      is also removed.</p>
    </list-item>
  </list>
  <sec id="nb-code-cell-4-nb-4" specific-use="notebook-code">
  <code language="r script"># Helper function to add new rows to each group in a data frame.
# reframe() generate new rows where its arguments are variables in the data frame.
# bind_rows() bind the new rows to the original data frame.
# group_modify() apply the previous functions to each group in a data frame.
add_reframe_rows &lt;- function(.data, ...) {
  group_modify(.data, function(x, y) {
    bind_rows(x, reframe(x, ...))
  })
}

inputs_labs_cleaned &lt;- inputs_labs_pipe_1 |&gt;
  group_by(patient_ID) |&gt;
  arrange(test_date, .by_group = TRUE) |&gt;
  add_reframe_rows(test_date = min(test_date) - 100, LZD_start = min(LZD_start), flag_temp = TRUE) |&gt;
  add_reframe_rows(test_date = max(test_date) + 100, LZD_start = max(LZD_start), flag_temp = TRUE) |&gt;
  mutate(
    flag_too_early = test_date &lt;= LZD_start - 8,
    flag_post_start = test_date &gt;= LZD_start + 1,
    flag_post_end = test_date &gt;= LZD_end + 1
  ) |&gt;
  group_by(patient_ID, flag_post_start) |&gt;
  mutate(flag_remove_check = all(is.na(test_PLT[which((!flag_too_early &amp; !flag_post_end) | flag_temp)]))) |&gt;
  group_by(patient_ID) |&gt;
  filter(!any(flag_remove_check)) |&gt;
  filter(is.na(flag_temp)) |&gt;
  select(-flag_temp)
  </code>
  </sec>
  <p>inner_join() keeps only patients present in both data frames,
  essentially removing patients without lab tests or other
  comorbidity/medication data.</p>
  <sec id="nb-code-cell-5-nb-4" specific-use="notebook-code">
  <code language="r script">inputs_cleaned_joined &lt;-
  inner_join(inputs_cleaned, inputs_labs_cleaned)
  </code>
  <sec id="nb-code-cell-5-output-0-nb-4" specific-use="notebook-output">
  <preformat>Joining with `by = join_by(patient_ID, LZD_start, LZD_end)`</preformat>
  </sec>
  </sec>
</sec>
<sec id="mutating-nb-4">
  <title>Mutating</title>
  <p>This code flags ‘patient_ID’ that had at least one thrombocytopenia
  event during LZD use.</p>
  <p>Thrombocytopenia is defined as follows:</p>
  <list list-type="alpha-lower">
    <list-item>
      <p>If baseline PLT is normal (150-450), then thrombocytopenia is
      defined as PLT &lt; 112.5.</p>
    </list-item>
    <list-item>
      <p>If baseline PLT is low (&lt; 150), then thrombocytopenia is
      defined as PLT &lt;= 75% of baseline.</p>
    </list-item>
  </list>
  <p>Baseline date is defined as the latest ‘test_date’ before
  ‘LZD_start’ that has a non-NA ‘test_PLT.’</p>
  <p>This ‘test_date’ must be within 7 days before ‘LZD_start’, which
  means ‘flag_too_early’ must be FALSE.</p>
  <p>The code performs the following operations: 1. Groups the data by
  ‘patient_ID’. 2. Flags all ‘test_date’ after the baseline date.
  Baseline is defined above. 3. Flags all ‘test_date’ that meet the
  thrombocytopenia definition. This is an ADR event. 4. Flags all
  ‘patient_ID’ that have at least one thrombocytopenia ADR event during
  LZD use.</p>
  <p>Notes: max(which()) finds the index of the last TRUE value in a
  logical vector.</p>
  <p>while which.max() finds the index of the first TRUE value in a
  logical vector.</p>
  <sec id="nb-code-cell-6-nb-4" specific-use="notebook-code">
  <code language="r script">inputs_analyze_1 &lt;- inputs_cleaned_joined |&gt;
  group_by(patient_ID) |&gt;
  mutate(
    flag_too_late = test_date &gt;= LZD_end + 6,
    flag_post_baseline = test_date &gt;= test_date[max(which(test_date &lt;= LZD_start &amp; !is.na(test_PLT) &amp; !flag_too_early))],
    test_ADR_TP = flag_post_baseline &amp; !flag_too_late &amp; (
      (test_PLT[which.max(flag_post_baseline)] &gt;= 150 &amp; test_PLT &lt;= 112.5) |
        (test_PLT[which.max(flag_post_baseline)] &lt; 150 &amp; test_PLT &lt;= 0.75 * test_PLT[which.max(flag_post_baseline)])
    ),
    flag_ADR_TP_ID = any(test_ADR_TP, na.rm = TRUE)
  )
  </code>
  </sec>
  <p>This code adds a new column ‘test_CTCAE’ based on the Common
  Terminology Criteria for Adverse Events (CTCAE) for decreased platelet
  count.</p>
  <p>If ‘test_ADR_TP’ is TRUE, it assigns a value to ‘test_CTCAE’ based
  on the ‘test_PLT’ column.</p>
  <list list-type="alpha-lower">
    <list-item>
      <p>If ‘test_PLT’ is less than 25, ‘test_CTCAE’ is assigned a value
      of 4.</p>
    </list-item>
    <list-item>
      <p>If ‘test_PLT’ is between 25 and 50, ‘test_CTCAE’ is assigned a
      value of 3.</p>
    </list-item>
    <list-item>
      <p>If ‘test_PLT’ is between 50 and 75, ‘test_CTCAE’ is assigned a
      value of 2.</p>
    </list-item>
    <list-item>
      <p>If ‘test_PLT’ is between 75 and 150, ‘test_CTCAE’ is assigned a
      value of 1.</p>
    </list-item>
  </list>
  <p>If ‘test_ADR_TP’ is FALSE, ‘test_CTCAE’ is assigned NA.</p>
  <p>Finally, ‘test_CTCAE_max’ is assigned the maximum value of
  ‘test_CTCAE’ for each ‘patient_ID’.</p>
  <sec id="nb-code-cell-7-nb-4" specific-use="notebook-code">
  <code language="r script">inputs_analyze_2 &lt;- inputs_analyze_1 |&gt;
  mutate(
    test_CTCAE =
      if_else(
        test_ADR_TP,
        case_when(
          test_PLT &lt; 25 ~ 4,
          test_PLT &lt; 50 ~ 3,
          test_PLT &lt; 75 ~ 2,
          test_PLT &lt; 150 ~ 1
        ),
        NA_real_
      ),
    ADR_CTCAE_max = max(test_CTCAE, na.rm = TRUE),
    ADR_CTCAE_max = na_if(ADR_CTCAE_max, -Inf)
  )
  </code>
  <sec id="nb-code-cell-7-output-0-nb-4" specific-use="notebook-output">
  <preformat>Warning: There were 638 warnings in `mutate()`.
The first warning was:
ℹ In argument: `ADR_CTCAE_max = max(test_CTCAE, na.rm = TRUE)`.
ℹ In group 1: `patient_ID = &quot;000847&quot;`.
Caused by warning in `max()`:
! no non-missing arguments to max; returning -Inf
ℹ Run `dplyr::last_dplyr_warnings()` to see the 637 remaining warnings.</preformat>
  </sec>
  </sec>
  <p>This code adds a new column ‘test_onset’, which is the number of
  days from ‘LZD_start’ to the thrombocytopenia event.</p>
  <p>If ‘test_ADR_TP’ is TRUE, ‘test_onset’ is assigned the value of
  ‘test_date’ minus ‘LZD_start’.</p>
  <p>If ‘test_ADR_TP’ is FALSE, ‘test_onset’ is assigned NA.</p>
  <p>Finally, ‘test_onset_first’ is assigned the first non-NA value of
  ‘test_onset’ for each ‘patient_ID’.</p>
  <sec id="nb-code-cell-8-nb-4" specific-use="notebook-code">
  <code language="r script">inputs_analyze_3 &lt;- inputs_analyze_2 |&gt;
  mutate(
    ADR_onset =
      if_else(
        test_ADR_TP,
        as.double(test_date - LZD_start),
        NA_real_
      ),
    ADR_onset_first = first(na.omit(ADR_onset))
  )
  </code>
  </sec>
  <p>This code adds a new column ‘test_PLT_ratio’, which is the ratio of
  the minimum ‘test_PLT’ to the baseline ‘test_PLT’.</p>
  <p>If ‘flag_ADR_TP_ID’ is TRUE, ‘test_PLT_ratio’ is assigned the value
  of the ratio.</p>
  <p>If ‘flag_ADR_TP_ID’ is FALSE, ‘test_PLT_ratio’ is assigned NA.</p>
  <sec id="nb-code-cell-9-nb-4" specific-use="notebook-code">
  <code language="r script">inputs_analyze_4 &lt;- inputs_analyze_3 |&gt;
  mutate(
    ADR_PLT_ratio =
      if_else(
        flag_ADR_TP_ID,
        test_PLT[which.min(test_PLT)] / test_PLT[which.max(flag_post_baseline)],
        NA_real_
      )
  )
  </code>
  </sec>
  <p>Changes existing data to get values from data_lab_test instead of
  relying on data_patient The code also removes duplicates and sorts the
  data by ‘site’ and ‘patient_ID’.</p>
  <sec id="nb-code-cell-10-nb-4" specific-use="notebook-code">
  <code language="r script">inputs_analyze_5 &lt;- inputs_analyze_4 |&gt;
  mutate(
    LZD_duration = as.numeric(LZD_end - LZD_start) + 1,
    baseline_date = test_date[which.max(flag_post_baseline)],
    baseline_PLT = test_PLT[which.max(flag_post_baseline)],
    baseline_HGB = test_HGB[which.max(flag_post_baseline)],
    baseline_WBC = test_WBC[which.max(flag_post_baseline)],
    ADR_PLT_min = min(test_PLT[which.max(flag_post_baseline) + 1:max(which(flag_post_baseline))], na.rm = TRUE),
  ) 
  </code>
  </sec>
</sec>
<sec id="outputs-nb-4">
  <title>Outputs</title>
  <p>This code prepares the final data for analysis and exports it to
  the ‘data-cleaned’ directory.</p>
  <list list-type="order">
    <list-item>
      <p>The ‘data_patient_complete’ data frame contains only the first
      complete row of each ‘patient_ID’ in ‘data_complete’.</p>
    </list-item>
  </list>
  <list list-type="bullet">
    <list-item>
      <p>Patients with any missing initial data are removed.</p>
    </list-item>
    <list-item>
      <p>Patients with baseline PLT &gt; 450 are removed.</p>
    </list-item>
    <list-item>
      <p>The ‘data_patient_complete’ data frame is used for
      patient-level analysis.</p>
    </list-item>
  </list>
  <list list-type="order">
    <list-item>
      <label>2.</label>
      <p>The ‘data_complete’ data frame contains all the cleaned and
      filtered data.</p>
    </list-item>
  </list>
  <list list-type="bullet">
    <list-item>
      <p>The ‘data_complete’ data frame is used for event-level
      analysis.</p>
    </list-item>
  </list>
  <sec id="nb-code-cell-11-nb-4" specific-use="notebook-code">
  <code language="r script">data_patient_complete &lt;- inputs_analyze_5 |&gt;
  arrange(site, patient_ID) |&gt;
  slice_head(n = 1) |&gt;
  select(-starts_with(&quot;test&quot;)) |&gt;
  filter(complete.cases(across(-starts_with(&quot;ADR&quot;)))) |&gt;
  filter(baseline_PLT &lt;= 450) |&gt;
  ungroup()

data_complete &lt;- inputs_analyze_5 |&gt;
  filter(patient_ID %in% data_patient_complete$patient_ID) |&gt;
  ungroup()

write_csv(data_complete, &quot;data/data-cleaned/data-complete.csv&quot;)
write_csv(data_patient_complete, &quot;data/data-cleaned/data-patient-complete.csv&quot;)

save(data_complete, data_patient_complete, file = &quot;data/data-cleaned/data-cleaned.rda&quot;)
  </code>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-20-nb-5">
<front-stub>
<title-group>
<article-title>Model Development and Apparent Validation</article-title>
</title-group>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-5" specific-use="notebook-code">
<code language="r script">source(&quot;notebooks/initialize-data-analysis.r&quot;)
</code>
<code language="r script">source(&quot;notebooks/BMA-model-no-initial-var.r&quot;) # run_bas_glm() function
</code>
<sec id="nb-code-cell-1-output-0-nb-5" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
</sec>
<sec id="penalized-likelihood-methods-nb-5">
  <title>Penalized Likelihood Methods</title>
  <sec id="backwards-stepwise-logistic-regression-nb-5">
    <title>Backwards Stepwise Logistic Regression</title>
    <sec id="nb-code-cell-2-nb-5" specific-use="notebook-code">
    <code language="r script"># library(StepReg)
# run_stepwise_logit &lt;- function(data, formula) {
#   stepwiseLogit(
#     formula,
#     data = data,
#     include = NULL,
#     selection = &quot;backward&quot;,
#     select = &quot;AIC&quot;
#   )
# }

# stepwise_model &lt;- data_patient_complete |&gt;
#   select(all_of(predictor_list), flag_ADR_TP_ID) |&gt;
#   run_stepwise_logit(
#     formula = flag_ADR_TP_ID ~ .
#   )

# stepwise_model |&gt; summary()
    </code>
    </sec>
    <sec id="nb-code-cell-3-nb-5" specific-use="notebook-code">
    <code language="r script">run_step_AIC &lt;- function(data, formula) {
  MASS::stepAIC(
    glm(
      formula = formula,
      data = data
    ),
    direction = &quot;backward&quot;,
    trace = FALSE
  )
}

stepwise_model &lt;- data_patient_complete |&gt;
  select(all_of(predictor_list), flag_ADR_TP_ID) |&gt;
  run_step_AIC(
    formula = flag_ADR_TP_ID ~ .
  )

stepwise_model$coefficients |&gt; length()
    </code>
    <sec id="nb-code-cell-3-output-0-nb-5" specific-use="notebook-output">
    <preformat>[1] 18</preformat>
    </sec>
    </sec>
    <p>Results: Stepwise algorithm selected 17 predictors.</p>
  </sec>
  <sec id="lasso-variable-selection-nb-5">
    <title>LASSO Variable Selection</title>
    <sec id="nb-code-cell-4-nb-5" specific-use="notebook-code">
    <code language="r script">library(glmnet)
    </code>
    <code language="r script">predictor_matrix &lt;- data_patient_complete |&gt;
  select(all_of(predictor_list)) |&gt;
  as.matrix()
response_matrix &lt;- data_patient_complete |&gt;
  select(flag_ADR_TP_ID) |&gt;
  pull()

lasso_fit &lt;- glmnet(
  x = predictor_matrix,
  y = response_matrix,
  family = &quot;binomial&quot;,
  alpha = 1
)

cv_lasso_fit &lt;- cv.glmnet(
  x = predictor_matrix,
  y = response_matrix,
  family = &quot;binomial&quot;,
  alpha = 1,
  nfolds = 5
)

coef(lasso_fit, s = cv_lasso_fit$lambda.min)@i |&gt; length() - 1
    </code>
    <sec id="nb-code-cell-4-output-0-nb-5" specific-use="notebook-output">
    <preformat>Loading required package: Matrix</preformat>
    </sec>
    <sec id="nb-code-cell-4-output-1-nb-5" specific-use="notebook-output">
    <preformat>
Attaching package: 'Matrix'</preformat>
    </sec>
    <sec id="nb-code-cell-4-output-2-nb-5" specific-use="notebook-output">
    <preformat>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</preformat>
    </sec>
    <sec id="nb-code-cell-4-output-3-nb-5" specific-use="notebook-output">
    <preformat>Loaded glmnet 4.1-8</preformat>
    </sec>
    <sec id="nb-code-cell-4-output-4-nb-5" specific-use="notebook-output">
    <preformat>[1] 20</preformat>
    </sec>
    </sec>
    <p>Results: LASSO algorithm selected 22-25 predictors.</p>
    <p>Comment: Penalized likelihood methods have comparable predictive
    performance to Bayesian methods [citation needed], but select many
    more predictors.</p>
  </sec>
</sec>
<sec id="bayesian-model-selection-nb-5">
  <title>Bayesian Model Selection</title>
  <sec id="nb-code-cell-5-nb-5" specific-use="notebook-code">
  <code language="r script">multi_model &lt;- data_patient_complete |&gt;
  select(all_of(predictor_list), flag_ADR_TP_ID) |&gt;
  run_bas_glm(
    formula = flag_ADR_TP_ID ~ .,
    include.always = ~1
  )

summary(multi_model)
  </code>
  <code language="r script">plot(multi_model)
  </code>
  <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-5-1.png" />
  <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-5-2.png" />
  <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-5-3.png" />
  <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-5-4.png" />
  <code language="r script">image(multi_model, rotate = FALSE)
  </code>
  <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-5-5.png" />
  <code language="r script">diagnostics(multi_model)
  </code>
  <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-5-6.png" />
  <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-5-7.png" />
  <code language="r script">multi_predict_HPM &lt;- variable.names(predict(multi_model, estimator = &quot;HPM&quot;))[-1] |&gt;
  str_extract(paste(predictor_list, collapse = &quot;|&quot;)) # highest probability model
multi_predict_BPM &lt;- variable.names(predict(multi_model, estimator = &quot;BPM&quot;))[-1] |&gt;
  str_extract(paste(predictor_list, collapse = &quot;|&quot;)) # best predictive model, this model is weird
  </code>
  <sec id="nb-code-cell-5-output-0-nb-5" specific-use="notebook-output">
  <preformat>                         P(B != 0 | Y)   model 1      model 2       model 3
Intercept                  1.000000000    1.0000    1.0000000    1.00000000
patient_age                0.782325595    1.0000    1.0000000    1.00000000
patient_sexTRUE            0.004691494    0.0000    0.0000000    0.00000000
LZD_dose_per_weight        0.005016634    0.0000    0.0000000    0.00000000
baseline_CLCR              0.318307977    0.0000    0.0000000    0.00000000
dept_ERTRUE                0.004930764    0.0000    0.0000000    0.00000000
dept_ICUTRUE               0.010898421    0.0000    0.0000000    0.00000000
baseline_HGB               0.340579563    1.0000    0.0000000    0.00000000
baseline_WBC               0.016614013    0.0000    0.0000000    0.00000000
baseline_PLT               1.000000000    1.0000    1.0000000    1.00000000
LZD_duration               0.999781220    1.0000    1.0000000    1.00000000
invasive_ETITRUE           0.123807988    0.0000    0.0000000    0.00000000
invasive_CVCTRUE           0.496814275    1.0000    1.0000000    0.00000000
invasive_IHDTRUE           0.006738844    0.0000    0.0000000    0.00000000
invasive_CRRTTRUE          0.980868850    1.0000    1.0000000    1.00000000
comorb_HTNTRUE             0.004341780    0.0000    0.0000000    0.00000000
comorb_DMTRUE              0.007443785    0.0000    0.0000000    0.00000000
comorb_HFTRUE              0.085727203    0.0000    0.0000000    0.00000000
comorb_anginaTRUE          0.004640253    0.0000    0.0000000    0.00000000
comorb_cirrTRUE            0.087553323    0.0000    0.0000000    0.00000000
comorb_COPDTRUE            0.013857150    0.0000    0.0000000    0.00000000
comorb_CVATRUE             0.012284507    0.0000    0.0000000    0.00000000
comorb_MITRUE              0.009680572    0.0000    0.0000000    0.00000000
comorb_KTRUE               0.005019661    0.0000    0.0000000    0.00000000
comorb_hematologicalTRUE   0.014504509    0.0000    0.0000000    0.00000000
comorb_hemaTRUE            0.004932177    0.0000    0.0000000    0.00000000
infect_sepsisTRUE          0.047346588    0.0000    0.0000000    0.00000000
infect_CAPTRUE             0.007291033    0.0000    0.0000000    0.00000000
infect_HAPTRUE             0.018686954    0.0000    0.0000000    0.00000000
infect_SSTITRUE            0.018701649    0.0000    0.0000000    0.00000000
infect_CNSTRUE             0.004152075    0.0000    0.0000000    0.00000000
infect_IAITRUE             0.004764308    0.0000    0.0000000    0.00000000
infect_UTITRUE             0.005584564    0.0000    0.0000000    0.00000000
infect_BJITRUE             0.008422105    0.0000    0.0000000    0.00000000
infect_septicemiaTRUE      0.206294431    0.0000    0.0000000    0.00000000
comed_aspirinTRUE          0.004355638    0.0000    0.0000000    0.00000000
comed_diclofenacTRUE       0.005449085    0.0000    0.0000000    0.00000000
comed_ibuprofenTRUE        0.004136942    0.0000    0.0000000    0.00000000
comed_paracetamolTRUE      0.006311163    0.0000    0.0000000    0.00000000
comed_penicillinTRUE       0.008175630    0.0000    0.0000000    0.00000000
comed_cephaTRUE            0.009096934    0.0000    0.0000000    0.00000000
comed_carbapenemTRUE       0.005057448    0.0000    0.0000000    0.00000000
comed_cotrimoxazolTRUE     0.067865323    0.0000    0.0000000    0.00000000
comed_vancomycinTRUE       0.028527107    0.0000    0.0000000    0.00000000
comed_levofloxacinTRUE     0.004404736    0.0000    0.0000000    0.00000000
comed_teicoplaninTRUE      0.013228969    0.0000    0.0000000    0.00000000
comed_ethambutolTRUE       0.005273797    0.0000    0.0000000    0.00000000
comed_pyrazinamidTRUE      0.011229428    0.0000    0.0000000    0.00000000
comed_rifampinTRUE         0.010778976    0.0000    0.0000000    0.00000000
comed_heparinTRUE          0.058695752    0.0000    0.0000000    0.00000000
comed_clopidogrelTRUE      0.016628190    0.0000    0.0000000    0.00000000
comed_enoxaparinTRUE       0.006003194    0.0000    0.0000000    0.00000000
comed_dexamethasonTRUE     0.007283226    0.0000    0.0000000    0.00000000
comed_amiodaronTRUE        0.028095637    0.0000    0.0000000    0.00000000
comed_furosemidTRUE        0.160604604    0.0000    0.0000000    0.00000000
comed_haloperidolTRUE      0.007891058    0.0000    0.0000000    0.00000000
comed_valproicTRUE         0.004806117    0.0000    0.0000000    0.00000000
BF                                  NA    1.0000    0.1151729    0.01021057
PostProbs                           NA    0.0483    0.0473000    0.04360000
R2                                  NA    0.1838    0.1745000    0.16450000
dim                                 NA    7.0000    6.0000000    5.00000000
logmarg                             NA -439.7101 -441.8714407 -444.29445157
                               model 4       model 5
Intercept                 1.000000e+00    1.00000000
patient_age               0.000000e+00    1.00000000
patient_sexTRUE           0.000000e+00    0.00000000
LZD_dose_per_weight       0.000000e+00    0.00000000
baseline_CLCR             1.000000e+00    0.00000000
dept_ERTRUE               0.000000e+00    0.00000000
dept_ICUTRUE              0.000000e+00    0.00000000
baseline_HGB              0.000000e+00    1.00000000
baseline_WBC              0.000000e+00    0.00000000
baseline_PLT              1.000000e+00    1.00000000
LZD_duration              1.000000e+00    1.00000000
invasive_ETITRUE          0.000000e+00    0.00000000
invasive_CVCTRUE          0.000000e+00    0.00000000
invasive_IHDTRUE          0.000000e+00    0.00000000
invasive_CRRTTRUE         1.000000e+00    1.00000000
comorb_HTNTRUE            0.000000e+00    0.00000000
comorb_DMTRUE             0.000000e+00    0.00000000
comorb_HFTRUE             0.000000e+00    0.00000000
comorb_anginaTRUE         0.000000e+00    0.00000000
comorb_cirrTRUE           0.000000e+00    0.00000000
comorb_COPDTRUE           0.000000e+00    0.00000000
comorb_CVATRUE            0.000000e+00    0.00000000
comorb_MITRUE             0.000000e+00    0.00000000
comorb_KTRUE              0.000000e+00    0.00000000
comorb_hematologicalTRUE  0.000000e+00    0.00000000
comorb_hemaTRUE           0.000000e+00    0.00000000
infect_sepsisTRUE         0.000000e+00    0.00000000
infect_CAPTRUE            0.000000e+00    0.00000000
infect_HAPTRUE            0.000000e+00    0.00000000
infect_SSTITRUE           0.000000e+00    0.00000000
infect_CNSTRUE            0.000000e+00    0.00000000
infect_IAITRUE            0.000000e+00    0.00000000
infect_UTITRUE            0.000000e+00    0.00000000
infect_BJITRUE            0.000000e+00    0.00000000
infect_septicemiaTRUE     0.000000e+00    0.00000000
comed_aspirinTRUE         0.000000e+00    0.00000000
comed_diclofenacTRUE      0.000000e+00    0.00000000
comed_ibuprofenTRUE       0.000000e+00    0.00000000
comed_paracetamolTRUE     0.000000e+00    0.00000000
comed_penicillinTRUE      0.000000e+00    0.00000000
comed_cephaTRUE           0.000000e+00    0.00000000
comed_carbapenemTRUE      0.000000e+00    0.00000000
comed_cotrimoxazolTRUE    0.000000e+00    0.00000000
comed_vancomycinTRUE      0.000000e+00    0.00000000
comed_levofloxacinTRUE    0.000000e+00    0.00000000
comed_teicoplaninTRUE     0.000000e+00    0.00000000
comed_ethambutolTRUE      0.000000e+00    0.00000000
comed_pyrazinamidTRUE     0.000000e+00    0.00000000
comed_rifampinTRUE        0.000000e+00    0.00000000
comed_heparinTRUE         0.000000e+00    0.00000000
comed_clopidogrelTRUE     0.000000e+00    0.00000000
comed_enoxaparinTRUE      0.000000e+00    0.00000000
comed_dexamethasonTRUE    0.000000e+00    0.00000000
comed_amiodaronTRUE       0.000000e+00    0.00000000
comed_furosemidTRUE       0.000000e+00    0.00000000
comed_haloperidolTRUE     0.000000e+00    0.00000000
comed_valproicTRUE        0.000000e+00    0.00000000
BF                        5.935666e-03    0.05614118
PostProbs                 2.530000e-02    0.02300000
R2                        1.634000e-01    0.17310000
dim                       5.000000e+00    6.00000000
logmarg                  -4.448369e+02 -442.59000543</preformat>
  </sec>
  </sec>
  <sec id="nb-code-cell-6-nb-5" specific-use="notebook-code">
  <code language="r script">library(tidymodels)
  </code>
  <code language="r script">data_patient_complete_response_as_factor &lt;- data_patient_complete |&gt;
  mutate(
    flag_ADR_TP_ID = as.factor(flag_ADR_TP_ID)
  )

model_full &lt;- logistic_reg() |&gt;
  set_engine(&quot;glm&quot;) |&gt;
  set_mode(&quot;classification&quot;) |&gt;
  fit(
    reformulate(
      termlabels = multi_predict_HPM,
      response = &quot;flag_ADR_TP_ID&quot;
    ),
    data = data_patient_complete_response_as_factor
  )
  </code>
  <sec id="nb-code-cell-6-output-0-nb-5" specific-use="notebook-output">
  <preformat>── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──</preformat>
  </sec>
  <sec id="nb-code-cell-6-output-1-nb-5" specific-use="notebook-output">
  <preformat>✔ broom        1.0.5      ✔ rsample      1.2.0 
✔ dials        1.2.1      ✔ tune         1.2.0 
✔ infer        1.0.6      ✔ workflows    1.1.4 
✔ modeldata    1.3.0      ✔ workflowsets 1.1.0 
✔ parsnip      1.2.0      ✔ yardstick    1.3.0 
✔ recipes      1.0.10     </preformat>
  </sec>
  <sec id="nb-code-cell-6-output-2-nb-5" specific-use="notebook-output">
  <preformat>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ scales::discard() masks purrr::discard()
✖ Matrix::expand()  masks tidyr::expand()
✖ dplyr::filter()   masks stats::filter()
✖ recipes::fixed()  masks stringr::fixed()
✖ dplyr::lag()      masks stats::lag()
✖ Matrix::pack()    masks tidyr::pack()
✖ yardstick::spec() masks readr::spec()
✖ recipes::step()   masks stats::step()
✖ Matrix::unpack()  masks tidyr::unpack()
✖ recipes::update() masks Matrix::update(), stats::update()
• Use tidymodels_prefer() to resolve common conflicts.</preformat>
  </sec>
  </sec>
</sec>
<sec id="check-model-assumptions-nb-5">
  <title>Check Model Assumptions</title>
  <sec id="linearity-nb-5">
    <title>Linearity</title>
    <p>Visual check of linearity assumption using partial-residual plots
    (component+residual plots).</p>
    <p>Blue dashed line: linear fit of the partial residuals.</p>
    <p>Red line: smoothed conditional mean</p>
    <p>The lines should be close together and the red line should be
    linear.</p>
    <sec id="nb-code-cell-7-nb-5" specific-use="notebook-code">
    <code language="r script">car::crPlot(model_full$fit, variable = &quot;patient_age&quot;)
    </code>
    <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-7-1.png" />
    <code language="r script">car::crPlot(model_full$fit, variable = &quot;baseline_PLT&quot;)
    </code>
    <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-7-2.png" />
    <code language="r script">car::crPlot(model_full$fit, variable = &quot;LZD_duration&quot;)
    </code>
    <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-7-3.png" />
    </sec>
    <p>Result: No obvious non-linearity in the partial-residual
    plots.</p>
    <p>Visual check of linearity assumption using logit of predicted
    probabilities vs. continuous predictors values.</p>
    <sec id="nb-code-cell-8-nb-5" specific-use="notebook-code">
    <code language="r script">data_patient_linear_check &lt;- data_patient_complete |&gt;
  select(all_of(multi_predict_HPM)) |&gt;
  mutate(
    probabilities = predict(model_full$fit, data_patient_complete, type = &quot;response&quot;),
    log_odds = log(probabilities / (1 - probabilities))
  ) |&gt;
  select_if(is.numeric) |&gt;
  gather(key = &quot;predictors&quot;, value = &quot;predictor_value&quot;, -log_odds, -probabilities)

ggplot(data_patient_linear_check, aes(y = log_odds, x = predictor_value)) +
  geom_point(size = 0.5, alpha = 0.5) +
  geom_smooth(method = &quot;loess&quot;, color = &quot;red&quot;) +
  geom_smooth(method = &quot;lm&quot;, linetype = &quot;dashed&quot;, color = &quot;blue&quot;, se = FALSE) +
  theme_bw() +
  facet_wrap(~predictors, scales = &quot;free_x&quot;)
    </code>
    <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-8-1.png" />
    <sec id="nb-code-cell-8-output-0-nb-5" specific-use="notebook-output">
    <preformat>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</preformat>
    </sec>
    </sec>
  </sec>
  <sec id="no-multicollinearity-nb-5">
    <title>No Multicollinearity</title>
    <p>VIFs from the coefficient estimates should be less than 5 and as
    close to 1 as possible.</p>
    <sec id="nb-code-cell-9-nb-5" specific-use="notebook-code">
    <code language="r script">car::vif(model_full$fit)
    </code>
    <sec id="nb-code-cell-9-output-0-nb-5" specific-use="notebook-output">
    <preformat>  patient_age  baseline_HGB  baseline_PLT  LZD_duration  invasive_CVC 
     1.047767      1.015409      1.094139      1.102152      1.136600 
invasive_CRRT 
     1.129723 </preformat>
    </sec>
    </sec>
    <p>Result: VIFs are all less than 5 and close to 1.</p>
  </sec>
  <sec id="no-outlier-effects-nb-5">
    <title>No Outlier Effects</title>
    <p>Visual check from influence plot.</p>
    <p>Individual observations should not have too much influence on the
    model.</p>
    <p>Influence plot:</p>
    <list list-type="bullet">
      <list-item>
        <p>x-axis: Extreme values (Hat-values)</p>
      </list-item>
      <list-item>
        <p>y-axis: Leverage (Studentized residuals)</p>
      </list-item>
      <list-item>
        <p>Size of points: Cook’s distance</p>
      </list-item>
    </list>
    <sec id="nb-code-cell-10-nb-5" specific-use="notebook-code">
    <code language="r script">car::influencePlot(model_full$fit)
    </code>
    <graphic mimetype="image" mime-subtype="png" xlink:href="03-apparent-performance_files/figure-jats/unnamed-chunk-10-1.png" />
    <code language="r script"># influential_obs &lt;- influence.measures(model_full$fit)$is.inf |&gt; apply(1, any) |&gt; which() |&gt; unname()
    </code>
    <sec id="nb-code-cell-10-output-0-nb-5" specific-use="notebook-output">
    <preformat>      StudRes         Hat       CookD
30   1.972941 0.013530192 0.011386152
229 -1.543583 0.115456843 0.040187659
310  0.958262 0.055317911 0.004933167
443  2.494706 0.002698824 0.008077000
756  2.484277 0.003456496 0.010011110</preformat>
    </sec>
    </sec>
    <p>Result: Influential observations identified.</p>
    <p>DONE: Investigate observations 292, 301, 335, 364, 504, 634.</p>
    <p>Investigation result:</p>
    <list list-type="bullet">
      <list-item>
        <p>invasive_CVC: 5/6</p>
      </list-item>
      <list-item>
        <p>comed_furosemid: 3/6</p>
      </list-item>
      <list-item>
        <p>infect_septicemia: 3/6</p>
      </list-item>
    </list>
    <p>invasive_CVC might be a predictor.</p>
    <sec id="nb-code-cell-11-nb-5" specific-use="notebook-code">
    <code language="r script"># data_patient_complete |&gt;
#   slice(c(292, 301, 335, 364, 504, 634)) |&gt; summary()
    </code>
    </sec>
  </sec>
</sec>
<sec id="model-performance-nb-5">
  <title>Model Performance</title>
  <sec id="nb-code-cell-12-nb-5" specific-use="notebook-code">
  <code language="r script">library(CalibrationCurves)
  </code>
  <code language="r script">pHat &lt;- predict(model_full$fit, data_patient_complete, type = &quot;response&quot;)
yTest &lt;- data_patient_complete$flag_ADR_TP_ID
calperf &lt;- valProbggplot(pHat, yTest)

apparent_performance_metrics &lt;- tibble(
  apparent_C_index = calperf$Cindex[[1]],
  apparent_calibration_intercept = calperf$Calibration$Intercept[[1]],
  apparent_calibration_slope = calperf$Calibration$Slope[[1]]
)

save(apparent_performance_metrics, file = &quot;data/model-performance/apparent-performance-metrics.rda&quot;)
  </code>
  <sec id="nb-code-cell-12-output-0-nb-5" specific-use="notebook-output">
  <preformat>Loading required package: rms</preformat>
  </sec>
  <sec id="nb-code-cell-12-output-1-nb-5" specific-use="notebook-output">
  <preformat>Loading required package: Hmisc</preformat>
  </sec>
  <sec id="nb-code-cell-12-output-2-nb-5" specific-use="notebook-output">
  <preformat>
Attaching package: 'Hmisc'</preformat>
  </sec>
  <sec id="nb-code-cell-12-output-3-nb-5" specific-use="notebook-output">
  <preformat>The following object is masked from 'package:parsnip':

    translate</preformat>
  </sec>
  <sec id="nb-code-cell-12-output-4-nb-5" specific-use="notebook-output">
  <preformat>The following objects are masked from 'package:dplyr':

    src, summarize</preformat>
  </sec>
  <sec id="nb-code-cell-12-output-5-nb-5" specific-use="notebook-output">
  <preformat>The following objects are masked from 'package:base':

    format.pval, units</preformat>
  </sec>
  </sec>
  <sec id="nb-code-cell-13-nb-5" specific-use="notebook-code">
  <code language="r script">save(model_full, file = &quot;data/model-performance/model-full.rda&quot;)
  </code>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-24-nb-6">
<front-stub>
<title-group>
<article-title>Expert Opinion Survey processing</article-title>
</title-group>
</front-stub>

<body>
<sec id="sample-code-nb-6">
  <title>Sample code</title>
  <sec id="nb-code-cell-1-nb-6" specific-use="notebook-code">
  <code language="r script">library(tidyverse)
  </code>
  <code language="r script">library(ggstats)
library(gtsummary)
  </code>
  <sec id="nb-code-cell-1-output-0-nb-6" specific-use="notebook-output">
  <preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
  </sec>
  </sec>
  <sec id="nb-code-cell-2-nb-6" specific-use="notebook-code">
  <code language="r script">likert_levels &lt;- c(
  &quot;Strongly disagree&quot;,
  &quot;Disagree&quot;,
  &quot;Neither agree nor disagree&quot;,
  &quot;Agree&quot;,
  &quot;Strongly agree&quot;
)
set.seed(42)
df &lt;-
  tibble(
    q1 = sample(likert_levels, 6, replace = TRUE),
    q2 = sample(likert_levels, 6, replace = TRUE, prob = 5:1),
    q3 = sample(likert_levels, 6, replace = TRUE, prob = 1:5),
    q4 = sample(likert_levels, 6, replace = TRUE, prob = 1:5),
    q5 = sample(c(likert_levels, NA), 6, replace = TRUE),
    q6 = sample(likert_levels, 6, replace = TRUE, prob = c(1, 0, 1, 1, 0))
  ) |&gt;
  mutate(across(everything(), ~ factor(.x, levels = likert_levels)))

likert_levels_dk &lt;- c(
  &quot;Strongly disagree&quot;,
  &quot;Disagree&quot;,
  &quot;Neither agree nor disagree&quot;,
  &quot;Agree&quot;,
  &quot;Strongly agree&quot;,
  &quot;Don't know&quot;
)
df_dk &lt;-
  tibble(
    q1 = sample(likert_levels_dk, 150, replace = TRUE),
    q2 = sample(likert_levels_dk, 150, replace = TRUE, prob = 6:1),
    q3 = sample(likert_levels_dk, 150, replace = TRUE, prob = 1:6),
    q4 = sample(likert_levels_dk, 150, replace = TRUE, prob = 1:6),
    q5 = sample(c(likert_levels_dk, NA), 150, replace = TRUE),
    q6 = sample(
      likert_levels_dk, 150,
      replace = TRUE, prob = c(1, 0, 1, 1, 0, 1)
    )
  ) |&gt;
  mutate(across(everything(), ~ factor(.x, levels = likert_levels_dk)))
  </code>
  </sec>
  <sec id="nb-code-cell-3-nb-6" specific-use="notebook-code">
  <code language="r script">gglikert(df, sort = &quot;descending&quot;, sort_method = &quot;mean&quot;)
  </code>
  <graphic mimetype="image" mime-subtype="png" xlink:href="03A-expert-survey-processing_files/figure-jats/unnamed-chunk-3-1.png" />
  <code language="r script">gglikert_stacked(df, sort = &quot;descending&quot;, sort_method = &quot;mean&quot;, add_median_line = TRUE)
  </code>
  <graphic mimetype="image" mime-subtype="png" xlink:href="03A-expert-survey-processing_files/figure-jats/unnamed-chunk-3-2.png" />
  </sec>
  <sec id="nb-code-cell-4-nb-6" specific-use="notebook-code">
  <code language="r script">df_numeric &lt;- df |&gt;
  mutate(across(everything(), ~ as.numeric(.x)))
df_numeric$expert &lt;- LETTERS[1:6]
df_numeric |&gt; 
  select(-expert) |&gt;
  tbl_summary(type = ~&quot;continuous&quot;, statistic = list(all_continuous() ~ &quot;{mean} ({sd})&quot;))
  </code>
  <table-wrap>
    <table>
      <thead>
        <tr>
          <th id="U003CstrongU003ECharacteristicU003CU002FstrongU003E-nb-6" scope="col"><bold>Characteristic</bold></th>
          <th id="U003CstrongU003ENU0020U003DU00206U003CU002FstrongU003EU003CspanU0020classU003DU0022gt_footnote_marksU0022U0020styleU003DU0022white-spaceU003AnowrapU003Bfont-styleU003AitalicU003Bfont-weightU003AnormalU003BU0022U003EU003CsupU003E1U003CU002FsupU003EU003CU002FspanU003E-nb-6" scope="col"><bold>N
          =
          6</bold><named-content content-type="gt_footnote_marks"><sup>1</sup></named-content></th>
        </tr>
      </thead>
      <tfoot>
        <tr>
          <td colspan="2"><named-content content-type="gt_footnote_marks"><sup>1</sup></named-content>
          Mean (SD)</td>
        </tr>
      </tfoot>
      <tbody>
        <tr>
          <td headers="label">q1</td>
          <td headers="stat_0">2.33 (1.75)</td>
        </tr>
        <tr>
          <td headers="label">q2</td>
          <td headers="stat_0">2.50 (0.84)</td>
        </tr>
        <tr>
          <td headers="label">q3</td>
          <td headers="stat_0">2.83 (2.04)</td>
        </tr>
        <tr>
          <td headers="label">q4</td>
          <td headers="stat_0">2.83 (1.72)</td>
        </tr>
        <tr>
          <td headers="label">q5</td>
          <td headers="stat_0">4.33 (0.82)</td>
        </tr>
        <tr>
          <td headers="label">q6</td>
          <td headers="stat_0">2.83 (1.47)</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-28-nb-7">
<front-stub>
<title-group>
<article-title>Internal-External Development and
Cross-Validation</article-title>
</title-group>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-7" specific-use="notebook-code">
<code language="r script">source(&quot;notebooks/initialize-data-analysis.r&quot;)
</code>
<code language="r script">source(&quot;notebooks/BMA-model-no-initial-var.r&quot;) # run_bas_glm() function
</code>
<sec id="nb-code-cell-1-output-0-nb-7" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
</sec>
<sec id="nb-code-cell-2-nb-7" specific-use="notebook-code">
<code language="r script">library(rsample) # for group_vfold_cv()
library(furrr) # for future_map()
</code>
<code language="r script">library(tidymodels)
</code>
<code language="r script">library(CalibrationCurves)
</code>
<code language="r script">data_patient_cross_prep &lt;- data_patient_complete |&gt;
  select(all_of(predictor_list), flag_ADR_TP_ID, site)

cross_samples &lt;- group_vfold_cv(data_patient_cross_prep, group = &quot;site&quot;)

extract_variable_names_cross &lt;- function(sample) {
  data &lt;- analysis(sample) |&gt; select(-site)
  model &lt;- data |&gt;
    run_bas_glm(
      formula = flag_ADR_TP_ID ~ .
    )
  variable.names(predict(model, estimator = &quot;HPM&quot;))[-1] |&gt;
    str_extract(paste(predictor_list, collapse = &quot;|&quot;))
}

# Function to modify sample data and fit model
fit_model_to_sample &lt;- function(sample, variables) {
  data &lt;- analysis(sample) |&gt;
    mutate(flag_ADR_TP_ID = as.factor(flag_ADR_TP_ID))

  formula &lt;- reformulate(termlabels = variables, response = &quot;flag_ADR_TP_ID&quot;)

  logistic_reg() |&gt;
    set_engine(&quot;glm&quot;) |&gt;
    set_mode(&quot;classification&quot;) |&gt;
    fit(formula, data = data)
}

calc_cross_performance &lt;- function(sample, model) {
  data &lt;- assessment(sample)
  pHat &lt;- predict(model$fit, data, type = &quot;response&quot;)
  yTest &lt;- data$flag_ADR_TP_ID
  calperf &lt;- valProbggplot(pHat, yTest, smooth = &quot;none&quot;)

  tibble(
    site = data$site[1],
    n = nrow(data),
    cross_C_index = calperf$Cindex[[1]],
    cross_C_index_lower = calperf$Cindex[[2]],
    cross_C_index_upper = calperf$Cindex[[3]],
    cross_calibration_intercept = calperf$Calibration$Intercept[[1]],
    cross_calibration_intercept_lower = calperf$Calibration$Intercept[[2]],
    cross_calibration_intercept_upper = calperf$Calibration$Intercept[[3]],
    cross_calibration_slope = calperf$Calibration$Slope[[1]],
    cross_calibration_slope_lower = calperf$Calibration$Slope[[2]],
    cross_calibration_slope_upper = calperf$Calibration$Slope[[3]]
  )
}

plot_calibration_curve &lt;- function(sample, model) {
  data &lt;- assessment(sample)
  pHat &lt;- predict(model$fit, data, type = &quot;response&quot;)
  yTest &lt;- data$flag_ADR_TP_ID
  calperf &lt;- valProbggplot(pHat, yTest, logistic.cal = TRUE, lty.log = 2, col.log = &quot;blue&quot;, smooth = &quot;none&quot;)
  calperf$ggPlot + ggtitle(data$site[1])
}

# Set up future to use multiple cores
plan(multisession, workers = 6)
</code>
<code language="r script">cross_predict_HPM &lt;- cross_samples$splits |&gt;
  future_map(extract_variable_names_cross, .options = furrr_options(seed = TRUE))

# Fit model to each sample in parallel
cross_full &lt;- future_map2(cross_samples$splits, cross_predict_HPM, fit_model_to_sample)

cross_estimates &lt;- future_map2_dfr(cross_samples$splits, cross_full, calc_cross_performance)

cross_plots &lt;- future_map2(cross_samples$splits, cross_full, plot_calibration_curve)

plan(sequential)
</code>
<sec id="nb-code-cell-2-output-0-nb-7" specific-use="notebook-output">
<preformat>Loading required package: future</preformat>
</sec>
<sec id="nb-code-cell-2-output-1-nb-7" specific-use="notebook-output">
<preformat>── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──</preformat>
</sec>
<sec id="nb-code-cell-2-output-2-nb-7" specific-use="notebook-output">
<preformat>✔ broom        1.0.5      ✔ recipes      1.0.10
✔ dials        1.2.1      ✔ tune         1.2.0 
✔ infer        1.0.6      ✔ workflows    1.1.4 
✔ modeldata    1.3.0      ✔ workflowsets 1.1.0 
✔ parsnip      1.2.0      ✔ yardstick    1.3.0 </preformat>
</sec>
<sec id="nb-code-cell-2-output-3-nb-7" specific-use="notebook-output">
<preformat>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ scales::discard() masks purrr::discard()
✖ dplyr::filter()   masks stats::filter()
✖ recipes::fixed()  masks stringr::fixed()
✖ dplyr::lag()      masks stats::lag()
✖ yardstick::spec() masks readr::spec()
✖ recipes::step()   masks stats::step()
• Search for functions across packages at https://www.tidymodels.org/find/</preformat>
</sec>
<sec id="nb-code-cell-2-output-4-nb-7" specific-use="notebook-output">
<preformat>Loading required package: rms</preformat>
</sec>
<sec id="nb-code-cell-2-output-5-nb-7" specific-use="notebook-output">
<preformat>Loading required package: Hmisc</preformat>
</sec>
<sec id="nb-code-cell-2-output-6-nb-7" specific-use="notebook-output">
<preformat>
Attaching package: 'Hmisc'</preformat>
</sec>
<sec id="nb-code-cell-2-output-7-nb-7" specific-use="notebook-output">
<preformat>The following object is masked from 'package:parsnip':

    translate</preformat>
</sec>
<sec id="nb-code-cell-2-output-8-nb-7" specific-use="notebook-output">
<preformat>The following objects are masked from 'package:dplyr':

    src, summarize</preformat>
</sec>
<sec id="nb-code-cell-2-output-9-nb-7" specific-use="notebook-output">
<preformat>The following objects are masked from 'package:base':

    format.pval, units</preformat>
</sec>
<sec id="nb-code-cell-2-output-10-nb-7" specific-use="notebook-output">
<preformat>Warning in checkNumberOfLocalWorkers(workers): Careful, you are setting up 6
localhost parallel workers with only 4 CPU cores available for this R process
(per 'system'), which could result in a 150% load. The soft limit is set to
100%. Overusing the CPUs has negative impact on the current R process, but also
on all other processes of yours and others running on the same machine. See
help(&quot;parallelly.options&quot;, package = &quot;parallelly&quot;) for how to override the soft
and hard limits</preformat>
</sec>
</sec>
<sec id="nb-code-cell-3-nb-7" specific-use="notebook-code">
<code language="r script">cross_plots
</code>
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-3-1.png" />
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-3-2.png" />
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-3-3.png" />
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-3-4.png" />
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-3-5.png" />
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-3-6.png" />
<sec id="nb-code-cell-3-output-0-nb-7" specific-use="notebook-output">
<preformat>[[1]]</preformat>
</sec>
<sec id="nb-code-cell-3-output-1-nb-7" specific-use="notebook-output">
<preformat>
[[2]]</preformat>
</sec>
<sec id="nb-code-cell-3-output-2-nb-7" specific-use="notebook-output">
<preformat>
[[3]]</preformat>
</sec>
<sec id="nb-code-cell-3-output-3-nb-7" specific-use="notebook-output">
<preformat>
[[4]]</preformat>
</sec>
<sec id="nb-code-cell-3-output-4-nb-7" specific-use="notebook-output">
<preformat>
[[5]]</preformat>
</sec>
<sec id="nb-code-cell-3-output-5-nb-7" specific-use="notebook-output">
<preformat>
[[6]]</preformat>
</sec>
</sec>
<sec id="nb-code-cell-4-nb-7" specific-use="notebook-code">
<code language="r script">library(meta)
</code>
<code language="r script">cross_C_index_meta &lt;- metagen(
  data = cross_estimates,
  studlab = site,
  TE = cross_C_index,
  lower = cross_C_index_lower,
  upper = cross_C_index_upper,
  sm = &quot;C_statistic&quot;,
  common = FALSE,
  random = TRUE,
  method.tau = &quot;REML&quot;,
  method.random.ci = &quot;HK&quot;,
  adhoc.hakn.ci = &quot;IQWiG6&quot;,
)

forest_plot_C_index &lt;- forest(
  cross_C_index_meta,
  sortvar = TE,
  ref = NA,
  xlim = c(0.6, 0.9),
  layout = &quot;RevMan5&quot;
)
</code>
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-4-1.png" />
<code language="r script">cross_calibration_intercept_meta &lt;- metagen(
  data = cross_estimates,
  studlab = site,
  TE = cross_calibration_intercept,
  lower = cross_calibration_intercept_lower,
  upper = cross_calibration_intercept_upper,
  sm = &quot;C_intercept&quot;,
  common = FALSE,
  random = TRUE,
  method.tau = &quot;REML&quot;,
  method.random.ci = &quot;HK&quot;,
  adhoc.hakn.ci = &quot;IQWiG6&quot;,
  null.effect = 0
)

forest_plot_calibration_intercept &lt;- forest(
  cross_calibration_intercept_meta,
  sortvar = TE,
  ref = 0,
  xlim = c(-0.8, 0.8),
  layout = &quot;RevMan5&quot;
)
</code>
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-4-2.png" />
<code language="r script">cross_calibration_slope_meta &lt;- metagen(
  data = cross_estimates,
  studlab = site,
  TE = cross_calibration_slope,
  lower = cross_calibration_slope_lower,
  upper = cross_calibration_slope_upper,
  sm = &quot;C_slope&quot;,
  common = FALSE,
  random = TRUE,
  method.tau = &quot;REML&quot;,
  method.random.ci = &quot;HK&quot;,
  adhoc.hakn.ci = &quot;IQWiG6&quot;,
  null.effect = 1
)

forest_plot_calibration_slope &lt;- forest(
  cross_calibration_slope_meta,
  sortvar = TE,
  ref = 1,
  xlim = c(0.2, 1.7),
  layout = &quot;RevMan5&quot;
)
</code>
<graphic mimetype="image" mime-subtype="png" xlink:href="04-internal-external-cross-performance_files/figure-jats/unnamed-chunk-4-3.png" />
<code language="r script">cross_meta_performance &lt;- tibble(
  site = &quot;Total&quot;,
  n = sum(cross_estimates$n),
  cross_C_index = cross_C_index_meta$TE.random,
  cross_C_index_lower = cross_C_index_meta$lower.random,
  cross_C_index_upper = cross_C_index_meta$upper.random,
  cross_calibration_intercept = cross_calibration_intercept_meta$TE.random,
  cross_calibration_intercept_lower = cross_calibration_intercept_meta$lower.random,
  cross_calibration_intercept_upper = cross_calibration_intercept_meta$upper.random,
  cross_calibration_slope = cross_calibration_slope_meta$TE.random,
  cross_calibration_slope_lower = cross_calibration_slope_meta$lower.random,
  cross_calibration_slope_upper = cross_calibration_slope_meta$upper.random
)

cross_performance_metrics &lt;- bind_rows(cross_estimates, cross_meta_performance)
</code>
<sec id="nb-code-cell-4-output-0-nb-7" specific-use="notebook-output">
<preformat>Loading required package: metadat</preformat>
</sec>
<sec id="nb-code-cell-4-output-1-nb-7" specific-use="notebook-output">
<preformat>Loading 'meta' package (version 7.0-0).
Type 'help(meta)' for a brief overview.
Readers of 'Meta-Analysis with R (Use R!)' should install
older version of 'meta' package: https://tinyurl.com/dt4y5drs</preformat>
</sec>
</sec>
<sec id="nb-code-cell-5-nb-7" specific-use="notebook-code">
<code language="r script">save(cross_performance_metrics, file = &quot;data/model-performance/cross-performance-metrics.rda&quot;)
</code>
</sec>
</body>



<back>
</back>


</sub-article>

</article>